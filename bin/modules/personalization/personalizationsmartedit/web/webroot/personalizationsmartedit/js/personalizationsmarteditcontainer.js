!function(t){var e={};function __webpack_require__(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}__webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,i){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(__webpack_require__.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)__webpack_require__.d(i,n,function(e){return t[e]}.bind(null,n));return i},__webpack_require__.n=function(t){var e=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=14)}([function(t,e,i){t.exports=i(13)(1)},function(t,e,i){t.exports=i(4)(0)},function(t,e){t.exports=angular},function(t,e){t.exports=moment},function(t,e){t.exports=vendor_chunk},function(t,e,i){t.exports=i(4)(1)},function(t,e,i){t.exports=i(4)(72)},function(t,e,i){t.exports=i(4)(244)},function(t,e,i){var n={"./templates.js":9};function webpackContext(t){var e=webpackContextResolve(t);return i(e)}function webpackContextResolve(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}webpackContext.keys=function webpackContextKeys(){return Object.keys(n)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=8},function(t,e){angular.module("personalizationsmarteditcontainerTemplates",[]).run(["$templateCache",function(t){"use strict";t.put("web/features/personalizationsmarteditcontainer/combinedView/personalizationsmarteditCombinedViewConfigureTemplate.html",'<form class="pe-combinedview-config__form">\n    <div class="form-group">\n        <label for="PageFilterDropdownField001"\n            class="fd-form__label"\n            data-translate="personalization.commons.filter.label"></label>\n\n        <div class="pe-combinedview-config__filter-layout">\n            <page-filter-dropdown id="PageFilterDropdownField001"\n                data-on-select-callback="modalController.pageFilterChange(value)"\n                class="fd-has-margin-right-small"></page-filter-dropdown>\n            <has-multicatalog>\n                <catalog-filter-dropdown data-on-select-callback="modalController.catalogFilterChange(value)" />\n            </has-multicatalog>\n        </div>\n\n        <div class="pe-combinedview-config__select-group-layout">\n            <div class="pe-combinedview-config__select-group-label-layout">\n                <label for="CombinedViewSearchField1"\n                    class="fd-form__label required pe-combinedview-config__label"\n                    data-translate="personalization.modal.combinedview.search.label"></label>\n            </div>\n            <ui-select data-ng-init="modalController.initUiSelect($select)"\n                ng-model="selectedElement"\n                theme="select2"\n                class="fd-form__control"\n                ng-keyup="modalController.searchInputKeypress($event, $select.search)"\n                on-select="modalController.selectElement($item)"\n                reset-search-input="false"\n                data-backspace-reset="false"\n                id="CombinedViewSearchField1">\n                <ui-select-match placeholder="{{ \'personalization.modal.combinedview.search.placeholder\' | translate}}">\n                    <span class="pe-combinedview-config__ui-select-placeholder">{{\'personalization.modal.combinedview.search.placeholder\' | translate}}</span>\n                </ui-select-match>\n                <ui-select-choices repeat="item in selectionArray"\n                    position="down"\n                    ui-disable-choice="modalController.isItemInSelectDisabled(item)"\n                    personalization-infinite-scroll="modalController.addMoreItems()"\n                    personalization-infinite-scroll-distance="1">\n                    <div class="pe-combinedview-config__ui-select-choices-layout"\n                        data-ng-class="{\'pe-combinedview-config__ui-select-item--selected\': modalController.isItemSelected(item)}">\n                        <div class="pe-combinedview-config__ui-select-choices-col1">\n                            <div class="perso-wrap-ellipsis"\n                                data-ng-bind="item.customization.name + \' > \' + item.variation.name"\n                                title="{{item.customization.name}} > {{item.variation.name}}">\n                            </div>\n                        </div>\n                        <div class="pe-combinedview-config__ui-select-choices-col2">\n                            <has-multicatalog>\n                                <div data-ng-if="catalogFilter!==\'current\'"\n                                    data-ng-init="modalController.getAndSetCatalogVersionNameL10N(item.variation)">\n                                    <div class="perso-wrap-ellipsis"\n                                        data-ng-if="!modalController.isItemFromCurrentCatalog(item.variation)"\n                                        data-ng-bind="item.variation.catalogVersionNameL10N"\n                                        title="{{item.variation.catalogVersionNameL10N}}">\n                                    </div>\n                                    <div class="perso-wrap-ellipsis"\n                                        data-ng-if="modalController.isItemFromCurrentCatalog(item.variation)"\n                                        data-translate="personalization.filter.catalog.current"\n                                        title="{{\'personalization.filter.catalog.current\' | translate }}">\n                                    </div>\n                                </div>\n                            </has-multicatalog>\n                        </div>\n                    </div>\n                </ui-select-choices>\n            </ui-select>\n        </div>\n    </div>\n    <div class="form-group">\n        <p data-ng-hide="selectedItems.length > 0">No Customizations Selected</p>\n        <div id="CombinedViewSelectedField1"\n            class="pe-combinedview-config__list-layout"\n            data-ng-repeat="item in selectedItems"\n            data-ng-class="{\'pe-combinedview-config__divider\': $first}">\n            <div class="pe-combinedview-config__letter-layout">\n                <div data-ng-class="modalController.getClassForElement($index)"\n                    data-ng-bind="modalController.getLetterForElement($index)"></div>\n            </div>\n            <div class="pe-combinedview-config__names-layout">\n                <div class="perso-wrap-ellipsis pe-combinedview-config__cname"\n                    data-ng-bind="item.customization.name"\n                    title="{{item.customization.name}}"></div>\n                <span> ></span>\n                <div class="perso-wrap-ellipsis pe-combinedview-config__vname"\n                    data-ng-bind="item.variation.name"\n                    title="{{item.variation.name}}"></div>\n            </div>\n            <div class="pe-combinedview-config__hyicon-globe">\n                <span data-ng-if="!modalController.isItemFromCurrentCatalog(item.variation)"\n                    class="perso__globe-icon hyicon hyicon-globe"\n                    data-uib-tooltip="{{item.variation.catalogVersionNameL10N}}"\n                    data-tooltip-placement="top-right"></span>\n            </div>\n            <div class="pe-combinedview-config__hyicon-remove">\n                <span class="sap-icon--decline"\n                    data-ng-click="modalController.removeSelectedItem(item)"\n                    title="{{\'personalization.modal.combinedview.icon.remove.title\' | translate}}"></span>\n            </div>\n        </div>\n    </div>\n</form>'),t.put("web/features/personalizationsmarteditcontainer/combinedView/personalizationsmarteditCombinedViewMenuTemplate.html",'<div data-ng-if="!$ctrl.isCombinedViewConfigured">\n    <div class="pe-combined-view-panel__wrapper pe-combined-view-panel__wrapper--empty ">\n        <img src="static-resources/images/emptyVersions.svg"\n            alt="no Configurationss"\n            class="pe-combined-view-panel--empty-img">\n        <span class="pe-combined-view-panel--empty-text"\n            data-translate="{{\'personalization.toolbar.combinedview.openconfigure.empty\' | translate}}"></span>\n        <a class="fd-link pe-combined-view-panel--empty-link"\n            data-ng-click="$ctrl.combinedViewClick()"\n            data-translate="personalization.toolbar.combinedview.openconfigure.link"\n            title="{{\'personalization.toolbar.combinedview.openconfigure.link\' | translate}}">\n        </a>\n    </div>\n</div>\n\n<div data-ng-if="$ctrl.isCombinedViewConfigured">\n    <div class="pe-combined-view-panel__wrapper">\n        <div class="pe-combined-view-panel__configure-layout">\n            <button class="fd-button--light pe-combined-view-panel__configure-btn perso-wrap-ellipsis"\n                data-ng-click="$ctrl.clearAllCombinedViewClick()"\n                data-translate="personalization.toolbar.combinedview.clearall.button"\n                title="{{\'personalization.toolbar.combinedview.clearall.button\' | translate}}">\n            </button>\n            <button class="fd-button pe-combined-view-panel__configure-btn perso-wrap-ellipsis"\n                data-ng-click="$ctrl.combinedViewClick()"\n                data-translate="personalization.toolbar.combinedview.openconfigure.button"\n                title="{{\'personalization.toolbar.combinedview.openconfigure.button\' | translate}}">\n            </button>\n        </div>\n        <div data-ng-class="$ctrl.combinedView.enabled ? \'\':\'pe-combined-view-panel--disabled\'">\n            <div class="pe-combined-view-panel__list-layout"\n                data-ng-repeat="item in $ctrl.selectedItems"\n                data-ng-click="$ctrl.itemClick(item)"\n                data-ng-class="{\'pe-combined-view-panel-list__item--highlighted\': item.highlighted}">\n                <div class="pe-combined-view-panel-list__letter-layout">\n                    <div data-ng-class="$ctrl.getClassForElement($index)"\n                        data-ng-bind="$ctrl.getLetterForElement($index)"></div>\n                </div>\n                <div class="pe-combined-view-panel-list__names-layout">\n                    <div class="perso-wrap-ellipsis"\n                        data-ng-bind="item.customization.name"\n                        title="{{item.customization.name}}"></div>\n                    <div class="perso-wrap-ellipsis perso-tree__primary-data"\n                        data-ng-bind="item.variation.name"\n                        title="{{item.variation.name}}"></div>\n                </div>\n                <div class="pe-combined-view-panel-list__icon">\n                    <span data-ng-if="!$ctrl.isItemFromCurrentCatalog(item.variation)"\n                        class="perso__globe-icon hyicon hyicon-globe"\n                        data-uib-tooltip="{{item.variation.catalogVersionNameL10N}}"\n                        data-tooltip-placement="auto top"\n                        data-tooltip-enable="$ctrl.combinedView.enabled"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/combinedView/personalizationsmarteditCombinedViewMenuWrapperTemplate.html",'<div class="btn-block pe-toolbar-action--include">\n\n    <div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized se-toolbar-menu-content--pe-combine"\n        role="menu">\n        <div class="se-toolbar-menu-content--pe-customized__headers">\n\n            <h2 class="se-toolbar-menu-content--pe-customized__headers--h2"\n                data-translate="personalization.toolbar.combinedview.header.title"></h2>\n            <y-help class="se-toolbar-menu-content__y-help"\n                data-template="\'<span data-translate=personalization.toolbar.combinedview.header.description></span>\'"></y-help>\n\n        </div>\n        <div role="menuitem"\n            class="pe-combined-view-menu">\n            <personalizationsmartedit-combined-view-menu data-is-menu-open="item.isOpen" />\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/combinedView/personalizationsmarteditCombinedViewToolbarContextWrapperTemplate.html","<personalizationsmartedit-combined-view-toolbar-context></personalizationsmartedit-combined-view-toolbar-context>"),t.put("web/features/personalizationsmarteditcontainer/commonComponents/catalogVersionFilterDropdownItemTemplate.html",'<div>\n    <span class="hyicon hyicon-globe"\n        data-ng-if="item.isCurrentCatalog === false"></span>\n    <span data-ng-if="item.isCurrentCatalog === false">{{item.catalogName | l10n}} - {{item.catalogVersionId}}</span>\n    <span data-ng-if="item.isCurrentCatalog === true"\n        data-translate="personalization.filter.catalog.current"></span>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/commonComponents/hasMulticatalogTemplate.html",'<div data-ng-if="$ctrl.hasMulticatalog">\n    <div data-ng-transclude></div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/commonComponents/pageFilterDropdownTemplate.html",'<y-select class="perso-filter"\n    data-ng-model="$ctrl.selectedId"\n    data-on-change="$ctrl.onChange"\n    data-fetch-strategy="$ctrl.fetchStrategy"\n    data-item-template="::$ctrl.itemTemplate"\n    data-search-enabled="false" />'),t.put("web/features/personalizationsmarteditcontainer/contextMenu/personalizationsmarteditAddEditActionTemplate.html",'<div class="perso-customize-component">\n    <div class="perso-customize-component__title-layout">\n        <div data-ng-show=\'modalController.letterIndicatorForElement\'\n            class="perso-customize-component__title-layout__letter-block">\n            <span data-ng-class="modalController.colorIndicatorForElement"\n                data-ng-bind="modalController.letterIndicatorForElement">\n            </span>\n        </div>\n        <div class="perso-customize-component__title-layout__cust-name perso-wrap-ellipsis"\n            data-ng-bind="selectedCustomization.name"\n            title="{{selectedCustomization.name}}">\n        </div>\n        <div class="perso-customize-component__title-layout__target-group-name perso-wrap-ellipsis"\n            data-ng-bind="\'> \'+ selectedVariation.name"\n            title="{{selectedVariation.name}}">\n        </div>\n    </div>\n\n    <dl class="perso-customize-component__data-list">\n        <label class="fd-form__label"\n            data-translate="personalization.modal.addeditaction.selected.mastercomponent.title"></label>\n        <dd>{{modalController.componentType}}</dd>\n    </dl>\n\n    <label class="control-label required"\n        data-translate="personalization.modal.addeditaction.selected.actions.title"></label>\n    <y-help data-template="\'<span data-translate=personalization.modal.addeditaction.selected.actions.help.label></span>\'">\n    </y-help>\n\n    <ui-select class="perso-customize-component__select2-container"\n        ng-model="action.selected"\n        data-backspace-reset="false"\n        theme="select2"\n        title=""\n        search-enabled="false">\n        <ui-select-match placeholder="{{\'personalization.modal.addeditaction.dropdown.placeholder\' | translate}}">\n            <span ng-bind="$select.selected.name"></span>\n        </ui-select-match>\n        <ui-select-choices repeat="item in modalController.actions"\n            position="down">\n            <span ng-bind="item.name "></span>\n        </ui-select-choices>\n    </ui-select>\n\n    <div class="perso-customize-component__select-group-label-layout">\n        <div data-ng-show="action.selected.id == \'use\'">\n            <label class="control-label required"\n                data-translate="personalization.modal.addeditaction.selected.component.title"></label>\n        </div>\n        <has-multicatalog data-ng-show="action.selected.id == \'use\'">\n            <div class="perso-customize-component__filter-layout">\n                <label class="fd-form__label perso-customize-component__filter-label"\n                    data-translate="personalization.commons.filter.label"></label>\n                <catalog-version-filter-dropdown data-on-select-callback="modalController.catalogVersionFilterChange(value)" />\n            </div>\n        </has-multicatalog>\n    </div>\n    <ui-select class="perso-customize-component__select2-container"\n        ng-show="action.selected.id == \'use\'"\n        ng-model="component.selected"\n        ng-keyup="modalController.componentSearchInputKeypress($event, $select.search)"\n        data-backspace-reset="false"\n        theme="select2"\n        title=""\n        reset-search-input="false">\n        <ui-select-match placeholder="{{\'personalization.modal.addeditaction.dropdown.componentlist.placeholder\' | translate}}">\n            <span ng-bind="$select.selected.name | translate"></span>\n        </ui-select-match>\n        <ui-select-choices repeat="item in modalController.components"\n            position="down"\n            personalization-infinite-scroll="modalController.addMoreComponentItems()"\n            personalization-infinite-scroll-distance="2">\n            <div class="row">\n                <span class="col-md-7"\n                    ng-bind="item.name"></span>\n                <span class="col-md-5"\n                    ng-bind="item.typeCode"></span>\n            </div>\n        </ui-select-choices>\n    </ui-select>\n\n    <ui-select class="perso-customize-component__select2-container"\n        ng-show="action.selected.id == \'create\'"\n        on-select="modalController.newComponentTypeSelectedEvent($item, $model)"\n        ng-model="modalController.newComponent.selected"\n        data-backspace-reset="false"\n        theme="select2"\n        title=""\n        search-enabled="false">\n        <ui-select-match placeholder="{{\'personalization.modal.addeditaction.dropdown.componenttype.placeholder\' | translate}}">\n            <span ng-bind="$select.selected.name"></span>\n        </ui-select-match>\n        <ui-select-choices repeat="item in newComponentTypes"\n            position="down">\n            <span ng-bind="item.i18nKey | translate"></span>\n        </ui-select-choices>\n    </ui-select>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/customizeView/customizationsList/customizationsListTemplate.html",'<div class="pe-customize-panel-list">\n\n    <div class="pe-customize-panel-list__header">\n        <span class="pe-customize-panel-list__header--name"\n            data-translate="personalization.toolbar.pagecustomizations.list.title"></span>\n        <span class="pe-customize-panel-list__header--status"\n            data-translate="personalization.toolbar.pagecustomizations.list.status"></span>\n    </div>\n\n    <div data-ng-class="$last && customization.collapsed && $ctrl.isCustomizationFromCurrentCatalog(customization) ? \'pe-customize-panel-list__item-last\':\'\'"\n        data-ng-repeat="customization in $ctrl.customizationsList track by $index"\n        data-ng-init="$ctrl.initCustomization(customization)">\n        <div class="pe-customize-panel-list__row-layout"\n            data-ng-class="$ctrl.getSelectedCustomizationClass(customization)">\n            <div class="pe-customize-panel-list__icon-layout pe-customize-panel-list__icon-divider"\n                data-ng-click="$ctrl.customizationRowClick(customization);">\n                <a class="pe-customize-panel-list__btn-link btn btn-link"\n                    title="{{customization.collapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                    <span data-ng-class="customization.collapsed ? \'sap-icon--navigation-right-arrow\' : \'sap-icon--navigation-down-arrow\'"></span>\n                </a>\n            </div>\n            <div class="pe-customize-panel-list__row"\n                data-ng-click="$ctrl.customizationRowClick(customization,true);">\n                <div class="pe-customize-panel-list__col-lg">\n                    <div class="perso-wrap-ellipsis pe-customize-panel-list__parent-layout perso-tree__primary-data"\n                        data-ng-bind="customization.name"\n                        title={{customization.name}}></div>\n                </div>\n                <div class="pe-customize-panel-list__col-md"></div>\n                <div class="pe-customize-panel-list__col-md">\n                    <div class="perso-tree__status"\n                        data-ng-class="$ctrl.getActivityStateForCustomization(customization)"\n                        data-ng-bind="$ctrl.getEnablementTextForCustomization(customization)"></div>\n                    <div class="perso-tree__dates-layout"\n                        data-ng-if="$ctrl.isEnabled(customization)"\n                        data-ng-bind="$ctrl.getDatesForCustomization(customization)"></div>\n                </div>\n                <div class="pe-customize-panel-list__col-sm">\n                    <span data-ng-if="!$ctrl.isCustomizationFromCurrentCatalog(customization)"\n                        class="perso__globe-icon hyicon hyicon-globe"\n                        data-uib-tooltip="{{customization.catalogVersionNameL10N}}"\n                        data-tooltip-placement="auto top"></span>\n                </div>\n            </div>\n            <div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown">\n                <div data-ng-if="$ctrl.isCustomizationFromCurrentCatalog(customization)"\n                    class="y-dropdown-more-menu dropdown open"\n                    data-ng-init="$ctrl.clearAllSubMenu();">\n                    <button type="button"\n                        class="pe-customize-panel-list__btn-link fd-button--light customization-rank-{{customization.rank}}-dropdown-toggle"\n                        data-ng-click="$ctrl.customizationSubMenuAction(customization)">\n                        <span class="perso__more-icon sap-icon--overflow"></span>\n                    </button>\n                    <ul data-ng-if="customization.subMenu"\n                        class="se-y-dropdown-menu__list fd-menu__list dropdown-menu"\n                        role="menu">\n                        <li>\n                            <a class="se-dropdown-item fd-menu__item cutomization-rank-{{customization.rank}}-edit-button"\n                                data-ng-click="$ctrl.clearAllSubMenu(); $ctrl.editCustomizationAction(customization);"\n                                data-translate="personalization.toolbar.pagecustomizations.customization.options.edit "></a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n        \x3c!--end customization row--\x3e\n        <div data-uib-collapse="customization.collapsed">\n            <div class="pe-customize-panel-list__row-layout"\n                data-ng-repeat="variation in customization.variations"\n                data-ng-if="$ctrl.statusNotDeleted(variation)"\n                data-ng-class="$ctrl.getSelectedVariationClass(variation)"\n                data-ng-click="$ctrl.clearAllSubMenu(); $ctrl.variationClick(customization, variation);">\n                <div class="pe-customize-panel-list__icon-layout">\n                    <div class="pe-customize-panel-list__btn-link btn btn-link"></div>\n                </div>\n                <div class="pe-customize-panel-list__row">\n                    <div class="pe-customize-panel-list__col-lg">\n                        <div class="perso-wrap-ellipsis pe-customize-panel-list__child-layout"\n                            data-ng-bind="variation.name"\n                            title={{variation.name}}></div>\n                    </div>\n                    <div class="pe-customize-panel-list__col-md">\n                        <div class="pe-customize-panel-list__components-layout">\n                            <div data-ng-show="variation.numberOfAffectedComponents >= 0"\n                                class="pe-customize-panel-list__number-layout">{{variation.numberOfAffectedComponents}}</div>\n                            <div data-ng-hide="variation.numberOfAffectedComponents >= 0"\n                                class="pe-customize-panel-list__number-layout">#</div>\n                            <div class="perso-wrap-ellipsis"\n                                data-translate="personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label"\n                                title="{{\'personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label\' | translate}}">\n                            </div>\n                        </div>\n                    </div>\n                    <div class="pe-customize-panel-list__col-md perso-tree__status"\n                        data-ng-class="$ctrl.getActivityStateForVariation(customization, variation)"\n                        data-ng-bind="$ctrl.getEnablementTextForVariation(variation)"></div>\n                    <div class="pe-customize-panel-list__col-sm">\n                        <span class="pe-customize-panel-list__cc-icon hyicon hyicon-commerce"\n                            data-ng-class="{\'pe-customize-panel-list__cc-icon--hidden\': !$ctrl.hasCommerceActions(variation)}"\n                            data-uib-tooltip-html="$ctrl.getCommerceCustomizationTooltip(variation)"\n                            data-tooltip-placement="auto top"></span>\n                    </div>\n                </div>\n                <div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"></div>\n            </div>\n        </div>\n    </div>\n    \x3c!--end data repeat--\x3e\n    <div class="pe-spinner--outer"\n        data-ng-show="$ctrl.requestProcessing">\n        <div data-ng-include="\'waitDialog.html\'"></div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/customizeView/personalizationsmarteditCustomizeToolbarContextWrapperTemplate.html","<personalizationsmartedit-customize-toolbar-context></personalizationsmartedit-customize-toolbar-context>"),t.put("web/features/personalizationsmarteditcontainer/customizeView/personalizationsmarteditCustomizeViewTemplate.html",'<div class="btn-block pe-toolbar-action--include">\n    <div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized-customizations-panel"\n        role="menu">\n        <div class="se-toolbar-menu-content--pe-customized__headers">\n            <h2 class="se-toolbar-menu-content--pe-customized__headers--h2">\n                <span data-translate="personalization.toolbar.pagecustomizations.header.title"></span>\n                ({{$ctrl.pagination.totalCount}})\n            </h2>\n            <y-help class="se-toolbar-menu-content__y-help"\n                data-template="\'<span data-translate=personalization.toolbar.pagecustomizations.header.description></span>\'"></y-help>\n        </div>\n        <div role="menuitem"\n            class="pe-combined-view-menu">\n            <div id="personalizationsmartedit-right-toolbar-item-template">\n                <div class="pe-customize-panel__filter-label-layout">\n                    <div class="pe-customize-panel__filter-layout">\n                        <page-filter-dropdown data-initial-value="$ctrl.pageFilter"\n                            data-on-select-callback="$ctrl.pageFilterChange(value)"\n                            class="perso-filter__wrapper perso-filter__wrapper--page"></page-filter-dropdown>\n                        <has-multicatalog>\n                            <catalog-filter-dropdown data-initial-value="$ctrl.catalogFilter"\n                                data-on-select-callback="$ctrl.catalogFilterChange(value)"\n                                class="perso-filter__wrapper perso-filter__wrapper--catalog" />\n                        </has-multicatalog>\n                        <status-filter-dropdown data-initial-value="$ctrl.statusFilter"\n                            data-on-select-callback="$ctrl.statusFilterChange(value)"\n                            class="perso-filter__wrapper perso-filter__wrapper--status"></status-filter-dropdown>\n                    </div>\n                    <div class="se-input-group se-component-search"\n                        data-ng-class="$ctrl.customizationsList.length == 0 ? \'\':\'\'">\n                        <div class="perso-search perso-search-panel perso-input-group">\n                            <input type="text"\n                                class="se-input-group--input se-component-search--input ng-pristine ng-untouched ng-valid"\n                                placeholder="{{ \'personalization.toolbar.pagecustomizations.search.placeholder\' | translate}}"\n                                data-ng-model="$ctrl.nameFilter"\n                                data-ng-keyup="$ctrl.nameInputKeypress($event)" />\n\n                            <span class="sap-icon--search se-component-search--search-icon se-input-group__addon"></span>\n\n                            <div class="se-input-group__addon se-input-group__clear-btn"\n                                data-ng-click="$ctrl.nameFilter=\'\'; $ctrl.nameInputKeypress($event)"\n                                data-ng-show="$ctrl.nameFilter">\n                                <span class="sap-icon--decline">\n                                </span>\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n                <div class="pe-customize-panel__wrapper"\n                    personalization-infinite-scroll="$ctrl.addMoreCustomizationItems()"\n                    personalization-infinite-scroll-distance="2"\n                    data-customizations-loaded="{{$ctrl.customizationsList.length > 0}}">\n                    <customizations-list data-customizations-list="$ctrl.customizationsList"\n                        data-request-processing="$ctrl.moreCustomizationsRequestProcessing" />\n                </div>\n\n            </div>\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/customizeView/personalizationsmarteditCustomizeViewWrapperTemplate.html",'<personalizationsmartedit-customize-view data-is-menu-open="item.isOpen" />'),t.put("web/features/personalizationsmarteditcontainer/management/commerceCustomizationView/personalizationsmarteditCommerceCustomizationViewTemplate.html",'<div id="commerceCustomizationBody-002"\n    class="perso-cc-modal">\n    <div class="perso-cc-modal__title-layout">\n        <div class="perso-wrap-ellipsis perso-cc-modal__title-cname"\n            data-ng-bind="customization.name"\n            title="{{customization.name}}">\n        </div>\n        <div class="perso-cc-modal__title-status"\n            data-ng-class="modalController.customizationStatus"\n            data-ng-bind="\' (\' + modalController.customizationStatusText + \') \'">\n        </div>\n        <span> > </span>\n        <div class="perso-wrap-ellipsis perso-cc-modal__title-vname"\n            data-ng-bind="variation.name"\n            title="{{variation.name}}">\n        </div>\n        <div class="perso-cc-modal__title-status"\n            data-ng-class="modalController.variationStatus"\n            data-ng-bind="\' (\' + modalController.variationStatusText + \')\'">\n        </div>\n    </div>\n    <div class="form-group perso-cc-modal__content-layout">\n        <label for="commerce-customization-type-1"\n            class="fd-from__label"\n            data-translate="personalization.modal.commercecustomization.action.type"></label>\n        <ui-select id="commerce-customization-type-1"\n            class="fd-from__control"\n            ng-model="modalController.select.type"\n            data-backspace-reset="false"\n            theme="select2"\n            search-enabled="false">\n            <ui-select-match>\n                <span data-ng-bind="$select.selected.text | translate"></span>\n            </ui-select-match>\n            <ui-select-choices repeat="item in modalController.availableTypes"\n                position="down">\n                <span data-ng-bind="item.text | translate"></span>\n            </ui-select-choices>\n        </ui-select>\n    </div>\n    <div class="form-group perso-cc-modal__content-layout">\n        <ng-include src="modalController.select.type.template" />\n    </div>\n    <div class="select2-choices">\n        <div class="ui-select-match-item select2-search-choice perso-cc-modal__ui-select--small"\n            data-ng-repeat="action in modalController.getActionsToDisplay()">\n            <span data-ng-bind="modalController.displayAction(action)"></span>\n            <span class="ui-select-match-close select2-search-choice-close sap-icon--decline"\n                data-ng-click="modalController.removeSelectedAction(action)"></span>\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/basicInfoTabTemplate.html",'<div class="pe-customization-modal">\n    <form>\n        <div class="fd-form__item">\n            <label for="customization-name"\n                data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.name"\n                class="fd-form__label se-control-label required"></label>\n            <input type="text"\n                class="fd-form__control"\n                placeholder="{{\'personalization.modal.customizationvariationmanagement.basicinformationtab.name.placeholder\' | translate}}"\n                name="{{$ctrl.customization.name}}_key"\n                data-ng-model="$ctrl.customization.name"\n                data-ng-required="true"\n                id="customization-name">\n        </div>\n        <div class="fd-form__item">\n            <label for="customization-description"\n                data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details"\n                class="se-control-label fd-form__label"></label>\n            <textarea rows="2"\n                class="fd-form__control pe-customization-modal__textarea"\n                placeholder="{{\'personalization.modal.customizationvariationmanagement.basicinformationtab.details.placeholder\' | translate}}"\n                name="{{$ctrl.customization.description}}_key"\n                data-ng-model="$ctrl.customization.description"\n                id="customization-description"></textarea>\n        </div>\n        <div class="fd-form__item fd-has-padding-bottom-tiny">\n            <label for="customization-status"\n                data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.status"\n                class="se-control-label fd-form__label"></label>\n            <div class="fd-form__item fd-form__item--check">\n                <label class="fd-form__label"\n                    for="test-checkbox"\n                    id="customization-status">\n                    <span class="fd-toggle fd-toggle--s fd-form__control">\n                        <input type="checkbox"\n                            name=""\n                            value=""\n                            id="test-checkbox"\n                            data-ng-model="$ctrl.customization.statusBoolean"\n                            data-ng-change="$ctrl.customizationStatusChange()">\n                        <span class="fd-toggle__switch"\n                            role="presentation"></span>\n                    </span>\n\n                </label>\n            </div>\n        </div>\n        <div class="fd-form__item">\n            <div>\n                <a data-ng-show="!$ctrl.datetimeConfigurationEnabled"\n                    class="fd-link"\n                    data-ng-click="$ctrl.datetimeConfigurationEnabled = !$ctrl.datetimeConfigurationEnabled"\n                    data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.showdateconfigdata"></a>\n                <a data-ng-show="$ctrl.datetimeConfigurationEnabled"\n                    class="fd-link"\n                    data-ng-click="$ctrl.datetimeConfigurationEnabled = !$ctrl.datetimeConfigurationEnabled; $ctrl.resetDateTimeConfiguration();"\n                    data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.hidedateconfigdata"></a>\n            </div>\n            <div data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.statusfortimeframe.description"\n                class="fd-has-padding-top-tiny"></div>\n        </div>\n        <div class="fd-form__item">\n            <div data-ng-show="$ctrl.datetimeConfigurationEnabled">\n                <div class="row pe-customization-modal__dates-group">\n                    <date-time-picker-range name="data-date-time-from-to-key"\n                        data-date-from="$ctrl.customization.enabledStartDate"\n                        data-date-to="$ctrl.customization.enabledEndDate"\n                        data-is-editable="true"\n                        date-format="$ctrl.DATE_CONSTANTS.MOMENT_FORMAT"></date-time-picker-range>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/basicInfoTabWrapperTemplate.html",'<basic-info-tab data-customization="$ctrl.customization" />'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/manageCustomizationViewMenuTemplate.html",'<div class="btn-block pe-toolbar-action--include">\n    <div class="se-toolbar-menu-content se-toolbar-menu-content--pe-customized"\n        role="menu">\n        <div class="se-toolbar-menu-content--pe-customized__headers">\n            <h2 class="se-toolbar-menu-content--pe-customized__headers--h2"\n                data-translate="personalization.toolbar.library.header.title"></h2>\n            <y-help class="se-toolbar-menu-content__y-help"\n                data-template="\'<span data-translate=personalization.toolbar.library.header.description></span>\'"></y-help>\n        </div>\n        <div class="se-toolbar-menu-content--pe-customized__item">\n            <a class="se-toolbar-menu-content--pe-customized__item__link"\n                id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor"\n                data-translate="personalization.toolbar.library.manager.name"\n                data-ng-click="$ctrl.managerViewClick();item.isOpen=false"></a>\n        </div>\n        <div class="se-toolbar-menu-content--pe-customized__item se-toolbar-menu-content--pe-customized__item--last">\n            <a class="se-toolbar-menu-content--pe-customized__item__link"\n                id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor"\n                data-translate="personalization.toolbar.library.customizationvariationmanagement.name"\n                data-ng-click="$ctrl.createCustomizationClick();item.isOpen=false"></a>\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/manageCustomizationViewMenuWrapperTemplate.html","<personalizationsmartedit-manage-customization-view-menu></personalizationsmartedit-manage-customization-view-menu>"),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/manageCustomizationViewTemplate.html",'<div class="pe-customization-modal__tabs">\n    <uib-tabset active="$ctrl.activeTabNumber">\n        <uib-tab ng-repeat="tab in $ctrl.tabsArr"\n            select="$ctrl.selectTab(tab)"\n            disable="tab.disabled"\n            heading="{{tab.heading}}">\n            <form name="{{tab.formName}}"\n                novalidate>\n                <div>\n                    <data-ng-include src="tab.template"></data-ng-include>\n                </div>\n            </form>\n        </uib-tab>\n    </uib-tabset>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/multipleTriggersComponent/multipleTriggersComponentTemplate.html",'<y-tabset data-tabs-list="$ctrl.tabsList"\n    data-num-tabs-displayed="{{$ctrl.tabsList.length}}">\n</y-tabset>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/personalizationsmarteditSegmentNodeTemplate.html",'<div data-ng-class="{\'perso-segments-tree__layout\': $ctrl.isContainer(node), \'perso-segments-tree__empty-container\': $ctrl.isContainerWithDropzone(node), \'perso-segments-tree__collapsed-container\': collapsed }">\n    <div class="perso-segments-tree"\n        data-ng-class="{\'perso-segments-tree__node\': $ctrl.isItem(node), \'perso-segments-tree__container\': $ctrl.isContainer(node)}">\n        <div data-ng-if="$ctrl.isContainer(node)">\n            <div class="perso-segments-tree__toggle"\n                data-ng-click="$ctrl.toggle(this)"\n                title="{{collapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                <span class="glyphicon perso-segments-tree__glyphicon"\n                    data-ng-class="{\'glyphicon-chevron-right\': collapsed, \'glyphicon-chevron-down\': !collapsed}"></span>\n            </div>\n            <div class="perso-segments-tree__dropdown">\n                <ui-select data-ng-model="node.operation"\n                    data-backspace-reset="false"\n                    theme="select2"\n                    title=""\n                    search-enabled="false">\n                    <ui-select-match>\n                        <span data-ng-bind="$select.selected.name | translate"></span>\n                    </ui-select-match>\n                    <ui-select-choices repeat="item in $ctrl.actions"\n                        position="down">\n                        <span data-ng-bind="item.name | translate"></span>\n                    </ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n        <div data-ng-if="$ctrl.isItem(node)"\n            ui-tree-handle\n            class="perso-segments-tree__node-content"\n            data-ng-bind="node.selectedSegment.code"></div>\n\n        <div data-ng-if="$ctrl.isDropzone(node)"\n            class="perso-segments-tree__empty-container-node">\n            <div class="perso-segments-tree__empty-container-node-text"\n                data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.dropzone"></div>\n        </div>\n\n        <div data-ng-if="$ctrl.isContainer(node)"\n            ui-tree-handle\n            class="perso-segments-tree__angular-ui-tree-handle--empty"></div>\n        <div data-nodrag>\n            <span class="pull-right">\n                <a data-ng-if="$ctrl.isItem(node)"\n                    class="perso-segments-tree__actions perso-segments-tree__node-icon"\n                    data-ng-click="$ctrl.duplicateItem(node)"\n                    title="{{\'personalization.commons.icon.title.duplicate\' | translate}}">\n                    <span class="sap-icon--duplicate"></span>\n                </a>\n                <a data-ng-if="!$ctrl.isTopContainer(this)"\n                    class="perso-segments-tree__actions"\n                    data-ng-click="$ctrl.removeItem(this)">\n                    <div data-ng-if="$ctrl.isContainer(node)"\n                        class="btn btn-link perso-segments-tree__container-btn-icon fd-has-margin-left-tiny"\n                        title="{{\'personalization.commons.icon.title.remove\' | translate}}">\n                        <span class="sap-icon--decline"></span>\n                    </div>\n                    <div data-ng-if="$ctrl.isItem(node)"\n                        class="perso-segments-tree__node-icon"\n                        title="{{\'personalization.commons.icon.title.remove\' | translate}}">\n                        <span class="sap-icon--decline"></span>\n                    </div>\n                </a>\n            </span>\n            <button data-ng-if="$ctrl.isContainer(node)"\n                class="fd-button--light perso-segments-tree__btn"\n                data-ng-click="$ctrl.newSubItem(this, \'container\')">\n                <span class="pe-customization-modal__sliderpanel__btn-link"\n                    data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.button"></span>\n            </button>\n        </div>\n    </div>\n\n    <ol data-ng-if="$ctrl.isItem(node)"\n        ui-tree-nodes\n        data-nodrop-enabled="true"\n        data-ng-model="node.nodes"\n        data-ng-class="{hidden: collapsed}">\n        <li data-ng-repeat="node in node.nodes"\n            ui-tree-node\n            data-collapsed="true"\n            data-expand-on-hover="500"\n            data-ng-include="\'personalizationsmarteditSegmentNodeTemplate.html\'">\n        </li>\n    </ol>\n    <ol data-ng-if="$ctrl.isContainer(node)"\n        ui-tree-nodes\n        data-ng-model="node.nodes"\n        data-ng-class="{hidden: collapsed}">\n        <li data-ng-repeat="node in node.nodes"\n            ui-tree-node\n            data-collapsed="true"\n            data-expand-on-hover="500"\n            data-ng-include="\'personalizationsmarteditSegmentNodeTemplate.html\'">\n        </li>\n    </ol>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/personalizationsmarteditSegmentViewTemplate.html",'<div>\n    <personalizationsmartedit-scroll-zone data-scroll-zone-id="\'segmentview\'"\n        data-scroll-zone-visible="$ctrl.scrollZoneVisible"\n        data-get-element-to-scroll="$ctrl.getElementToScroll()"></personalizationsmartedit-scroll-zone>\n    <div class="form-group">\n        <personalizationsmartedit-segment-expression-as-html data-segment-expression="$ctrl.expression[0]"></personalizationsmartedit-segment-expression-as-html>\n    </div>\n    <div class="form-group">\n        <label class="fd-form__label"\n            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments"></label>\n        <ui-select class="fd-form__control pe-customization-modal__segments-dropdown"\n            ng-model="$ctrl.singleSegment"\n            data-backspace-reset="false"\n            theme="select2"\n            ng-keyup="$ctrl.segmentSearchInputKeypress($event, $select.search)"\n            on-select="$ctrl.segmentSelectedEvent($item, $select.items)"\n            reset-search-input="false">\n            <ui-select-match placeholder="{{ \'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.placeholder\' | translate}}">\n                <span>{{\'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.placeholder\' | translate}}</span>\n            </ui-select-match>\n            <ui-select-choices repeat="item in $ctrl.segments"\n                position="down"\n                personalization-infinite-scroll="$ctrl.addMoreSegmentItems()"\n                personalization-infinite-scroll-distance="2">\n                <div ng-bind="item.code"\n                    class="perso__item-name"></div>\n                <div class="perso-wrap-ellipsis perso__wrapper-description"\n                    data-ng-bind="item.description"\n                    title="{{item.description}}"></div>\n            </ui-select-choices>\n        </ui-select>\n    </div>\n\n    <div ui-tree="$ctrl.treeOptions"\n        id="tree-root">\n        <div ui-tree-nodes\n            ng-model="$ctrl.expression"\n            data-nodrop-enabled="true">\n            <div ng-repeat="node in $ctrl.expression"\n                data-collapsed="false"\n                ui-tree-node\n                ng-include="\'personalizationsmarteditSegmentNodeTemplate.html\'"></div>\n        </div>\n    </div>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/personalizationsmarteditSegmentViewWrapperTemplate.html",'<label class="fd-from__label"\n    data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupexpression"></label>\n<personalizationsmartedit-segment-view></personalizationsmartedit-segment-view>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/segmentExpressionAsHtml/personalizationsmarteditSegmentExpressionAsHtmlTemplate.html",'<span data-ng-repeat="word in $ctrl.getExpressionAsArray() track by $index">\n    <span data-ng-if="$ctrl.operators.indexOf(word) > -1"\n        class="pe-customization-modal__expression-text"> {{ $ctrl.getLocalizationKeyForOperator(word) | translate }} </span>\n    <span data-ng-if="$ctrl.emptyGroup === word"\n        class="text-primary sap-icon--alert"\n        data-uib-tooltip="{{\'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.tooltip\' | translate}}"\n        data-tooltip-placement="auto top"></span>\n    <span data-ng-if="$ctrl.emptyGroupAndOperators.indexOf(word) === -1">{{word}}</span>\n</span>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/targetGroupTabTemplate.html",'<div class="pe-customization-modal">\n    <div class="pe-customization-modal__title">\n        <div class="pe-customization-modal__title-header">\n            <div class="pe-customization-modal__title-header-name perso-wrap-ellipsis"\n                data-ng-bind="$ctrl.customization.name"\n                title={{$ctrl.customization.name}}></div>\n            <div>\n                <span class="pe-customization-modal__title-header-badge badge"\n                    data-ng-class="{\'perso__status--enabled\':\'badge-success\', \'perso__status--disabled\':\'\', \'perso__status--ignore\':\'\'}[$ctrl.getActivityStateForCustomization($ctrl.customization)]">\n                    {{\'personalization.modal.customizationvariationmanagement.targetgrouptab.customization.\' + $ctrl.customization.status | lowercase | translate}}\n                </span>\n            </div>\n        </div>\n        <div class="pe-customization-modal__title-subarea">\n            <div data-ng-if="$ctrl.customization.status === $ctrl.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED"\n                class="pe-customization-modal__title-dates">\n                <span data-ng-if=\'!$ctrl.customization.enabledStartDate && $ctrl.customization.enabledEndDate\'>...</span>\n                <span data-ng-bind="$ctrl.customization.enabledStartDate"\n                    data-ng-class="{\'perso__datetimepicker--error-text\':!$ctrl.personalizationsmarteditDateUtils.isDateValidOrEmpty($ctrl.customization.enabledStartDate)}"></span>\n                <span data-ng-if=\'$ctrl.customization.enabledStartDate || $ctrl.customization.enabledEndDate\'> - </span>\n                <span data-ng-bind="$ctrl.customization.enabledEndDate"\n                    data-ng-class="{\'perso__datetimepicker--error-text\':!$ctrl.personalizationsmarteditDateUtils.isDateValidOrEmpty($ctrl.customization.enabledEndDate)}"></span>\n                <span data-ng-if="$ctrl.personalizationsmarteditDateUtils.isDateInThePast($ctrl.customization.enabledEndDate)"\n                    class="section-help help-inline help-inline--section help-inline--tooltip">\n                    <span class="hyicon hyicon-msgwarning hyicon-msgwarning--dates help-icon-inline"></span>\n                    <span class="pe-help-block--inline help-block-inline help-block-inline--text"\n                        data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.datetooltip"></span>\n                </span>\n                <span data-ng-if=\'$ctrl.customization.enabledStartDate && !$ctrl.customization.enabledEndDate\'>...</span>\n            </div>\n        </div>\n    </div>\n    <div class="pe-customization-modal__y-add-btn">\n        <button class="fd-button"\n            type="button"\n            data-ng-click="$ctrl.addVariationAction()">\n            <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.addtargetgroup.button"></span>\n        </button>\n    </div>\n    <ul data-ng-show=\'filteredVariations.length > 0\'\n        class="pe-customization-modal__list-group">\n        <li class="pe-customization-modal__list-group__item"\n            data-ng-repeat="variation in $ctrl.customization.variations | filter:$ctrl.personalizationsmarteditUtils.isItemVisible as filteredVariations">\n            <div class="pe-customization-modal__list-group__item-col1">\n                <a class="pe-customization-modal__list-group__item-link perso-wrap-ellipsis"\n                    data-ng-bind="variation.name"\n                    data-ng-click="$ctrl.editVariationAction(variation)"></a>\n                <span data-ng-class="$ctrl.getActivityStateForVariation($ctrl.customization, variation)"\n                    data-ng-bind="$ctrl.getEnablementTextForVariation(variation)"></span>\n                <div data-ng-show="$ctrl.personalizationsmarteditTriggerService.isDefault(variation.triggers)">\n                    <span class="pe-customization-modal__title-label-segments"\n                        data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span>\n                    <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></span>\n                </div>\n                <div data-ng-show="!$ctrl.personalizationsmarteditTriggerService.isDefault(variation.triggers)">\n                    <div>\n                        <span class="pe-customization-modal__title-label-segments"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span>\n                        <personalizationsmartedit-segment-expression-as-html data-segment-expression="variation.triggers"></personalizationsmartedit-segment-expression-as-html>\n                    </div>\n                </div>\n            </div>\n            <div data-uib-dropdown\n                class="pe-customization-modal__dropdown y-dropdown-more-menu">\n                <button type="button"\n                    data-uib-dropdown-toggle\n                    class="dropdown-toggle fd-button--light"\n                    id="dropdownMenu1"\n                    aria-haspopup="true"\n                    aria-expanded="true">\n                    <span class="sap-icon--overflow"></span>\n                </button>\n                <ul data-uib-dropdown-menu\n                    aria-labelledby="dropdownMenu1"\n                    class="se-y-dropdown-menu__list fd-menu__list"\n                    role="menu">\n                    <li>\n                        <a data-ng-click="$ctrl.editVariationAction(variation)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.edit"></a>\n                    </li>\n                    <li>\n                        <a data-ng-click="$ctrl.toogleVariationActive(variation)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-ng-bind="$ctrl.getActivityActionTextForVariation(variation)"></a>\n                    </li>\n                    <li data-ng-class="$first ? \'disabled\' : \'\' ">\n                        <a data-ng-click="$ctrl.setVariationRank(variation, -1, $event, $first)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.moveup"></a>\n                    </li>\n                    <li data-ng-class="$last ? \'disabled\' : \'\' ">\n                        <a data-ng-click="$ctrl.setVariationRank(variation, 1, $event, $last)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.movedown"></a>\n                    </li>\n                    <li>\n                        <a data-ng-click="$ctrl.removeVariationClick(variation)"\n                            class="se-dropdown-item fd-menu__item fd-has-color-status-3"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.remove"></a>\n                    </li>\n                </ul>\n            </div>\n        </li>\n    </ul>\n\n    <y-slider-panel data-slider-panel-show="$ctrl.showSliderPanel"\n        data-slider-panel-hide="$ctrl.hideSliderPanel"\n        data-slider-panel-configuration="$ctrl.sliderPanelConfiguration"\n        class="pe-customization-modal__sliderpanel">\n        <content>\n            <div class="pe-customization-modal__sliderpanel__btn-layout">\n                <button class="fd-button--light pe-customization-modal__sliderpanel__btn-link"\n                    data-ng-init="$ctrl.isFullscreen=false"\n                    data-ng-click="$ctrl.toggleSliderFullscreen(); $ctrl.isFullscreen=!$ctrl.isFullscreen">\n                    <div>\n                        <div data-ng-if="!$ctrl.isFullscreen">\n                            <span class="hyicon hyicon-maximize"></span>\n                            <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.open"></span>\n                        </div>\n                        <div data-ng-if="$ctrl.isFullscreen">\n                            <span class="hyicon hyicon-minimize"></span>\n                            <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.close"></span>\n                        </div>\n                    </div>\n                </button>\n            </div>\n            <form>\n                <div class="fd-form-item">\n                    <label for="targetgroup-name"\n                        class="fd-form__label required"\n                        data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname"></label>\n                    <input type="text"\n                        class="fd-form__control"\n                        placeholder="{{\'personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname.placeholder\' | translate}}"\n                        name="variationname_key"\n                        data-ng-model="$ctrl.edit.name"\n                        id="targetgroup-name">\n                </div>\n                <div class="fd-form__item fd-form__item--check pe-customization-modal--check">\n                    <input type="checkbox"\n                        id="targetgroup-isDefault-001"\n                        class="fd-form__control pe-customization-modal__check"\n                        data-ng-model="$ctrl.edit.isDefault"\n                        data-ng-change="$ctrl.confirmDefaultTrigger($ctrl.edit.isDefault);" />\n                    <label for="targetgroup-isDefault-001"\n                        class="fd-form__label"\n                        data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></label>\n                </div>\n\n                <div data-ng-show="$ctrl.edit.showExpression">\n\n                    <multiple-triggers></multiple-triggers>\n\n                </div>\n            </form>\n\n        </content>\n    </y-slider-panel>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/targetGroupTabWrapperTemplate.html",'<target-group-tab data-customization="$ctrl.customization"\n    data-variation="$ctrl.edit.selectedVariation" />'),t.put("web/features/personalizationsmarteditcontainer/management/managerView/personalizationsmarteditManagerViewGridHeaderTemplate.html",'<div class="tree-head hidden-sm hidden-xs">\n    <div class="tree-head__col--lg perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.customization"\n        title="{{\'personalization.modal.manager.grid.header.customization\' | translate}}"></div>\n    <div class="tree-head__col--xs"\n        data-translate="personalization.modal.manager.grid.header.variations"\n        title="{{\'personalization.modal.manager.grid.header.variations\' | translate}}"></div>\n    <div class="tree-head__col--xs perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.components"\n        title="{{\'personalization.modal.manager.grid.header.components\' | translate}}"></div>\n    <div class="tree-head__col--md"\n        data-translate="personalization.modal.manager.grid.header.status"\n        title="{{\'personalization.modal.manager.grid.header.status\' | translate}}"></div>\n    <div class="tree-head__col--sm perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.startdate"\n        title="{{\'personalization.modal.manager.grid.header.startdate\' | translate}}"></div>\n    <div class="tree-head__col--sm perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.enddate"\n        title="{{\'personalization.modal.manager.grid.header.enddate\' | translate}}"></div>\n</div>\n<div class="row tree-head visible-sm visible-xs">\n    <div class="col-xs-10 text-left"\n        data-translate="personalization.modal.manager.grid.header.customization"></div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/managerView/personalizationsmarteditManagerViewNodeTemplate.html",'<div class="y-tree-row"\n    data-ng-init="customization.isCollapsed=true"\n    data-ng-class="allCustomizationsCollapsed()? \'active-level\' : \'inactive-level\'">\n    <div class="desktop-layout hidden-sm hidden-xs customization-rank-{{customization.rank}}-row">\n        <div data-ng-click="customization.isCollapsed =! customization.isCollapsed">\n            <a class="btn btn-link category-toggle"\n                title="{{customization.isCollapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                <span data-ng-class="customization.isCollapsed ? \'sap-icon--navigation-right-arrow\' : \'sap-icon--navigation-down-arrow\'"\n                    class="glyphicon"></span>\n            </a>\n        </div>\n        <div ui-tree-handle\n            class="y-tree-row__angular-ui-tree-handle">\n            <div class="y-tree__col--lg">\n                <div class="perso-wrap-ellipsis perso-tree__primary-data"\n                    title={{customization.name}}>\n                    <span class="personalizationsmartedit-customization-code"\n                        data-ng-bind="customization.name"></span>\n                </div>\n            </div>\n            <div class="y-tree__col--xs"\n                data-ng-bind="customization.variations.filter(modalController.statusNotDeleted).length || 0">\n            </div>\n            <div class="y-tree__col--xs"></div>\n            <div class="y-tree__col--md perso-tree__status"\n                data-ng-class="modalController.getActivityStateForCustomization(customization)">\n                <span data-ng-bind="modalController.getEnablementTextForCustomization(customization)"\n                    class="perso-library__status-layout"></span>\n            </div>\n            <div class="y-tree__col--sm">\n                <div data-ng-show="customization.status === modalController.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED"\n                    class="perso-tree__dates-layout">\n                    <span data-ng-bind="modalController.getFormattedDate(customization.enabledStartDate)"></span>\n                </div>\n            </div>\n            <div class="y-tree__col--sm">\n                <div data-ng-show="customization.status === modalController.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED"\n                    class="perso-tree__dates-layout">\n                    <span data-ng-bind="modalController.getFormattedDate(customization.enabledEndDate)"></span>\n                </div>\n            </div>\n        </div>\n        <div>\n            <div data-uib-dropdown\n                class="y-dropdown-more-menu">\n                <button type="button"\n                    data-uib-dropdown-toggle\n                    class="fd-button--light">\n                    <span class="sap-icon--overflow"></span>\n                </button>\n                <ul data-uib-dropdown-menu\n                    class="se-y-dropdown-menu__list fd-menu__list"\n                    role="menu">\n                    <li>\n                        <a data-ng-click="modalController.editCustomizationAction(customization)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-translate="personalization.modal.manager.customization.options.edit"></a>\n                    </li>\n                    <li data-ng-class="modalController.isFilterEnabled() || $first ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(modalController.isFilterEnabled() || $first) ? $event.stopPropagation() : modalController.setCustomizationRank(customization, -1)"\n                            data-translate="personalization.modal.manager.customization.options.moveup"></a>\n                    </li>\n                    <li data-ng-class="modalController.isFilterEnabled() || $last ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(modalController.isFilterEnabled() || $last) ? $event.stopPropagation() : modalController.setCustomizationRank(customization, 1)"\n                            data-translate="personalization.modal.manager.customization.options.movedown"></a>\n                    </li>\n                    <li>\n                        <a data-ng-click="modalController.deleteCustomizationAction(customization)"\n                            data-translate="personalization.modal.manager.customization.options.delete"\n                            class="se-dropdown-item--delete"></a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n        \x3c!--end contextual menu dropdown--\x3e\n    </div>\n    \x3c!--end desktop-layout for customization row--\x3e\n\n    <div class="mobile-layout hidden-xl hidden-lg hidden-md customization-rank-{{customization.rank}}-row">\n        <div data-ng-click="customization.isCollapsed =! customization.isCollapsed">\n            <a class="btn btn-link category-toggle"\n                title="{{customization.isCollapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                <span data-ng-class="customization.isCollapsed ? \'glyphicon-chevron-right\' : \'glyphicon-chevron-down\'"\n                    class="glyphicon customization__glyphicon-chevron"></span>\n            </a>\n        </div>\n        <div ui-tree-handle\n            class="y-tree-row__angular-ui-tree-handle--mobile">\n            <p class="y-tree__col-xl--mobile perso-tree__primary-data perso-wrap-ellipsis"\n                title={{customization.name}}>\n                <span class="personalizationsmartedit-customization-code"\n                    data-ng-bind="customization.name"></span>\n            </p>\n            <div class="mobile-data">\n                <span class="perso-library__tree-head--mobile"\n                    data-translate="personalization.modal.manager.grid.header.variations"></span>\n                <div class="perso-library__number-data--mobile"\n                    data-ng-bind="customization.variations.filter(modalController.statusNotDeleted).length || 0"></div>\n            </div>\n            <div class="mobile-data perso-tree__status"\n                data-ng-class="modalController.getActivityStateForCustomization(customization)">\n                <span data-ng-bind="modalController.getEnablementTextForCustomization(customization)"></span>\n            </div>\n            <div data-ng-show="customization.status === modalController.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED">\n                <div class="mobile-data"\n                    data-ng-if=\'customization.enabledStartDate || customization.enabledEndDate\'>\n                    <span data-ng-if=\'customization.enabledStartDate\'\n                        class="perso-library__tree-head--mobile"\n                        data-translate="personalization.modal.manager.grid.header.startdate"></span>\n                    <p data-ng-bind="modalController.getFormattedDate(customization.enabledStartDate)"></p>\n                    <span data-ng-if=\'customization.enabledEndDate\'\n                        class="perso-library__tree-head--mobile"\n                        data-translate="personalization.modal.manager.grid.header.enddate"></span>\n                    <p data-ng-bind="modalController.getFormattedDate(customization.enabledEndDate)"></p>\n                </div>\n            </div>\n        </div>\n        <div>\n            <div data-uib-dropdown\n                class="y-dropdown-more-menu mobile-more-menu">\n                <button type="button"\n                    data-uib-dropdown-toggle\n                    class="fd-button--link">\n                    <span class="sap-icon--overflow"></span>\n                </button>\n                <ul data-uib-dropdown-menu\n                    class="se-y-dropdown-menu__list fd-menu__list"\n                    role="menu">\n                    <li>\n                        <a data-ng-click="modalController.editCustomizationAction(customization)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-translate="personalization.modal.manager.customization.options.edit"></a>\n                    </li>\n                    <li data-ng-class="modalController.isFilterEnabled() || $first ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(modalController.isFilterEnabled() || $first) ? $event.stopPropagation() : modalController.setCustomizationRank(customization, -1)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-translate="personalization.modal.manager.customization.options.moveup"></a>\n                    </li>\n                    <li data-ng-class="modalController.isFilterEnabled() || $last ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(modalController.isFilterEnabled() || $last) ? $event.stopPropagation() : modalController.setCustomizationRank(customization, 1)"\n                            class="se-dropdown-item fd-menu__item"\n                            data-translate="personalization.modal.manager.customization.options.movedown"></a>\n                    </li>\n                    <li>\n                        <a data-ng-click="modalController.deleteCustomizationAction(customization)"\n                            class="se-dropdown-item fd-menu__item fd-has-color-status-3"\n                            data-translate="personalization.modal.manager.customization.options.delete"></a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n        \x3c!--end contextual menu dropdown--\x3e\n    </div>\n    \x3c!--end mobile-layout for customization row--\x3e\n</div>\n\x3c!--end angular-ui-tree-handle--\x3e\n<div data-uib-collapse="customization.isCollapsed"\n    data-expanding="modalController.customizationClickAction(customization)">\n    <div ui-tree-nodes\n        data-ng-model="customization.variations">\n        <div class="y-tree-row child-row active-level"\n            data-ng-class="{\'perso-library__angular-ui-tree-drag\': variation.isDragging}"\n            ui-tree-node\n            data-ng-repeat="variation in customization.variations | filter:modalController.statusNotDeleted"\n            data-ng-init="variation.isCommerceCustomizationEnabled = modalController.isCommerceCustomizationEnabled()">\n            <div class="desktop-layout variation-rank-{{variation.rank}}-row hidden-sm hidden-xs"\n                data-ng-class="$last ? \'active-level--last\':\'\'">\n                <div>\n                    <span class="perso__cc-icon hyicon hyicon-commerce"\n                        data-ng-class="{\'perso__cc-icon--hidden\': !modalController.hasCommerceActions(variation)}"\n                        data-uib-tooltip-html="modalController.getCommerceCustomizationTooltip(variation)"\n                        data-tooltip-placement="top-left"></span>\n                </div>\n                <div ui-tree-handle\n                    class="y-tree-row__angular-ui-tree-handle">\n                    <div class="y-tree__col--xl perso-wrap-ellipsis"\n                        title={{variation.name}}>\n                        <span data-ng-bind="variation.name"></span>\n                    </div>\n                    <div class="y-tree__col--xs"\n                        data-ng-bind="variation.numberOfComponents">\n                    </div>\n                    <div class="y-tree__col--md perso-tree__status"\n                        data-ng-class="modalController.getActivityStateForVariation(customization,variation)">\n                        <span data-ng-bind="modalController.getEnablementTextForVariation(variation)"\n                            class="perso-library__status-layout"></span>\n                    </div>\n                    <div class="y-tree__col--lg"></div>\n                </div>\n                <div>\n                    <div data-uib-dropdown\n                        class="y-dropdown-more-menu">\n                        <button type="button"\n                            data-uib-dropdown-toggle\n                            class="fd-button--light">\n                            <span class="sap-icon--overflow"></span>\n                        </button>\n                        <ul data-uib-dropdown-menu\n                            class="se-y-dropdown-menu__list fd-menu__list"\n                            role="menu">\n                            <li>\n                                <a data-ng-click="modalController.editVariationAction(customization, variation)"\n                                    data-translate="personalization.modal.manager.variation.options.edit"></a>\n                            </li>\n                            <li>\n                                <a data-ng-click="modalController.toogleVariationActive(customization,variation)"\n                                    class="se-dropdown-item fd-menu__item"\n                                    data-ng-bind="modalController.getEnablementActionTextForVariation(variation)"></a>\n                            </li>\n                            <li data-ng-show="variation.isCommerceCustomizationEnabled">\n                                <a data-ng-click="modalController.manageCommerceCustomization(customization, variation)"\n                                    class="se-dropdown-item fd-menu__item"\n                                    data-translate="personalization.modal.manager.variation.options.commercecustomization"></a>\n                            </li>\n                            <li data-ng-class="$first ? \'disabled\' : \'\' ">\n                                <a data-ng-click="$first ? $event.stopPropagation() : modalController.setVariationRank(customization, variation, -1)"\n                                    class="se-dropdown-item fd-menu__item"\n                                    data-translate="personalization.modal.manager.variation.options.moveup"></a>\n                            </li>\n                            <li data-ng-class="$last ? \'disabled\' : \'\' ">\n                                <a data-ng-click="$last ? $event.stopPropagation() : modalController.setVariationRank(customization, variation, 1)"\n                                    class="se-dropdown-item fd-menu__item"\n                                    data-translate="personalization.modal.manager.variation.options.movedown"></a>\n                            </li>\n                            <li data-ng-class="modalController.isDeleteVariationEnabled(customization) ? \'\' : \'disabled\' ">\n                                <a data-ng-click="modalController.deleteVariationAction(customization, variation, $event)"\n                                    class="se-dropdown-item fd-menu__item fd-has-color-status-3"\n                                    data-translate="personalization.modal.manager.variation.options.delete"></a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                \x3c!--end contextual menu dropdown--\x3e\n            </div>\n            \x3c!--end desktop-layout for variation row--\x3e\n            <div class="mobile-layout hidden-xl hidden-lg hidden-md variation-rank-{{variation.rank}}-row"\n                data-ng-class="$last ? \'active-level--last\':\'\'">\n                <div>\n                    <span class="perso__cc-icon hyicon hyicon-commerce"\n                        data-ng-class="{\'perso__cc-icon--hidden\': !modalController.hasCommerceActions(variation)}"\n                        data-uib-tooltip-html="modalController.getCommerceCustomizationTooltip(variation)"\n                        data-tooltip-placement="top-left"></span>\n                </div>\n                <div ui-tree-handle\n                    class="y-tree-row__angular-ui-tree-handle--mobile">\n                    <div>\n                        <p class="y-tree__col-xl--mobile perso-wrap-ellipsis"\n                            title="{{variation.name}}">\n                            <span data-ng-bind="variation.name"></span>\n                        </p>\n                        <div class="mobile-data">\n                            <span class="perso-library__tree-head--mobile"\n                                data-translate="personalization.modal.manager.grid.header.components"></span>\n                            <div data-ng-bind="variation.numberOfComponents"></div>\n                        </div>\n                        <div class="mobile-data perso-tree__status"\n                            data-ng-class="modalController.getActivityStateForVariation(customization,variation)">\n                            <span data-ng-bind="modalController.getEnablementTextForVariation(variation)"></span>\n                        </div>\n                    </div>\n                </div>\n                <div>\n                    <div class="y-dropdown-more-menu mobile-more-menu">\n                        <div data-uib-dropdown>\n                            <button type="button"\n                                data-uib-dropdown-toggle\n                                class="fd-button--light">\n                                <span class="sap-icon--overflow"></span>\n                            </button>\n                            <ul data-uib-dropdown-menu\n                                class="se-y-dropdown-menu__list fd-menu__list"\n                                role="menu">\n                                <li>\n                                    <a data-ng-click="modalController.editVariationAction(customization, variation)"\n                                        class="se-dropdown-item fd-menu__item"\n                                        data-translate="personalization.modal.manager.variation.options.edit"></a>\n                                </li>\n                                <li>\n                                    <a data-ng-click="modalController.toogleVariationActive(customization,variation)"\n                                        class="se-dropdown-item fd-menu__item"\n                                        data-ng-bind="modalController.getEnablementActionTextForVariation(variation)"></a>\n                                </li>\n                                <li data-ng-show="variation.isCommerceCustomizationEnabled">\n                                    <a data-ng-click="modalController.manageCommerceCustomization(customization, variation)"\n                                        class="se-dropdown-item fd-menu__item"\n                                        data-translate="personalization.modal.manager.variation.options.commercecustomization"></a>\n                                </li>\n                                <li data-ng-class="$first ? \'disabled\' : \'\' ">\n                                    <a data-ng-click="$first ? $event.stopPropagation() : modalController.setVariationRank(customization, variation, -1)"\n                                        class="se-dropdown-item fd-menu__item"\n                                        data-translate="personalization.modal.manager.variation.options.moveup"></a>\n                                </li>\n                                <li data-ng-class="$last ? \'disabled\' : \'\' ">\n                                    <a data-ng-click="$last ? $event.stopPropagation() : modalController.setVariationRank(customization, variation, 1)"\n                                        class="se-dropdown-item fd-menu__item"\n                                        data-translate="personalization.modal.manager.variation.options.movedown"></a>\n                                </li>\n                                <li data-ng-class="modalController.isDeleteVariationEnabled(customization) ? \'\' : \'disabled\' ">\n                                    <a data-ng-click="modalController.deleteVariationAction(customization, variation, $event)"\n                                        class="se-dropdown-item fd-menu__item fd-has-color-status-3"\n                                        data-translate="personalization.modal.manager.variation.options.delete"></a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    \x3c!--end contextual menu dropdown--\x3e\n                </div>\n            </div>\n            \x3c!--end mobile-layout for variation row--\x3e\n        </div>\n        \x3c!--end variation-repeat--\x3e\n    </div>\n</div>\n\x3c!--end collapse--\x3e'),t.put("web/features/personalizationsmarteditcontainer/management/managerView/personalizationsmarteditManagerViewTemplate.html",'<div id="editConfigurationsBody-001"\n    class="perso-library">\n    <personalizationsmartedit-scroll-zone data-ng-if="scrollZoneElement != null"\n        data-is-transparent="true"\n        data-scroll-zone-id="\'managerview\'"\n        data-scroll-zone-visible="scrollZoneVisible"\n        data-get-element-to-scroll="modalController.getElementToScroll()"></personalizationsmartedit-scroll-zone>\n\n    <div class="perso-library__scroll-zone perso__scrollbar--hidden"\n        personalization-infinite-scroll="modalController.addMoreItems()"\n        personalization-infinite-scroll-distance="2">\n        <div personalization-current-element="modalController.setScrollZoneElement">\n            <div class="perso-library__header">\n                <div class="perso-library__title">\n                    <span data-ng-bind="modalController.catalogName"></span> | {{\'personalization.toolbar.pagecustomizations.header.title\' | translate}} ({{filteredCustomizationsCount}})\n                </div>\n                <div class="se-input-group perso-library__search">\n                    <div class="perso-search-panel perso-input-group">\n                        <input type="text"\n                            class="se-input-group--input se-component-search--input ng-pristine ng-untouched ng-valid"\n                            placeholder="{{ \'personalization.modal.manager.search.placeholder\' | translate}}"\n                            ng-model="modalController.search.name"\n                            ng-keyup="modalController.searchInputKeypress($event)">\n                        </input>\n\n                        <span class="sap-icon--search se-component-search--search-icon se-input-group__addon"></span>\n                        <div class="se-input-group__addon se-input-group--clear"\n                            data-ng-show="modalController.search.name"\n                            ng-click="modalController.search.name=\'\'; modalController.searchInputKeypress($event)">\n                            <span class="sap-icon--decline"></span>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="perso-library__status">\n                    <ui-select ng-model="modalController.search.status"\n                        on-select="modalController.refreshGrid()"\n                        data-backspace-reset="false"\n                        theme="select2"\n                        title=""\n                        search-enabled="false">\n                        <ui-select-match>\n                            <span ng-bind="$select.selected.text | translate"></span>\n                        </ui-select-match>\n                        <ui-select-choices repeat="item in modalController.statuses"\n                            position="down">\n                            <span ng-bind="item.text | translate"></span>\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n                <button class="fd-button perso-library__add-button"\n                    type="button"\n                    data-ng-click="modalController.openNewModal();">\n                    <span data-translate="personalization.modal.manager.add.button"></span>\n                </button>\n            </div>\n\n            <div class="y-tree perso-library__y-tree">\n                \x3c!-- headers --\x3e\n                <div data-ng-show="modalController.isSearchGridHeaderHidden()"\n                    class="y-tree-header y-tree-header--fixed">\n                    <data-ng-include src="\'personalizationsmarteditManagerViewGridHeaderTemplate.html\'"></data-ng-include>\n                </div>\n                <div class="y-tree-header">\n                    <data-ng-include src="\'personalizationsmarteditManagerViewGridHeaderTemplate.html\'"></data-ng-include>\n                </div>\n                \x3c!--end y-tree-header--\x3e\n\n                <div ui-tree="modalController.treeOptions"\n                    id="tree-root">\n                    <div ui-tree-nodes\n                        data-ng-model="modalController.customizations">\n                        <div data-ng-repeat="customization in modalController.customizations"\n                            data-ng-class="{\'perso-library__angular-ui-tree-drag\': customization.isDragging}"\n                            ui-tree-node\n                            data-ng-include="\'personalizationsmarteditManagerViewNodeTemplate.html\'"></div>\n                    </div>\n                </div>\n\n                <div class="pe-spinner--outer"\n                    data-ng-show="modalController.moreCustomizationsRequestProcessing">\n                    <div data-ng-include="\'waitDialog.html\'"></div>\n                </div>\n                \x3c!--end customization-repeat--\x3e\n            </div>\n            \x3c!--end y-tree--\x3e\n        </div>\n    </div>\n    \x3c!--end scroll zone--\x3e\n\n    <a class="perso-library__back-to-top-button"\n        title="{{\'personalization.commons.button.title.backtotop\' | translate}}"\n        data-ng-show="modalController.isReturnToTopButtonVisible()"\n        data-ng-click="modalController.scrollZoneReturnToTop()">\n        <span class="hyicon hyicon-top back-to-top"></span>\n    </a>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/toolbarContext/personalizationsmarteditToolbarContextTemplate.html",'<div data-ng-show="$ctrl.visible"\n    class="pe-toolbar-item-context">\n    <span class="sap-icon--slim-arrow-right pe-toolbar-item-context__icon"></span>\n    <div class="pe-toolbar-item-context__btn">\n        <div class="pe-toolbar-item-context__btn-txt">\n            <div title="{{$ctrl.title}}"\n                class="perso-wrap-ellipsis pe-toolbar-item-context__btn-title">{{$ctrl.title}}</div>\n            <div title="{{$ctrl.subtitle}}"\n                class="perso-wrap-ellipsis pe-toolbar-item-context__btn-subtitle">{{$ctrl.subtitle}}</div>\n        </div>\n    </div>\n    <div class="pe-toolbar-item-context__btn-hyicon"\n        data-ng-click="$ctrl.clear()">\n        <span class="sap-icon--decline"></span>\n    </div>\n</div>')}])},function(t,e,i){var n={"./templates.js":11};function webpackContext(t){var e=webpackContextResolve(t);return i(e)}function webpackContextResolve(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}webpackContext.keys=function webpackContextKeys(){return Object.keys(n)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=10},function(t,e){angular.module("personalizationcommonsTemplates",[]).run(["$templateCache",function(t){"use strict";t.put("web/features/personalizationcommons/dateTimePickerRange/dateTimePickerRangeTemplate.html",'<div class="pe-datetime-range">\n    <div class="col-md-6 pe-datetime-range__from"\n        data-ng-class="{\'has-error\': !$ctrl.isFromDateValid}">\n        <label for="customization-start-date"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate"\n            class="fd-form__label perso__datetimepicker__label"></label>\n        <y-help data-template="\'<span data-translate=personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate.help></span>\'">\n        </y-help>\n        <div class="input-group se-date-field pe-date-field"\n            id="date-picker-range-from"\n            data-ng-show="$ctrl.isEditable">\n            <input type=\'text\'\n                name="date_from_key"\n                class="fd-form-control se-date-field--input pe-date-field__input"\n                placeholder="{{ $ctrl.placeholderText | translate}}"\n                data-ng-disabled="!$ctrl.isEditable"\n                name="{{$ctrl.name}}"\n                data-ng-model="$ctrl.dateFrom"\n                id="customization-start-date" />\n            <span class="input-group-addon se-date-field--button pe-datetime-range__picker"\n                data-ng-show="$ctrl.isEditable">\n                <span class="sap-icon--calendar pe-datetime-range__picker__icon"></span>\n            </span>\n        </div>\n        <div class="input-group se-date-field pe-date-field"\n            id="date-picker-range-from"\n            data-ng-show="!$ctrl.isEditable">\n            <input type=\'text\'\n                name="date_from_key"\n                class="fd-form-control se-date-field--input pe-date-field__input "\n                data-ng-class="{\'pe-input--is-disabled\': !$ctrl.isEditable}"\n                data-ng-model="$ctrl.dateFrom"\n                data-date-formatter\n                id="customization-start-date"\n                data-ng-disabled="true"\n                data-format-type="short">\n        </div>\n        <span data-ng-if="!$ctrl.isFromDateValid"\n            class="help-block pe-datetime__error-msg pe-datetime__msg"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description">\n        </span>\n    </div>\n    <div class="col-md-6 pe-datetime-range__to"\n        data-ng-class="{\'has-error\':!$ctrl.isToDateValid, \'has-warning\':$ctrl.isEndDateInThePast}">\n        <label for="customization-end-date"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate"\n            class="fd-form__label perso__datetimepicker__label"></label>\n        <y-help data-template="\'<span data-translate=personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate.help></span>\'">\n        </y-help>\n        <div class="input-group se-date-field pe-date-field"\n            id="date-picker-range-to">\n            <input type=\'text\'\n                name="date_to_key"\n                class="fd-form-control se-date-field--input pe-date-field__input"\n                placeholder="{{ $ctrl.placeholderText | translate}}"\n                data-ng-disabled="!$ctrl.isEditable"\n                name="{{$ctrl.name}}"\n                data-ng-model="$ctrl.dateTo"\n                id="customization-end-date" />\n            <span class="input-group-addon se-date-field--button pe-datetime-range__picker"\n                data-ng-show="$ctrl.isEditable">\n                <span class="sap-icon--calendar pe-datetime-range__picker__icon"></span>\n            </span>\n        </div>\n        <div class="input-group se-date-field pe-date-field"\n            id="date-picker-range-to"\n            data-ng-show="!$ctrl.isEditable">\n            <input type=\'text\'\n                name="date_to_key"\n                class="fd-form-control se-date-field--input pe-date-field__input "\n                data-ng-class="{\'pe-input--is-disabled\': !$ctrl.isEditable}"\n                data-ng-model="$ctrl.dateTo"\n                data-date-formatter\n                id="customization-end-date"\n                data-ng-disabled="true"\n                data-format-type="short">\n        </div>\n        <span class="help-block pe-datetime__error-msg pe-datetime__msg"\n            data-ng-if="!$ctrl.isToDateValid"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformat.description">\n        </span>\n        <span data-ng-if="$ctrl.isEndDateInThePast"\n            class="help-block pe-datetime__warning-msg pe-datetime__msg">\n            <span data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddateinthepast.description"></span>\n        </span>\n    </div>\n</div>'),t.put("web/features/personalizationcommons/personalizationsmarteditScrollZone/personalizationsmarteditScrollZoneBottomTemplate.html",'<div class="perso__scrollzone perso__scrollzone--bottom"\n    data-ng-class="$ctrl.isTransparent?\'perso__scrollzone--transparent\':\'perso__scrollzone--normal\'"\n    data-ng-show="$ctrl.scrollZoneVisible && $ctrl.scrollZoneBottom"\n    data-ng-mouseenter="$ctrl.start=true;$ctrl.scrollBottom()"\n    data-ng-mouseleave="$ctrl.stopScroll()">\n</div>'),t.put("web/features/personalizationcommons/personalizationsmarteditScrollZone/personalizationsmarteditScrollZoneTopTemplate.html",'<div class="perso__scrollzone perso__scrollzone--top"\n    data-ng-class="$ctrl.isTransparent?\'perso__scrollzone--transparent\':\'perso__scrollzone--normal\'"\n    data-ng-show="$ctrl.scrollZoneVisible && $ctrl.scrollZoneTop"\n    data-ng-mouseenter="$ctrl.start=true;$ctrl.scrollTop()"\n    data-ng-mouseleave="$ctrl.stopScroll()">\n</div>')}])},function(t,e){function webpackEmptyContext(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,t.exports=webpackEmptyContext,webpackEmptyContext.id=12},function(t,e){t.exports=smarteditcommons},function(t,e,i){"use strict";i.r(e),i.d(e,"Personalizationsmarteditcontainermodule",function(){return $t}),i.d(e,"PersonalizationsmarteditContainer",function(){return Lt});var n=i(1),a=i(2);function importAll(t){t.keys().forEach(function(e){t(e)})}var o=i(0);window.__smartedit__.addDecoratorPayload("SeComponent","ManageCustomizationViewComponent",{templateUrl:"manageCustomizationViewTemplate.html",inputs:["modalManager: =","customizationCode","variationCode"]});var s=function(){function ManageCustomizationViewComponent(t,e,i,n,a,o,s,r,l,c,d,m,p,u,g,h){this.$q=t,this.DATE_CONSTANTS=e,this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS=i,this.PERSONALIZATION_MODEL_STATUS_CODES=n,this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS=a,this.PERSONALIZATION_DATE_FORMATS=o,this.MODAL_BUTTON_ACTIONS=s,this.personalizationsmarteditRestService=r,this.personalizationsmarteditDateUtils=l,this.personalizationsmarteditMessageHandler=c,this.personalizationsmarteditCommerceCustomizationService=d,this.personalizationsmarteditUtils=m,this.confirmationModalService=p,this.systemEventService=u,this.$filter=g,this.$log=h,this.initialCustomization={name:"",enabledStartDate:"",enabledEndDate:"",status:"ENABLED",statusBoolean:!0,variations:[]},this.customization={},this.activeTabNumber=0,this.editMode=!1}return ManageCustomizationViewComponent.$inject=["$q","DATE_CONSTANTS","CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS","PERSONALIZATION_MODEL_STATUS_CODES","CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS","PERSONALIZATION_DATE_FORMATS","MODAL_BUTTON_ACTIONS","personalizationsmarteditRestService","personalizationsmarteditDateUtils","personalizationsmarteditMessageHandler","personalizationsmarteditCommerceCustomizationService","personalizationsmarteditUtils","confirmationModalService","systemEventService","$filter","$log"],ManageCustomizationViewComponent.prototype.$onInit=function(){var t=this;this.customizationCode?(this.getCustomization(),this.editMode=!0):this.customization=a.copy(this.initialCustomization),this.initTabs(),this.modalManager.setDismissCallback(function(){return t.onCancel()}),this.modalManager.setButtonHandler(function(e){switch(e){case t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK:case t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT:return t.edit.selectedTab.onConfirm();case t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_CANCEL:return t.edit.selectedTab.onCancel();default:t.$log.error(t.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.invalidbuttonid"),e)}}),this.edit={code:"",name:"",selectedTab:this.tabsArr[0]}},ManageCustomizationViewComponent.prototype.$doCheck=function(){var t=this.edit.selectedTab.isDirty(),e=this.edit.selectedTab.isValid();t?e?this.edit.selectedTab.setEnabled(!0):this.edit.selectedTab.setEnabled(!1):this.editMode&&e?this.edit.selectedTab.setEnabled(!0):this.edit.selectedTab.setEnabled(!1)},ManageCustomizationViewComponent.prototype.getVariationsForCustomization=function(t){return this.personalizationsmarteditRestService.getVariationsForCustomization(t,{includeFullFields:!0})},ManageCustomizationViewComponent.prototype.createCommerceCustomizationData=function(t){var e=this;t.forEach(function(t){t.commerceCustomizations=e.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCountMap(t),t.numberOfCommerceActions=e.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCount(t),delete t.actions})},ManageCustomizationViewComponent.prototype.getCustomization=function(){var t=this,e={code:this.customizationCode};this.personalizationsmarteditRestService.getCustomization(e).then(function(e){t.customization=e,t.customization.enabledStartDate=t.personalizationsmarteditDateUtils.formatDate(t.customization.enabledStartDate,void 0),t.customization.enabledEndDate=t.personalizationsmarteditDateUtils.formatDate(t.customization.enabledEndDate,void 0),t.customization.statusBoolean=t.customization.status===t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,t.getVariationsForCustomization(t.customizationCode).then(function(e){if(t.createCommerceCustomizationData(e.variations),t.customization.variations=e.variations,a.isDefined(t.variationCode)){var i=t.customization.variations.filter(function(e){return e.code===t.variationCode});if(i.length>0){t.activeTabNumber=1,t.edit.selectedTab=t.tabsArr[1];var n=i[0];t.edit.selectedVariation=n}t.initialCustomization=a.copy(t.customization)}else t.edit.selectedTab=t.tabsArr[0],t.initialCustomization=a.copy(t.customization)},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.gettingsegments"))})},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.gettingcomponents"))})},ManageCustomizationViewComponent.prototype.initTabs=function(){var t=this;this.tabsArr=[{name:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_NAME,active:!0,disabled:!1,heading:this.$filter("translate")("personalization.modal.customizationvariationmanagement.basicinformationtab"),template:"basicInfoTabWrapperTemplate.html",formName:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_FORM_NAME,isDirty:function(){return t.isModalDirty()},isValid:function(){return 0===t.isBasicInfoTabValid(t.customization).length},setEnabled:function(e){e?(t.tabsArr[1].disabled=!1,t.modalManager.enableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT)):(t.tabsArr[1].disabled=!0,t.modalManager.disableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT))},onConfirm:function(){t.activeTabNumber=1},onCancel:function(){t.onCancel()}},{name:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_NAME,active:!1,disabled:!0,heading:this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab"),template:"targetGroupTabWrapperTemplate.html",formName:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_FORM_NAME,isDirty:function(){return t.isModalDirty()},isValid:function(){return 0===t.isTargetGroupTabValid(t.customization).length},setEnabled:function(e){e?t.modalManager.enableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK):t.modalManager.disableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK)},onConfirm:function(){t.onSave()},onCancel:function(){t.onCancel()}}]},ManageCustomizationViewComponent.prototype.selectTab=function(t){switch(this.edit.selectedTab=t,this.activeTabNumber=this.tabsArr.indexOf(t),t.name){case this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_NAME:this.modalManager.removeButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK),this.modalManager.getButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT)||this.modalManager.addButton({id:this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT,label:"personalization.modal.customizationvariationmanagement.basicinformationtab.button.next"});break;case this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_NAME:this.modalManager.removeButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT),this.modalManager.getButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK)||this.modalManager.addButton({id:this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK,label:"personalization.modal.customizationvariationmanagement.targetgrouptab.button.submit",action:this.MODAL_BUTTON_ACTIONS.CLOSE}),this.customization.enabledStartDate&&(this.customization.enabledStartDate=this.personalizationsmarteditDateUtils.formatDate(this.customization.enabledStartDate,this.DATE_CONSTANTS.MOMENT_FORMAT)),this.customization.enabledEndDate&&(this.customization.enabledEndDate=this.personalizationsmarteditDateUtils.formatDate(this.customization.enabledEndDate,this.DATE_CONSTANTS.MOMENT_FORMAT))}},ManageCustomizationViewComponent.prototype.onSave=function(){var t=this;this.customization.enabledStartDate?this.customization.enabledStartDate=this.personalizationsmarteditDateUtils.formatDate(this.customization.enabledStartDate,this.PERSONALIZATION_DATE_FORMATS.MODEL_DATE_FORMAT):this.customization.enabledStartDate=void 0,this.customization.enabledEndDate?this.customization.enabledEndDate=this.personalizationsmarteditDateUtils.formatDate(this.customization.enabledEndDate,this.PERSONALIZATION_DATE_FORMATS.MODEL_DATE_FORMAT):this.customization.enabledEndDate=void 0,this.customization.status=this.customization.statusBoolean?this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED,this.editMode?this.personalizationsmarteditRestService.updateCustomizationPackage(this.customization).then(function(){t.systemEventService.sendSynchEvent("CUSTOMIZATIONS_MODIFIED",{}),t.personalizationsmarteditMessageHandler.sendSuccess(t.$filter("translate")("personalization.info.updatingcustomization"))},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.updatingcustomization"))}):this.personalizationsmarteditRestService.createCustomization(this.customization).then(function(){t.systemEventService.sendSynchEvent("CUSTOMIZATIONS_MODIFIED",{}),t.personalizationsmarteditMessageHandler.sendSuccess(t.$filter("translate")("personalization.info.creatingcustomization"))},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.creatingcustomization"))})},ManageCustomizationViewComponent.prototype.onCancel=function(){var t=this,e=this.$q.defer();return this.isModalDirty()?this.confirmationModalService.confirm({description:this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.cancelconfirmation")}).then(function(){t.modalManager.dismiss(),e.resolve()},function(){e.reject()}):(this.modalManager.dismiss(),e.resolve()),e.promise},ManageCustomizationViewComponent.prototype.isBasicInfoTabValid=function(t){var e=[];return(a.isUndefined(t.name)||""===t.name)&&e.push("name cant be empty"),e},ManageCustomizationViewComponent.prototype.isTargetGroupTabValid=function(t){var e=[];return a.isArray(t.variations)&&this.personalizationsmarteditUtils.getVisibleItems(t.variations).length>0||e.push("variations cant be empty"),e},ManageCustomizationViewComponent.prototype.isCustomizationValid=function(t){var e=[];return e.push(this.isBasicInfoTabValid(t)),e.push(this.isTargetGroupTabValid(t)),e},ManageCustomizationViewComponent.prototype.isModalDirty=function(){return!a.equals(this.initialCustomization,this.customization)},ManageCustomizationViewComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"manageCustomizationViewTemplate.html",inputs:["modalManager: =","customizationCode","variationCode"]})],ManageCustomizationViewComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","BasicInfoTabComponent",{templateUrl:"basicInfoTabTemplate.html",inputs:["customization: =?"]});var r=function(){function BasicInfoTabComponent(t,e){this.PERSONALIZATION_MODEL_STATUS_CODES=t,this.DATE_CONSTANTS=e,this.datetimeConfigurationEnabled=!1}return BasicInfoTabComponent.$inject=["PERSONALIZATION_MODEL_STATUS_CODES","DATE_CONSTANTS"],Object.defineProperty(BasicInfoTabComponent.prototype,"customization",{get:function(){return this._customization},set:function(t){this._customization=t,this.datetimeConfigurationEnabled=this.customization.enabledStartDate||this.customization.enabledEndDate},enumerable:!0,configurable:!0}),BasicInfoTabComponent.prototype.resetDateTimeConfiguration=function(){this.customization.enabledStartDate=void 0,this.customization.enabledEndDate=void 0},BasicInfoTabComponent.prototype.customizationStatusChange=function(){this.customization.status=this.customization.statusBoolean?this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED},BasicInfoTabComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"basicInfoTabTemplate.html",inputs:["customization: =?"]})],BasicInfoTabComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","TargetGroupTabComponent",{templateUrl:"targetGroupTabTemplate.html",inputs:["customization: =?","variation"]});var l=function(){function TargetGroupTabComponent(t,e,i,n,a,o,s,r,l,c,d){this.PERSONALIZATION_MODEL_STATUS_CODES=t,this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS=e,this.personalizationsmarteditUtils=i,this.personalizationsmarteditTriggerService=n,this.$filter=a,this.$timeout=o,this.yjQuery=s,this.confirmationModalService=r,this.isBlank=l,this.personalizationsmarteditDateUtils=c,this.triggerTabService=d}return TargetGroupTabComponent.$inject=["PERSONALIZATION_MODEL_STATUS_CODES","CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS","personalizationsmarteditUtils","personalizationsmarteditTriggerService","$filter","$timeout","yjQuery","confirmationModalService","isBlank","personalizationsmarteditDateUtils","triggerTabService"],TargetGroupTabComponent.prototype.getActivityActionTextForVariation=function(t){return t.enabled?this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.disable"):this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.enable")},TargetGroupTabComponent.prototype.getActivityStateForCustomization=function(t){return this.personalizationsmarteditUtils.getActivityStateForCustomization(t)},TargetGroupTabComponent.prototype.getActivityStateForVariation=function(t,e){return this.personalizationsmarteditUtils.getActivityStateForVariation(t,e)},TargetGroupTabComponent.prototype.getEnablementTextForVariation=function(t){return"("+this.personalizationsmarteditUtils.getEnablementTextForVariation(t,"personalization.modal.customizationvariationmanagement.targetgrouptab")+")"},TargetGroupTabComponent.prototype.setSliderConfigForAdd=function(){var t=this;this.sliderPanelConfiguration.modal.save.label="personalization.modal.customizationvariationmanagement.targetgrouptab.addvariation",this.sliderPanelConfiguration.modal.save.isDisabledFn=function(){return!t.canSaveVariation()},this.sliderPanelConfiguration.modal.save.onClick=function(){t.addVariationClick()}},TargetGroupTabComponent.prototype.setSliderConfigForEditing=function(){var t=this;this.sliderPanelConfiguration.modal.save.label="personalization.modal.customizationvariationmanagement.targetgrouptab.savechanges",this.sliderPanelConfiguration.modal.save.isDisabledFn=function(){return!t.canSaveVariation()},this.sliderPanelConfiguration.modal.save.onClick=function(){t.submitChangesClick()}},TargetGroupTabComponent.prototype.toggleSliderFullscreen=function(t){var e=this,i=a.element(".sliderPanelParentModal");i.hasClass("modal-fullscreen")||!1===t?i.removeClass("modal-fullscreen"):i.addClass("modal-fullscreen"),this.$timeout(function(){e.yjQuery(window).resize()},0)},TargetGroupTabComponent.prototype.confirmDefaultTrigger=function(t){var e=this;t&&this.personalizationsmarteditTriggerService.isValidExpression(this.edit.expression[0])?this.confirmationModalService.confirm({description:"personalization.modal.manager.targetgrouptab.defaulttrigger.content"}).then(function(){e.edit.showExpression=!1},function(){e.edit.isDefault=!1}):this.edit.showExpression=!t},TargetGroupTabComponent.prototype.canSaveVariation=function(){var t=this.triggerTabService.getTriggersTabs(),e=t.every(function(t){return t.isValidOrEmpty()}),i=t.some(function(t){return t.isTriggerDefined()}),n=!this.isBlank(this.edit.name);return n=n&&(this.edit.isDefault||i&&e)},TargetGroupTabComponent.prototype.addVariationClick=function(){var t=this;this.customization.variations.push({code:this.edit.code,name:this.edit.name,enabled:!0,status:this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,triggers:this.personalizationsmarteditTriggerService.buildTriggers(this.edit,this.edit.selectedVariation.triggers||[]),rank:this.customization.variations.length,isNew:!0}),this.clearEditedVariationDetails(),this.toggleSliderFullscreen(!1),this.$timeout(function(){t.hideSliderPanel()},0)},TargetGroupTabComponent.prototype.submitChangesClick=function(){var t=this,e=this.personalizationsmarteditTriggerService.buildTriggers(this.edit,this.edit.selectedVariation.triggers||[]);this.edit.selectedVariation.triggers=e,this.edit.selectedVariation.name=this.edit.name,this.edit.selectedVariation=void 0,this.toggleSliderFullscreen(!1),this.$timeout(function(){t.hideSliderPanel()},0)},TargetGroupTabComponent.prototype.cancelChangesClick=function(){this.isVariationSelected()?this.edit.selectedVariation=void 0:this.clearEditedVariationDetails(),this.toggleSliderFullscreen(!1),this.hideSliderPanel()},TargetGroupTabComponent.prototype.isVariationSelected=function(){return a.isDefined(this.edit.selectedVariation)},TargetGroupTabComponent.prototype.clearEditedVariationDetails=function(){this.edit.code="",this.edit.name="",this.edit.expression=[],this.edit.isDefault=!1,this.edit.showExpression=!0},TargetGroupTabComponent.prototype.setVariationRank=function(t,e,i,n){if(n)i.stopPropagation();else{var a=this.customization.variations.indexOf(t),o=this.personalizationsmarteditUtils.getValidRank(this.customization.variations,t,e),s=this.customization.variations;o>=0&&o<s.length&&(s.splice(o,0,s.splice(a,1)[0]),this.recalculateRanksForVariations())}},TargetGroupTabComponent.prototype.recalculateRanksForVariations=function(){var t=this;this.customization.variations.forEach(function(e,i){t.customization.variations[i].rank=i})},TargetGroupTabComponent.prototype.removeVariationClick=function(t){var e=this;this.confirmationModalService.confirm({description:"personalization.modal.manager.targetgrouptab.deletevariation.content"}).then(function(){t.isNew?e.customization.variations.splice(e.customization.variations.indexOf(t),1):t.status="DELETED",e.edit.selectedVariation=void 0,e.recalculateRanksForVariations()})},TargetGroupTabComponent.prototype.addVariationAction=function(){this.clearEditedVariationDetails(),this.setSliderConfigForAdd(),this.showSliderPanel(),this.edit.selectedVariation={triggers:[]}},TargetGroupTabComponent.prototype.editVariationAction=function(t){this.setSliderConfigForEditing(),this.edit.selectedVariation=t,this.edit.code=t.code,this.edit.name=t.name,this.edit.isDefault=this.personalizationsmarteditTriggerService.isDefault(t.triggers),this.edit.showExpression=!this.edit.isDefault,this.showSliderPanel()},TargetGroupTabComponent.prototype.toogleVariationActive=function(t){t.enabled=!t.enabled,t.status=t.enabled?this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED},TargetGroupTabComponent.prototype.$onInit=function(){var t=this;this.edit=this.triggerTabService.getTriggerDataState(),this.sliderPanelConfiguration={modal:{showDismissButton:!0,title:"personalization.modal.customizationvariationmanagement.targetgrouptab.slidingpanel.title",cancel:{label:"personalization.modal.customizationvariationmanagement.targetgrouptab.cancelchanges",onClick:function(){t.cancelChangesClick()}},dismiss:{onClick:function(){t.cancelChangesClick()}},save:{}},cssSelector:"#y-modal-dialog"};var e={id:"segmentTrigger",title:"personalization.modal.customizationvariationmanagement.targetgrouptab.segments",templateUrl:"personalizationsmarteditSegmentViewWrapperTemplate.html",isTriggerDefined:function(){return t.personalizationsmarteditTriggerService.isValidExpression(t.edit.expression[0])},isValidOrEmpty:function(){return t.edit.expression=t.edit.expression||[{nodes:[]}],t.personalizationsmarteditTriggerService.isValidExpression(t.edit.expression[0])||0===t.edit.expression.length||0===t.edit.expression[0].nodes.length||t.personalizationsmarteditTriggerService.isDropzone(t.edit.expression[0].nodes[0])}};this.triggerTabService.addTriggerTab(e)},TargetGroupTabComponent.prototype.$onChanges=function(t){t.variation&&t.variation.currentValue&&this.editVariationAction(t.variation.currentValue)},TargetGroupTabComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"targetGroupTabTemplate.html",inputs:["customization: =?","variation"]})],TargetGroupTabComponent)}(),c=function(){function PersonalizationsmarteditTriggerService(){this.DEFAULT_TRIGGER="defaultTriggerData",this.SEGMENT_TRIGGER="segmentTriggerData",this.EXPRESSION_TRIGGER="expressionTriggerData",this.supportedTypes=[this.DEFAULT_TRIGGER,this.SEGMENT_TRIGGER,this.EXPRESSION_TRIGGER],this.actions=[{id:"AND",name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.and"},{id:"OR",name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.or"},{id:"NOT",name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.not"}],this.GROUP_EXPRESSION="groupExpressionData",this.SEGMENT_EXPRESSION="segmentExpressionData",this.NEGATION_EXPRESSION="negationExpressionData",this.CONTAINER_TYPE="container",this.ITEM_TYPE="item",this.DROPZONE_TYPE="dropzone"}return PersonalizationsmarteditTriggerService.prototype.isContainer=function(t){return this.isElementOfType(t,this.CONTAINER_TYPE)},PersonalizationsmarteditTriggerService.prototype.isEmptyContainer=function(t){return this.isContainer(t)&&0===t.nodes.length},PersonalizationsmarteditTriggerService.prototype.isNotEmptyContainer=function(t){return this.isContainer(t)&&t.nodes.length>0},PersonalizationsmarteditTriggerService.prototype.isDropzone=function(t){return this.isElementOfType(t,this.DROPZONE_TYPE)},PersonalizationsmarteditTriggerService.prototype.isItem=function(t){return this.isElementOfType(t,this.ITEM_TYPE)},PersonalizationsmarteditTriggerService.prototype.isValidExpression=function(t){var e=this;return!!t&&(this.isContainer(t)?t.nodes&&t.nodes.length>0&&t.nodes.every(function(t){return e.isValidExpression(t)}):a.isDefined(t.selectedSegment))},PersonalizationsmarteditTriggerService.prototype.buildTriggers=function(t,e){var i={};if(t=t||{},this.isDefaultData(t))i=this.buildDefaultTrigger();else if(t.expression&&t.expression.length>0){var n=t.expression[0];i=this.isDropzone(n.nodes[0])?{}:this.isExpressionData(n)?this.buildExpressionTrigger(n):this.buildSegmentTrigger(n)}return this.mergeTriggers(e,i)},PersonalizationsmarteditTriggerService.prototype.buildData=function(t){var e=this,i={},n=this.getBaseData();return t&&t.length>0&&(i=t.filter(function(t){return e.isSupportedTrigger(t)})[0]),this.isDefaultTrigger(i)||(this.isExpressionTrigger(i)?n=this.buildExpressionTriggerData(i):this.isSegmentTrigger(i)&&(n=this.buildSegmentTriggerData(i))),n},PersonalizationsmarteditTriggerService.prototype.isDefault=function(t){var e=this,i=(t||[]).filter(function(t){return e.isDefaultTrigger(t)})[0];return!(!t||!i)},PersonalizationsmarteditTriggerService.prototype.getExpressionAsString=function(t){var e=this,i="";if(void 0===t)return i;var n=this.isNegation(t)?"AND":t.operation.id;return i+=this.isNegation(t)?" NOT ":"",i+="(",t.nodes.forEach(function(t,a){e.isDropzone(t)?i+=" [] ":(i+=a>0?" "+n+" ":"",i+=e.isItem(t)?t.selectedSegment.code:e.getExpressionAsString(t))}),i+=")"},PersonalizationsmarteditTriggerService.prototype.isElementOfType=function(t,e){return!!a.isDefined(t)&&t.type===e},PersonalizationsmarteditTriggerService.prototype.isNegation=function(t){return this.isContainer(t)&&"NOT"===t.operation.id},PersonalizationsmarteditTriggerService.prototype.isDefaultData=function(t){return t.isDefault},PersonalizationsmarteditTriggerService.prototype.isExpressionData=function(t){var e=this;return"NOT"===t.operation.id||t.nodes.some(function(t){return!e.isItem(t)})},PersonalizationsmarteditTriggerService.prototype.isSupportedTrigger=function(t){return this.supportedTypes.indexOf(t.type)>=0},PersonalizationsmarteditTriggerService.prototype.isDefaultTrigger=function(t){return this.isElementOfType(t,this.DEFAULT_TRIGGER)},PersonalizationsmarteditTriggerService.prototype.isSegmentTrigger=function(t){return this.isElementOfType(t,this.SEGMENT_TRIGGER)},PersonalizationsmarteditTriggerService.prototype.isExpressionTrigger=function(t){return this.isElementOfType(t,this.EXPRESSION_TRIGGER)},PersonalizationsmarteditTriggerService.prototype.isGroupExpressionData=function(t){return this.isElementOfType(t,this.GROUP_EXPRESSION)},PersonalizationsmarteditTriggerService.prototype.isSegmentExpressionData=function(t){return this.isElementOfType(t,this.SEGMENT_EXPRESSION)},PersonalizationsmarteditTriggerService.prototype.isNegationExpressionData=function(t){return this.isElementOfType(t,this.NEGATION_EXPRESSION)},PersonalizationsmarteditTriggerService.prototype.buildSegmentsForTrigger=function(t){var e=this;return t.nodes.filter(function(t){return e.isItem(t)}).map(function(t){return t.selectedSegment})},PersonalizationsmarteditTriggerService.prototype.buildExpressionForTrigger=function(t){var e=this;if(this.isNegation(t)){var i=[];return t.nodes.forEach(function(t){i.push(e.buildExpressionForTrigger(t))}),{type:this.NEGATION_EXPRESSION,element:{type:this.GROUP_EXPRESSION,operator:"AND",elements:i}}}if(this.isContainer(t)){var n=[];return t.nodes.forEach(function(t){n.push(e.buildExpressionForTrigger(t))}),{type:this.GROUP_EXPRESSION,operator:t.operation.id,elements:n}}return{type:this.SEGMENT_EXPRESSION,code:t.selectedSegment.code}},PersonalizationsmarteditTriggerService.prototype.buildDefaultTrigger=function(){return{type:this.DEFAULT_TRIGGER}},PersonalizationsmarteditTriggerService.prototype.buildExpressionTrigger=function(t){return{type:this.EXPRESSION_TRIGGER,expression:this.buildExpressionForTrigger(t)}},PersonalizationsmarteditTriggerService.prototype.buildSegmentTrigger=function(t){return{type:this.SEGMENT_TRIGGER,groupBy:t.operation.id,segments:this.buildSegmentsForTrigger(t)}},PersonalizationsmarteditTriggerService.prototype.mergeTriggers=function(t,e){var i=this;if(!a.isDefined(t))return[e];var n=t.findIndex(function(t){return t.type===e.type});n>=0&&(e.code=t[n].code);var o=t.filter(function(t){return!i.isSupportedTrigger(t)});return a.equals(e,{})||o.push(e),o},PersonalizationsmarteditTriggerService.prototype.buildContainer=function(t){var e=this.actions.filter(function(e){return e.id===t})[0];return{type:this.CONTAINER_TYPE,operation:e,nodes:[]}},PersonalizationsmarteditTriggerService.prototype.buildItem=function(t){return{type:this.ITEM_TYPE,operation:"",selectedSegment:{code:t},nodes:[]}},PersonalizationsmarteditTriggerService.prototype.getBaseData=function(){return[this.buildContainer("AND")]},PersonalizationsmarteditTriggerService.prototype.buildExpressionFromTrigger=function(t){var e,i=this;if(this.isGroupExpressionData(t))(e=this.buildContainer(t.operator)).nodes=t.elements.map(function(t){return i.buildExpressionFromTrigger(t)});else if(this.isNegationExpressionData(t)){e=this.buildContainer("NOT");var n=this.buildExpressionFromTrigger(t.element);this.isGroupExpressionData(t.element)&&"AND"===t.element.operator?e.nodes=n.nodes:e.nodes.push(n)}else this.isSegmentExpressionData(t)&&(e=this.buildItem(t.code));return e},PersonalizationsmarteditTriggerService.prototype.buildSegmentTriggerData=function(t){var e=this,i=this.buildContainer(t.groupBy);return t.segments.forEach(function(t){i.nodes.push(e.buildItem(t.code))}),[i]},PersonalizationsmarteditTriggerService.prototype.buildExpressionTriggerData=function(t){return[this.buildExpressionFromTrigger(t.expression)]},PersonalizationsmarteditTriggerService=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditTriggerService)}(),d=function(){return function Personalization(){this.enabled=!1}}(),m=function(){return function Customize(){this.enabled=!1,this.selectedCustomization=null,this.selectedVariations=null,this.selectedComponents=null}}(),p=function(){return function CombinedView(){this.enabled=!1,this.selectedItems=null,this.customize=new m}}(),u=function(){return function SeData(){this.pageId=null,this.seExperienceData=null,this.seConfigurationData=null}}(),g=function(){function PersonalizationsmarteditContextUtils(){}return PersonalizationsmarteditContextUtils.prototype.getContextObject=function(){return{personalization:new d,customize:new m,combinedView:new p,seData:new u}},PersonalizationsmarteditContextUtils.prototype.clearCustomizeContext=function(t){var e=t.getCustomize();e.enabled=!1,e.selectedCustomization=null,e.selectedVariations=null,e.selectedComponents=null,t.setCustomize(e)},PersonalizationsmarteditContextUtils.prototype.clearCustomizeContextAndReloadPreview=function(t,e){var i=a.copy(e.getCustomize().selectedVariations);this.clearCustomizeContext(e),a.isObject(i)&&!a.isArray(i)&&t.removePersonalizationDataFromPreview()},PersonalizationsmarteditContextUtils.prototype.clearCombinedViewCustomizeContext=function(t){var e=t.getCombinedView();e.customize.enabled=!1,e.customize.selectedCustomization=null,e.customize.selectedVariations=null,e.customize.selectedComponents=null,(e.selectedItems||[]).forEach(function(t){delete t.highlighted}),t.setCombinedView(e)},PersonalizationsmarteditContextUtils.prototype.clearCombinedViewContext=function(t){var e=t.getCombinedView();e.enabled=!1,e.selectedItems=null,t.setCombinedView(e)},PersonalizationsmarteditContextUtils.prototype.clearCombinedViewContextAndReloadPreview=function(t,e){var i=a.copy(e.getCombinedView().enabled),n=a.copy(e.getCombinedView().selectedItems);this.clearCombinedViewContext(e),i&&n&&t.removePersonalizationDataFromPreview()},PersonalizationsmarteditContextUtils=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditContextUtils)}(),h=i(3),C={provide:"PERSONALIZATION_DATE_FORMATS",useValue:{SHORT_DATE_FORMAT:"M/D/YY",MODEL_DATE_FORMAT:"YYYY-MM-DDTHH:mm:SSZ"}},z=function(){function PersonalizationsmarteditDateUtils(t,e,i,n){this.$translate=t,this.DATE_CONSTANTS=e,this.PERSONALIZATION_DATE_FORMATS=i,this.isBlank=n}return PersonalizationsmarteditDateUtils.$inject=["$translate","DATE_CONSTANTS","PERSONALIZATION_DATE_FORMATS","isBlank"],PersonalizationsmarteditDateUtils.prototype.formatDate=function(t,e){return e=e||this.DATE_CONSTANTS.MOMENT_FORMAT,t?(t.match&&t.match(/^(\d{4})\-(\d{2})\-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\+|\-)(\d{4})$/)&&(t=t.slice(0,-2)+":"+t.slice(-2)),h(new Date(t)).format(e)):""},PersonalizationsmarteditDateUtils.prototype.formatDateWithMessage=function(t,e){return e=e||this.PERSONALIZATION_DATE_FORMATS.SHORT_DATE_FORMAT,t?this.formatDate(t,e):this.$translate.instant("personalization.toolbar.pagecustomizations.nodatespecified")},PersonalizationsmarteditDateUtils.prototype.isDateInThePast=function(t){return!this.isBlank(t)&&h(t,this.DATE_CONSTANTS.MOMENT_FORMAT).isBefore()},PersonalizationsmarteditDateUtils.prototype.isDateValidOrEmpty=function(t){return this.isBlank(t)||this.isDateValid(t)},PersonalizationsmarteditDateUtils.prototype.isDateValid=function(t){return h(t,this.DATE_CONSTANTS.MOMENT_FORMAT).isValid()},PersonalizationsmarteditDateUtils.prototype.isDateRangeValid=function(t,e){return!(!this.isBlank(t)&&!this.isBlank(e))||h(new Date(t)).isSameOrBefore(h(new Date(e)))},PersonalizationsmarteditDateUtils.prototype.isDateStrFormatValid=function(t,e){return e=e||this.DATE_CONSTANTS.MOMENT_FORMAT,!this.isBlank(t)&&h(t,e,!0).isValid()},PersonalizationsmarteditDateUtils=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditDateUtils)}(),v={provide:"PERSONALIZATION_MODEL_STATUS_CODES",useValue:{ENABLED:"ENABLED",DISABLED:"DISABLED"}},f={provide:"PERSONALIZATION_VIEW_STATUS_MAPPING_CODES",useValue:{ALL:"ALL",ENABLED:"ENABLED",DISABLED:"DISABLED"}},S={provide:"PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING",useValue:{0:{borderClass:"personalizationsmarteditComponentSelected0",listClass:"personalizationsmarteditComponentSelectedList0"},1:{borderClass:"personalizationsmarteditComponentSelected1",listClass:"personalizationsmarteditComponentSelectedList1"},2:{borderClass:"personalizationsmarteditComponentSelected2",listClass:"personalizationsmarteditComponentSelectedList2"},3:{borderClass:"personalizationsmarteditComponentSelected3",listClass:"personalizationsmarteditComponentSelectedList3"},4:{borderClass:"personalizationsmarteditComponentSelected4",listClass:"personalizationsmarteditComponentSelectedList4"},5:{borderClass:"personalizationsmarteditComponentSelected5",listClass:"personalizationsmarteditComponentSelectedList5"},6:{borderClass:"personalizationsmarteditComponentSelected6",listClass:"personalizationsmarteditComponentSelectedList6"},7:{borderClass:"personalizationsmarteditComponentSelected7",listClass:"personalizationsmarteditComponentSelectedList7"},8:{borderClass:"personalizationsmarteditComponentSelected8",listClass:"personalizationsmarteditComponentSelectedList8"},9:{borderClass:"personalizationsmarteditComponentSelected9",listClass:"personalizationsmarteditComponentSelectedList9"},10:{borderClass:"personalizationsmarteditComponentSelected10",listClass:"personalizationsmarteditComponentSelectedList10"},11:{borderClass:"personalizationsmarteditComponentSelected11",listClass:"personalizationsmarteditComponentSelectedList11"},12:{borderClass:"personalizationsmarteditComponentSelected12",listClass:"personalizationsmarteditComponentSelectedList12"},13:{borderClass:"personalizationsmarteditComponentSelected13",listClass:"personalizationsmarteditComponentSelectedList13"},14:{borderClass:"personalizationsmarteditComponentSelected14",listClass:"personalizationsmarteditComponentSelectedList14"}}},_={provide:"COMBINED_VIEW_TOOLBAR_ITEM_KEY",useValue:"personalizationsmartedit.container.combinedview.toolbar"},T={provide:"CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY",useValue:"personalizationsmartedit.container.pagecustomizations.toolbar"},b=function(){function PersonalizationsmarteditUtils(t,e,i,n,a,o,s){this.$q=t,this.$filter=e,this.l10nFilter=i,this.PERSONALIZATION_MODEL_STATUS_CODES=n,this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES=a,this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING=o,this.catalogService=s}return PersonalizationsmarteditUtils.$inject=["$q","$filter","l10nFilter","PERSONALIZATION_MODEL_STATUS_CODES","PERSONALIZATION_VIEW_STATUS_MAPPING_CODES","PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING","catalogService"],PersonalizationsmarteditUtils.prototype.pushToArrayIfValueExists=function(t,e,i){i&&t.push({key:e,value:i})},PersonalizationsmarteditUtils.prototype.getVariationCodes=function(t){return void 0===typeof t||null===t?[]:t.map(function(t){return t.code}).filter(function(t){return void 0!==t})},PersonalizationsmarteditUtils.prototype.getVariationKey=function(t,e){return void 0===t||void 0===e?[]:e.map(function(e){return{variationCode:e.code,customizationCode:t,catalog:e.catalog,catalogVersion:e.catalogVersion}})},PersonalizationsmarteditUtils.prototype.getSegmentTriggerForVariation=function(t){var e=(t.triggers||[]).filter(function(t){return"segmentTriggerData"===t.type});return 0===e.length?{}:e[0]},PersonalizationsmarteditUtils.prototype.isPersonalizationItemEnabled=function(t){return t.status===this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED},PersonalizationsmarteditUtils.prototype.getTranslateFilter=function(){return this.$filter("translate")},PersonalizationsmarteditUtils.prototype.getEnablementTextForCustomization=function(t,e){return e=e||"personalization",this.isPersonalizationItemEnabled(t)?this.getTranslateFilter()(e+".customization.enabled"):this.getTranslateFilter()(e+".customization.disabled")},PersonalizationsmarteditUtils.prototype.getEnablementTextForVariation=function(t,e){return e=e||"personalization",this.isPersonalizationItemEnabled(t)?this.getTranslateFilter()(e+".variation.enabled"):this.getTranslateFilter()(e+".variation.disabled")},PersonalizationsmarteditUtils.prototype.getEnablementActionTextForVariation=function(t,e){return e=e||"personalization",this.isPersonalizationItemEnabled(t)?this.getTranslateFilter()(e+".variation.options.disable"):this.getTranslateFilter()(e+".variation.options.enable")},PersonalizationsmarteditUtils.prototype.getActivityStateForCustomization=function(t){return t.status===this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED?h().isBetween(new Date(t.enabledStartDate),new Date(t.enabledEndDate),"minute","[]")?"perso__status--enabled":"perso__status--ignore":"perso__status--disabled"},PersonalizationsmarteditUtils.prototype.getActivityStateForVariation=function(t,e){return e.enabled?this.getActivityStateForCustomization(t):"perso__status--disabled"},PersonalizationsmarteditUtils.prototype.isItemVisible=function(t){return"DELETED"!==t.status},PersonalizationsmarteditUtils.prototype.getVisibleItems=function(t){var e=this;return t.filter(function(t){return e.isItemVisible(t)})},PersonalizationsmarteditUtils.prototype.getValidRank=function(t,e,i){for(var n=t.indexOf(e),a=i<0?-1:1,o=n+i;o>=0&&o<t.length&&!this.isItemVisible(t[o]);)o+=a;return t[o=(o=o>=t.length?t.length-1:o)<0?0:o].rank},PersonalizationsmarteditUtils.prototype.getStatusesMapping=function(){var t=[];return t.push({code:this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.ALL,text:"personalization.context.status.all",modelStatuses:[this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]}),t.push({code:this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.ENABLED,text:"personalization.context.status.enabled",modelStatuses:[this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED]}),t.push({code:this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.DISABLED,text:"personalization.context.status.disabled",modelStatuses:[this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]}),t},PersonalizationsmarteditUtils.prototype.getClassForElement=function(t){var e=t%Object.keys(this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).length;return this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING[e].listClass},PersonalizationsmarteditUtils.prototype.getLetterForElement=function(t){var e=t%Object.keys(this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).length;return String.fromCharCode("a".charCodeAt(0)+e).toUpperCase()},PersonalizationsmarteditUtils.prototype.getCommerceCustomizationTooltip=function(t,e,i){var n=this;e=e||"",i=i||"\n";var o="";return a.forEach(t.commerceCustomizations,function(t,a){o+=e+n.$filter("translate")("personalization.modal.manager.commercecustomization."+a)+": "+t+i}),o},PersonalizationsmarteditUtils.prototype.getCommerceCustomizationTooltipHTML=function(t){return this.getCommerceCustomizationTooltip(t,"<div>","</div>")},PersonalizationsmarteditUtils.prototype.isItemFromCurrentCatalog=function(t,e){var i=e.seExperienceData.catalogDescriptor;return t.catalog===i.catalogId&&t.catalogVersion===i.catalogVersion},PersonalizationsmarteditUtils.prototype.hasCommerceActions=function(t){return t.numberOfCommerceActions>0},PersonalizationsmarteditUtils.prototype.getCatalogVersionNameByUuid=function(t){var e=this,i=this.$q.defer();return this.catalogService.getCatalogVersionByUuid(t).then(function(t){i.resolve(e.l10nFilter(t.catalogName)+" ("+t.version+")")}),i.promise},PersonalizationsmarteditUtils.prototype.getAndSetCatalogVersionNameL10N=function(t){this.getCatalogVersionNameByUuid(t.catalog+"/"+t.catalogVersion).then(function(e){t.catalogVersionNameL10N=e})},PersonalizationsmarteditUtils=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditUtils)}();window.__smartedit__.addDecoratorPayload("SeComponent","DateTimePickerRangeComponent",{templateUrl:"dateTimePickerRangeTemplate.html",inputs:["name: =","dateFrom: =","dateTo: =","isEditable: =","dateFormat: ="]});var A=function(){function DateTimePickerRangeComponent(t,e,i,n,a){this.DATE_CONSTANTS=t,this.personalizationsmarteditDateUtils=e,this.$element=i,this.$scope=n,this.languageService=a,this.placeholderText="personalization.commons.datetimepicker.placeholder",this.isFromDateValid=!1,this.isToDateValid=!1,this.isEndDateInThePast=!1}return DateTimePickerRangeComponent.$inject=["DATE_CONSTANTS","personalizationsmarteditDateUtils","$element","$scope","languageService"],DateTimePickerRangeComponent.prototype.$onInit=function(){this.actionsIfisEditable()},DateTimePickerRangeComponent.prototype.getDateOrDefault=function(t){try{return h(new Date(t))}catch(t){return!1}},DateTimePickerRangeComponent.prototype.actionsIfisEditable=function(){var t=this;this.isEditable&&(this.getFromPickerNode().datetimepicker({format:this.DATE_CONSTANTS.MOMENT_FORMAT,showClear:!0,showClose:!0,useCurrent:!1,widgetPositioning:{horizontal:"right",vertical:"bottom"},locale:this.languageService.getBrowserLocale().split("-")[0]}).on("dp.update dp.hide dp.change",function(t){var e=this.personalizationsmarteditDateUtils.formatDate(t.date,void 0);this.personalizationsmarteditDateUtils.isDateValidOrEmpty(e)&&this.personalizationsmarteditDateUtils.isDateValidOrEmpty(this.dateTo)&&!this.personalizationsmarteditDateUtils.isDateRangeValid(e,this.dateTo)&&(e=a.copy(this.dateTo)),this.dateFrom=e}.bind(this)),this.getToPickerNode().datetimepicker({format:this.DATE_CONSTANTS.MOMENT_FORMAT,showClear:!0,showClose:!0,useCurrent:!1,widgetPositioning:{horizontal:"right",vertical:"bottom"},locale:this.languageService.getBrowserLocale().split("-")[0]}).on("dp.change dp.hide dp.change",function(t){var e=this.personalizationsmarteditDateUtils.formatDate(t.date,void 0);this.personalizationsmarteditDateUtils.isDateValidOrEmpty(e)&&this.personalizationsmarteditDateUtils.isDateValidOrEmpty(this.dateFrom)&&!this.personalizationsmarteditDateUtils.isDateRangeValid(this.dateFrom,e)&&(e=a.copy(this.dateFrom)),this.dateTo=e}.bind(this)),this.$scope.$watch("this.$ctrl.dateFrom",function(){t.isFromDateValid=t.personalizationsmarteditDateUtils.isDateValidOrEmpty(t.dateFrom),t.personalizationsmarteditDateUtils.isDateStrFormatValid(t.dateFrom,t.DATE_CONSTANTS.MOMENT_FORMAT)?t.getToDatetimepicker().minDate(t.getMinToDate(t.dateFrom)):t.getToDatetimepicker().minDate(h())},!0),this.$scope.$watch("this.$ctrl.dateTo",function(){t.personalizationsmarteditDateUtils.isDateValidOrEmpty(t.dateTo)?(t.isToDateValid=!0,t.isEndDateInThePast=t.personalizationsmarteditDateUtils.isDateInThePast(t.dateTo)):(t.isToDateValid=!1,t.isEndDateInThePast=!1),t.personalizationsmarteditDateUtils.isDateStrFormatValid(t.dateTo,t.DATE_CONSTANTS.MOMENT_FORMAT)?t.getFromDatetimepicker().maxDate(t.getDateOrDefault(t.dateTo)):""===t.dateTo&&t.getFromDatetimepicker().maxDate(!1)},!0))},DateTimePickerRangeComponent.prototype.getMinToDate=function(t){return this.personalizationsmarteditDateUtils.isDateInThePast(t)?h():this.getDateOrDefault(t)},DateTimePickerRangeComponent.prototype.getFromPickerNode=function(){return this.$element.querySelectorAll("#date-picker-range-from")},DateTimePickerRangeComponent.prototype.getFromDatetimepicker=function(){return this.getFromPickerNode().datetimepicker().data("DateTimePicker")},DateTimePickerRangeComponent.prototype.getToPickerNode=function(){return this.$element.querySelectorAll("#date-picker-range-to")},DateTimePickerRangeComponent.prototype.getToDatetimepicker=function(){return this.getToPickerNode().datetimepicker().data("DateTimePicker")},DateTimePickerRangeComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"dateTimePickerRangeTemplate.html",inputs:["name: =","dateFrom: =","dateTo: =","isEditable: =","dateFormat: ="]})],DateTimePickerRangeComponent)}();window.__smartedit__.addDecoratorPayload("SeDirective","IsDateValidOrEmptyDirective",{require:"ngModel",selector:"[isdatevalidorempty]"});var E=function(){function IsDateValidOrEmptyDirective(t){this.personalizationsmarteditDateUtils=t}return IsDateValidOrEmptyDirective.$inject=["personalizationsmarteditDateUtils"],IsDateValidOrEmptyDirective.prototype.isDateInThePast=function(t){return this.personalizationsmarteditDateUtils.isDateValidOrEmpty(t)},IsDateValidOrEmptyDirective=n.__decorate([Object(o.SeDirective)({require:"ngModel",selector:"[isdatevalidorempty]"})],IsDateValidOrEmptyDirective)}(),O=function(){function PaginationHelper(t){void 0===t&&(t={}),this.count=t.count||0,this.page=t.page||0,this.totalCount=t.totalCount||0,this.totalPages=t.totalPages||0}return PaginationHelper.$inject=["initialData"],PaginationHelper.prototype.reset=function(){this.count=50,this.page=-1,this.totalPages=1,this.totalCount=0},PaginationHelper.prototype.getCount=function(){return this.count},PaginationHelper.prototype.getPage=function(){return this.page},PaginationHelper.prototype.getTotalCount=function(){return this.totalCount},PaginationHelper.prototype.getTotalPages=function(){return this.totalPages},PaginationHelper=n.__decorate([Object(o.SeInjectable)()],PaginationHelper)}(),I=function(){function PersonalizationsmarteditMessageHandler(t){this.alertService=t}return PersonalizationsmarteditMessageHandler.$inject=["alertService"],PersonalizationsmarteditMessageHandler.prototype.sendInformation=function(t){this.alertService.showInfo(t)},PersonalizationsmarteditMessageHandler.prototype.sendError=function(t){this.alertService.showDanger(t)},PersonalizationsmarteditMessageHandler.prototype.sendWarning=function(t){this.alertService.showWarning(t)},PersonalizationsmarteditMessageHandler.prototype.sendSuccess=function(t){this.alertService.showSuccess(t)},PersonalizationsmarteditMessageHandler=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditMessageHandler)}(),y=function(){function PersonalizationsmarteditCommerceCustomizationService(){this.nonCommerceActionTypes=["cxCmsActionData"],this.types=[]}return PersonalizationsmarteditCommerceCustomizationService.prototype.isNonCommerceAction=function(t){return this.nonCommerceActionTypes.some(function(e){return e===t.type})},PersonalizationsmarteditCommerceCustomizationService.prototype.isCommerceAction=function(t){return!this.isNonCommerceAction(t)},PersonalizationsmarteditCommerceCustomizationService.prototype.isTypeEnabled=function(t,e){return void 0!==e&&null!==e&&!0===e[t.confProperty]},PersonalizationsmarteditCommerceCustomizationService.prototype.registerType=function(t){var e=t.type,i=!1;this.types.forEach(function(t){t.type===e&&(i=!0)}),i||this.types.push(t)},PersonalizationsmarteditCommerceCustomizationService.prototype.getAvailableTypes=function(t){var e=this;return this.types.filter(function(i){return e.isTypeEnabled(i,t)})},PersonalizationsmarteditCommerceCustomizationService.prototype.isCommerceCustomizationEnabled=function(t){return this.getAvailableTypes(t).length>0},PersonalizationsmarteditCommerceCustomizationService.prototype.getNonCommerceActionsCount=function(t){return(t.actions||[]).filter(this.isNonCommerceAction,this).length},PersonalizationsmarteditCommerceCustomizationService.prototype.getCommerceActionsCountMap=function(t){var e={};return(t.actions||[]).filter(this.isCommerceAction,this).forEach(function(t){var i=t.type.toLowerCase(),n=e[i];void 0===n?n=1:n+=1,e[i]=n}),e},PersonalizationsmarteditCommerceCustomizationService.prototype.getCommerceActionsCount=function(t){return(t.actions||[]).filter(this.isCommerceAction,this).length},PersonalizationsmarteditCommerceCustomizationService=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditCommerceCustomizationService)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditScrollZoneComponent",{inputs:["scrollZoneVisible","getElementToScroll: &","isTransparent","scrollZoneId"]});var P=function(){function PersonalizationsmarteditScrollZoneComponent(t,e,i,n){this.$scope=t,this.$timeout=e,this.$compile=i,this.yjQuery=n,this.scrollZoneTop=!0,this.scrollZoneBottom=!0,this.start=!1,this.scrollZoneVisible=!1,this.isTransparent=!1,this.elementToScroll={},this.scrollZoneId=""}return PersonalizationsmarteditScrollZoneComponent.$inject=["$scope","$timeout","$compile","yjQuery"],PersonalizationsmarteditScrollZoneComponent.prototype.stopScroll=function(){this.start=!1},PersonalizationsmarteditScrollZoneComponent.prototype.scrollTop=function(){var t=this;this.start&&(this.scrollZoneTop=!(this.elementToScroll.scrollTop()<=2),this.scrollZoneBottom=!0,this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()-15),this.$timeout(function(){t.scrollTop()},100))},PersonalizationsmarteditScrollZoneComponent.prototype.scrollBottom=function(){var t=this;if(this.start){this.scrollZoneTop=!0;var e=this.elementToScroll.get(0).scrollHeight-this.elementToScroll.scrollTop();this.scrollZoneBottom=!(Math.abs(e-this.elementToScroll.outerHeight())<2),this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()+15),this.$timeout(function(){t.scrollBottom()},100)}},PersonalizationsmarteditScrollZoneComponent.prototype.$onChanges=function(t){t.scrollZoneVisible&&(this.start=t.scrollZoneVisible.currentValue,this.scrollZoneTop=!0,this.scrollZoneBottom=!0)},PersonalizationsmarteditScrollZoneComponent.prototype.$onInit=function(){var t=this.$compile('<div id="sliderTopScrollZone'+this.scrollZoneId+'" data-ng-include="\'personalizationsmarteditScrollZoneTopTemplate.html\'"></div>')(this.$scope);a.element("body").append(t);var e=this.$compile('<div id="sliderBottomScrollZone'+this.scrollZoneId+'" data-ng-include="\'personalizationsmarteditScrollZoneBottomTemplate.html\'"></div>')(this.$scope);a.element("body").append(e),this.elementToScroll=this.getElementToScroll()},PersonalizationsmarteditScrollZoneComponent.prototype.$onDestroy=function(){var t=this;a.element("#sliderTopScrollZone"+this.scrollZoneId).scope().$destroy(),a.element("#sliderTopScrollZone"+this.scrollZoneId).remove(),a.element("#sliderBottomScrollZone"+this.scrollZoneId).scope().$destroy(),a.element("#sliderBottomScrollZone"+this.scrollZoneId).remove(),a.element("body").contents().each(function(e){e.nodeType===Node.COMMENT_NODE&&e.data.indexOf("personalizationsmarteditScrollZone")>-1&&t.yjQuery(e).remove()})},PersonalizationsmarteditScrollZoneComponent=n.__decorate([Object(o.SeComponent)({inputs:["scrollZoneVisible","getElementToScroll: &","isTransparent","scrollZoneId"]})],PersonalizationsmarteditScrollZoneComponent)}();window.__smartedit__.addDecoratorPayload("SeDirective","PersonalizationCurrentElementDirective",{selector:"[personalization-current-element]"});var w=function(){function PersonalizationCurrentElementDirective(t,e,i){this.$scope=t,this.$element=e,this.$attrs=i}return PersonalizationCurrentElementDirective.$inject=["$scope","$element","$attrs"],PersonalizationCurrentElementDirective.prototype.$postLink=function(){this.$attrs.personalizationCurrentElement&&this.$scope.$parent.$eval(this.$attrs.personalizationCurrentElement)(this.$element.parent())},PersonalizationCurrentElementDirective=n.__decorate([Object(o.SeDirective)({selector:"[personalization-current-element]"})],PersonalizationCurrentElementDirective)}();window.__smartedit__.addDecoratorPayload("SeDirective","PersonalizationPreventParentScrollDirective",{selector:"[personalization-prevent-parent-scroll]"});var M=function(){function PersonalizationPreventParentScrollDirective(t,e){this.$scope=t,this.$element=e}return PersonalizationPreventParentScrollDirective.$inject=["$scope","$element"],PersonalizationPreventParentScrollDirective.prototype.$postLink=function(){var t=this,e=function(e){var i=e.originalEvent&&(e.originalEvent.wheelDeltaY||e.originalEvent.wheelDelta),n=-(e.deltaY||e.delta)||0;t.$element.parent()[0].scrollTop-=e.wheelDeltaY||i||e.wheelDelta||n,e.stopPropagation(),e.preventDefault(),e.returnValue=!1};this.$element.parent()[0].addEventListener("wheel",e,!1),this.$scope.$parent.$on("$destroy",function(){t.$element.parent()[0].removeEventListener("wheel",e,!1)})},PersonalizationPreventParentScrollDirective=n.__decorate([Object(o.SeDirective)({selector:"[personalization-prevent-parent-scroll]"})],PersonalizationPreventParentScrollDirective)}();window.__smartedit__.addDecoratorPayload("SeDirective","PersonalizationInfiniteScrollDirective",{selector:"[personalization-infinite-scroll]"});var D=function(){function PersonalizationInfiniteScrollDirective(t,e,i,n,a,o,s){this.$scope=t,this.$element=e,this.$attrs=i,this.$rootScope=n,this.yjQuery=a,this.$window=o,this.$timeout=s}return PersonalizationInfiniteScrollDirective.$inject=["$scope","$element","$attrs","$rootScope","yjQuery","$window","$timeout"],PersonalizationInfiniteScrollDirective.prototype.$postLink=function(){var t,e,i,n,o=this;return this.$window=a.element(this.$window),i=0,null!==this.$attrs.personalizationInfiniteScrollDistance&&this.$scope.$parent.$watch(this.$attrs.personalizationInfiniteScrollDistance,function(t){return i=parseInt(t,10)}),n=!0,t=!1,null!==this.$attrs.personalizationInfiniteScrollDisabled&&this.$scope.$parent.$watch(this.$attrs.personalizationInfiniteScrollDisabled,function(i){if((n=!i)&&t)return t=!1,e()}),this.$rootScope.$on("refreshStart",function(){o.$element.animate({scrollTop:"0"})}),e=function(){var e,a,s;if(!(o.$element.children().length<=0))return e=o.yjQuery(o.$element.children()[0]),a=o.$element.offset().top+o.$element.height(),(s=e.offset().top+e.height()-a<=o.$element.height()*i)&&n?o.$rootScope.$$phase?o.$scope.$parent.$eval(o.$attrs.personalizationInfiniteScroll):o.$scope.$parent.$apply(o.$attrs.personalizationInfiniteScroll):s?t=!0:void 0},this.$element.on("scroll",e),this.$scope.$parent.$on("$destroy",function(){return o.$window.off("scroll",e)}),this.$timeout(function(){return o.$attrs.personalizationInfiniteScrollImmediateCheck?o.$scope.$parent.$eval(o.$attrs.personalizationInfiniteScrollImmediateCheck)?e():void 0:e()},0)},PersonalizationInfiniteScrollDirective=n.__decorate([Object(o.SeDirective)({selector:"[personalization-infinite-scroll]"})],PersonalizationInfiniteScrollDirective)}(),V=function(){function PersonalizationsmarteditCommonsModule(){}return PersonalizationsmarteditCommonsModule=n.__decorate([Object(o.SeModule)({imports:["personalizationcommonsTemplates","smarteditServicesModule","yjqueryModule","l10nModule","alertServiceModule"],providers:[O,{provide:"PaginationHelper",useFactory:function(){return function(t){return new O(t)}}},z,g,C,v,f,S,_,T,b,I,y],declarations:[E,w,D,M,A,P]})],PersonalizationsmarteditCommonsModule)}(),N=function(){function CustomizationDataFactory(t){this.personalizationsmarteditRestService=t,this.items=[],this.defaultFilter={},this.defaultDataArrayName="customizations"}return CustomizationDataFactory.$inject=["personalizationsmarteditRestService"],CustomizationDataFactory.prototype.getCustomizations=function(t){var e=this;this.personalizationsmarteditRestService.getCustomizations(t).then(function(t){Array.prototype.push.apply(e.items,t[e.defaultDataArrayName]),e.defaultSuccessCallbackFunction(t)},function(t){e.defaultErrorCallbackFunction(t)})},CustomizationDataFactory.prototype.updateData=function(t,e,i){t=t||{},this.defaultFilter=t.filter||this.defaultFilter,this.defaultDataArrayName=t.dataArrayName||this.defaultDataArrayName,e&&"function"==typeof e&&(this.defaultSuccessCallbackFunction=e),i&&"function"==typeof i&&(this.defaultErrorCallbackFunction=i),this.getCustomizations(this.defaultFilter)},CustomizationDataFactory.prototype.refreshData=function(){if(!a.equals({},this.defaultFilter)){var t={};a.copy(this.defaultFilter,t),t.currentSize=this.items.length,t.currentPage=0,this.resetData(),this.getCustomizations(t)}},CustomizationDataFactory.prototype.resetData=function(){this.items.length=0},CustomizationDataFactory.prototype.pushData=function(t){a.isObject(t)&&(a.isArray(t)?Array.prototype.push.apply(this.items,t):this.items.push(t))},CustomizationDataFactory=n.__decorate([Object(o.SeInjectable)()],CustomizationDataFactory)}(),x=function(){function PersonalizationsmarteditContextService(t,e,i,n,a){this.$q=t,this.sharedDataService=e,this.loadConfigManagerService=i,this.personalizationsmarteditContextServiceProxy=n,this.personalizationsmarteditContextUtils=a;var o=a.getContextObject();this.setPersonalization(o.personalization),this.setCustomize(o.customize),this.setCombinedView(o.combinedView),this.setSeData(o.seData),this.customizeFiltersState={}}return PersonalizationsmarteditContextService.$inject=["$q","sharedDataService","loadConfigManagerService","personalizationsmarteditContextServiceProxy","personalizationsmarteditContextUtils"],PersonalizationsmarteditContextService.prototype.getPersonalization=function(){return this.personalization},PersonalizationsmarteditContextService.prototype.setPersonalization=function(t){this.personalization=t,this.personalizationsmarteditContextServiceProxy.setPersonalization(t)},PersonalizationsmarteditContextService.prototype.getCustomize=function(){return this.customize},PersonalizationsmarteditContextService.prototype.setCustomize=function(t){this.customize=t,this.personalizationsmarteditContextServiceProxy.setCustomize(t)},PersonalizationsmarteditContextService.prototype.getCombinedView=function(){return this.combinedView},PersonalizationsmarteditContextService.prototype.setCombinedView=function(t){this.combinedView=t,this.personalizationsmarteditContextServiceProxy.setCombinedView(t)},PersonalizationsmarteditContextService.prototype.getSeData=function(){return this.seData},PersonalizationsmarteditContextService.prototype.setSeData=function(t){this.seData=t,this.personalizationsmarteditContextServiceProxy.setSeData(t)},PersonalizationsmarteditContextService.prototype.refreshExperienceData=function(){var t=this;return this.sharedDataService.get("experience").then(function(e){var i=t.getSeData();return i.seExperienceData=e,i.pageId=e.pageId,t.setSeData(i),t.$q.when()})},PersonalizationsmarteditContextService.prototype.refreshConfigurationData=function(){var t=this;this.loadConfigManagerService.loadAsObject().then(function(e){var i=t.getSeData();i.seConfigurationData=e,t.setSeData(i)})},PersonalizationsmarteditContextService.prototype.applySynchronization=function(){this.personalizationsmarteditContextServiceProxy.setPersonalization(this.personalization),this.personalizationsmarteditContextServiceProxy.setCustomize(this.customize),this.personalizationsmarteditContextServiceProxy.setCombinedView(this.combinedView),this.personalizationsmarteditContextServiceProxy.setSeData(this.seData),this.refreshExperienceData(),this.refreshConfigurationData()},PersonalizationsmarteditContextService.prototype.getContexServiceProxy=function(){return this.personalizationsmarteditContextServiceProxy},PersonalizationsmarteditContextService.prototype.getCustomizeFiltersState=function(){return this.customizeFiltersState},PersonalizationsmarteditContextService.prototype.setCustomizeFiltersState=function(t){this.customizeFiltersState=t},PersonalizationsmarteditContextService=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditContextService)}(),$=function(){function PersonalizationsmarteditContextServiceProxy(){}return PersonalizationsmarteditContextServiceProxy.prototype.setPersonalization=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy.prototype.setCustomize=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy.prototype.setCombinedView=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy.prototype.setSeData=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy=n.__decorate([Object(o.GatewayProxied)("setPersonalization","setCustomize","setCombinedView","setSeData"),Object(o.SeInjectable)()],PersonalizationsmarteditContextServiceProxy)}(),R=function(){function PersonalizationsmarteditContextServiceReverseProxy(t,e,i){this.personalizationsmarteditContextService=t,this.workflowService=e,this.pageService=i}var t;return PersonalizationsmarteditContextServiceReverseProxy.$inject=["personalizationsmarteditContextService","workflowService","pageService"],t=PersonalizationsmarteditContextServiceReverseProxy,PersonalizationsmarteditContextServiceReverseProxy.prototype.applySynchronization=function(){this.personalizationsmarteditContextService.applySynchronization()},PersonalizationsmarteditContextServiceReverseProxy.prototype.isCurrentPageActiveWorkflowRunning=function(){var e=this;return this.pageService.getCurrentPageInfo().then(function(i){return e.workflowService.getActiveWorkflowForPageUuid(i.uuid).then(function(e){return null!=e&&e.status===t.WORKFLOW_RUNNING_STATUS})})},PersonalizationsmarteditContextServiceReverseProxy.WORKFLOW_RUNNING_STATUS="RUNNING",PersonalizationsmarteditContextServiceReverseProxy=t=n.__decorate([Object(o.GatewayProxied)("applySynchronization","isCurrentPageActiveWorkflowRunning"),Object(o.SeInjectable)()],PersonalizationsmarteditContextServiceReverseProxy)}(),F=function(){function PersonalizationsmarteditRestService(t,e,i,n,a,o){this.restServiceFactory=t,this.personalizationsmarteditUtils=e,this.$http=i,this.$q=n,this.yjQuery=a,this.personalizationsmarteditContextService=o}var t;return PersonalizationsmarteditRestService.$inject=["restServiceFactory","personalizationsmarteditUtils","$http","$q","yjQuery","personalizationsmarteditContextService"],t=PersonalizationsmarteditRestService,PersonalizationsmarteditRestService.prototype.extendRequestParamObjWithCatalogAwarePathVariables=function(t,e){e=e||{};var i=this.personalizationsmarteditContextService.getSeData().seExperienceData,n={catalogId:e.catalog||i.catalogDescriptor.catalogId,catalogVersion:e.catalogVersion||i.catalogDescriptor.catalogVersion};return t=a.extend(t,n)},PersonalizationsmarteditRestService.prototype.extendRequestParamObjWithCustomizatonCode=function(t,e){var i={customizationCode:e};return t=a.extend(t,i)},PersonalizationsmarteditRestService.prototype.extendRequestParamObjWithVariationCode=function(t,e){var i={variationCode:e};return t=a.extend(t,i)},PersonalizationsmarteditRestService.prototype.getParamsAction=function(t,e,i,n,a,o){var s=[];return this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"oldComponentId",t),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"newComponentId",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"slotId",i),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"containerId",n),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"variationId",o),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"customizationId",a),{params:{entry:s}}},PersonalizationsmarteditRestService.prototype.getPathVariablesObjForModifyingActionURI=function(t,e,i,n){var a=this.personalizationsmarteditContextService.getSeData().seExperienceData;return{customizationCode:t,variationCode:e,actionId:i,catalogId:(n=n||{}).catalog||a.catalogDescriptor.catalogId,catalogVersion:n.catalogVersion||a.catalogDescriptor.catalogVersion}},PersonalizationsmarteditRestService.prototype.prepareURI=function(t,e){return t.replace(/((?:\:)(\w*)(?:\/))/g,function(t,i,n){return e[n]+"/"})},PersonalizationsmarteditRestService.prototype.getParamsForCustomizations=function(t){return{code:a.isDefined(t.code)?t.code:void 0,pageId:a.isDefined(t.pageId)?t.pageId:void 0,pageCatalogId:a.isDefined(t.pageCatalogId)?t.pageCatalogId:void 0,name:a.isDefined(t.name)?t.name:void 0,negatePageId:a.isDefined(t.negatePageId)?t.negatePageId:void 0,catalogs:a.isDefined(t.catalogs)?t.catalogs:void 0,statuses:a.isDefined(t.statuses)?t.statuses.join(","):void 0}},PersonalizationsmarteditRestService.prototype.getActionsDetails=function(e){var i=this.restServiceFactory.get(t.ACTIONS_DETAILS);return e=this.extendRequestParamObjWithCatalogAwarePathVariables(e),i.get(e)},PersonalizationsmarteditRestService.prototype.getCustomizations=function(e){e=e||{};var i={},n=this.restServiceFactory.get(t.CUSTOMIZATIONS);return(i=this.extendRequestParamObjWithCatalogAwarePathVariables(i,e)).pageSize=e.currentSize||10,i.currentPage=e.currentPage||0,this.yjQuery.extend(i,this.getParamsForCustomizations(e)),n.get(i)},PersonalizationsmarteditRestService.prototype.getComponenentsIdsForVariation=function(e,i,n,a){var o=this.personalizationsmarteditContextService.getSeData().seExperienceData,s=this.restServiceFactory.get(t.CXCMSC_ACTIONS_FROM_VARIATIONS),r=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"customization",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"variations",i),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"catalog",n||o.catalogDescriptor.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"catalogVersion",a||o.catalogDescriptor.catalogVersion);var l={params:{entry:r}};return s.save(l)},PersonalizationsmarteditRestService.prototype.getCxCmsActionsOnPageForCustomization=function(t,e){var i={type:"CXCMSACTION",catalogs:"ALL",fields:"FULL",pageId:this.personalizationsmarteditContextService.getSeData().pageId,pageCatalogId:this.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext.catalogId,customizationCode:t.code||"",currentPage:e||0};return this.getActionsDetails(i)},PersonalizationsmarteditRestService.prototype.getSegments=function(e){return this.restServiceFactory.get(t.SEGMENTS).get(e)},PersonalizationsmarteditRestService.prototype.getCustomization=function(e){var i=this.restServiceFactory.get(t.CUSTOMIZATION,"customizationCode"),n=this.extendRequestParamObjWithCustomizatonCode({},e.code);return n=this.extendRequestParamObjWithCatalogAwarePathVariables(n,e),i.get(n)},PersonalizationsmarteditRestService.prototype.createCustomization=function(e){return this.restServiceFactory.get(t.CUSTOMIZATION_PACKAGES).save(this.extendRequestParamObjWithCatalogAwarePathVariables(e))},PersonalizationsmarteditRestService.prototype.updateCustomization=function(e){var i=this.restServiceFactory.get(t.CUSTOMIZATION,"customizationCode");return e.customizationCode=e.code,i.update(this.extendRequestParamObjWithCatalogAwarePathVariables(e))},PersonalizationsmarteditRestService.prototype.updateCustomizationPackage=function(e){var i=this.restServiceFactory.get(t.CUSTOMIZATION_PACKAGE,"customizationCode");return e.customizationCode=e.code,i.update(this.extendRequestParamObjWithCatalogAwarePathVariables(e))},PersonalizationsmarteditRestService.prototype.deleteCustomization=function(e){var i={customizationCode:e};return this.restServiceFactory.get(t.CUSTOMIZATION,"customizationCode").remove(this.extendRequestParamObjWithCatalogAwarePathVariables(i))},PersonalizationsmarteditRestService.prototype.getVariation=function(e,i){var n=this.restServiceFactory.get(t.VARIATION,"variationCode"),a=this.extendRequestParamObjWithVariationCode({},i);return a=this.extendRequestParamObjWithCatalogAwarePathVariables(a),a=this.extendRequestParamObjWithCustomizatonCode(a,e),n.get(a)},PersonalizationsmarteditRestService.prototype.editVariation=function(e,i){var n=this.restServiceFactory.get(t.VARIATION,"variationCode");return i=this.extendRequestParamObjWithCatalogAwarePathVariables(i),(i=this.extendRequestParamObjWithCustomizatonCode(i,e)).variationCode=i.code,n.update(i)},PersonalizationsmarteditRestService.prototype.deleteVariation=function(e,i){var n=this.restServiceFactory.get(t.VARIATION,"variationCode"),a=this.extendRequestParamObjWithVariationCode({},i);return a=this.extendRequestParamObjWithCatalogAwarePathVariables(a),a=this.extendRequestParamObjWithCustomizatonCode(a,e),n.remove(a)},PersonalizationsmarteditRestService.prototype.createVariationForCustomization=function(e,i){var n=this.restServiceFactory.get(t.VARIATIONS);return i=this.extendRequestParamObjWithCatalogAwarePathVariables(i),i=this.extendRequestParamObjWithCustomizatonCode(i,e),n.save(i)},PersonalizationsmarteditRestService.prototype.getVariationsForCustomization=function(e,i){var n=this.restServiceFactory.get(t.VARIATIONS),a={},o=i||{};return a=this.extendRequestParamObjWithCatalogAwarePathVariables(a,o),(a=this.extendRequestParamObjWithCustomizatonCode(a,e)).fields=t.VARIATION_FOR_CUSTOMIZATION_DEFAULT_FIELDS,void 0!==o.includeFullFields&&o.includeFullFields&&(a.fields=t.FULL_FIELDS),n.get(a)},PersonalizationsmarteditRestService.prototype.replaceComponentWithContainer=function(e,i,n){var a=this.restServiceFactory.get(t.ADD_CONTAINER),o=this.extendRequestParamObjWithCatalogAwarePathVariables({},n),s=this.getParamsAction(e,null,i,null,null,null);return this.personalizationsmarteditUtils.pushToArrayIfValueExists(s.params.entry,"catalog",o.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s.params.entry,"catalogVersion",o.catalogVersion),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s.params.entry,"slotCatalog",n.slotCatalog),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s.params.entry,"oldComponentCatalog",n.oldComponentCatalog),a.save(s)},PersonalizationsmarteditRestService.prototype.getActions=function(e,i,n){var o=this.restServiceFactory.get(t.ACTIONS),s=this.getPathVariablesObjForModifyingActionURI(e,i,void 0,n),r={fields:t.FULL_FIELDS};return r=a.extend(r,s),o.get(r)},PersonalizationsmarteditRestService.prototype.createActions=function(e,i,n,a){var o=this.getPathVariablesObjForModifyingActionURI(e,i,void 0,a),s=this.prepareURI(t.ACTIONS,o);return this.$http({url:s,method:"PATCH",data:n,headers:{"Content-Type":"application/json;charset=utf-8"}})},PersonalizationsmarteditRestService.prototype.addActionToContainer=function(e,i,n,o,s,r){var l=this.restServiceFactory.get(t.ACTIONS),c=this.getPathVariablesObjForModifyingActionURI(o,s,void 0,r),d={type:"cxCmsActionData",containerId:n,componentId:e,componentCatalog:i};return d=a.extend(d,c),l.save(d)},PersonalizationsmarteditRestService.prototype.editAction=function(e,i,n,o,s,r){var l=this.restServiceFactory.get(t.ACTION,"actionId"),c=this.getPathVariablesObjForModifyingActionURI(e,i,n,r);return l.get(c).then(function(t){return(t=a.extend(t,c)).componentId=o,t.componentCatalog=s,l.update(t)})},PersonalizationsmarteditRestService.prototype.deleteAction=function(e,i,n,a){var o=this.restServiceFactory.get(t.ACTION,"actionId"),s=this.getPathVariablesObjForModifyingActionURI(e,i,n,a);return o.remove(s)},PersonalizationsmarteditRestService.prototype.deleteActions=function(e,i,n,a){var o=this.getPathVariablesObjForModifyingActionURI(e,i,void 0,a),s=this.prepareURI(t.ACTIONS,o);return this.$http({url:s,method:"DELETE",data:n,headers:{"Content-Type":"application/json;charset=utf-8"}})},PersonalizationsmarteditRestService.prototype.getComponents=function(e){var i=this.personalizationsmarteditContextService.getSeData().seExperienceData,n=this.restServiceFactory.get(t.CATALOGS),o={siteId:i.siteDescriptor.uid};return o=a.extend(o,e),n.get(this.extendRequestParamObjWithCatalogAwarePathVariables(o,e))},PersonalizationsmarteditRestService.prototype.getComponent=function(e){var i=this.personalizationsmarteditContextService.getSeData().seExperienceData,n=this.restServiceFactory.get(t.CATALOG,"itemUuid"),a={itemUuid:e,siteId:i.siteDescriptor.uid};return n.get(a)},PersonalizationsmarteditRestService.prototype.getNewComponentTypes=function(){return this.restServiceFactory.get(t.COMPONENT_TYPES).get()},PersonalizationsmarteditRestService.prototype.updateCustomizationRank=function(e,i){var n=this.personalizationsmarteditContextService.getSeData().seExperienceData,a=this.restServiceFactory.get(t.UPDATE_CUSTOMIZATION_RANK),o=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"customization",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"increaseValue",i),this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"catalog",n.catalogDescriptor.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"catalogVersion",n.catalogDescriptor.catalogVersion);var s={params:{entry:o}};return a.save(s)},PersonalizationsmarteditRestService.prototype.checkVersionConflict=function(e){var i=this.personalizationsmarteditContextService.getSeData().seExperienceData,n=this.restServiceFactory.get(t.CHECK_VERSION),a=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(a,"versionId",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(a,"catalog",i.catalogDescriptor.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(a,"catalogVersion",i.catalogDescriptor.catalogVersion);var o={params:{entry:a}};return n.save(o)},PersonalizationsmarteditRestService.CUSTOMIZATIONS="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/customizations",PersonalizationsmarteditRestService.CUSTOMIZATION=t.CUSTOMIZATIONS+"/:customizationCode",PersonalizationsmarteditRestService.CUSTOMIZATION_PACKAGES="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/customizationpackages",PersonalizationsmarteditRestService.CUSTOMIZATION_PACKAGE=t.CUSTOMIZATION_PACKAGES+"/:customizationCode",PersonalizationsmarteditRestService.ACTIONS_DETAILS="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/actions",PersonalizationsmarteditRestService.VARIATIONS=t.CUSTOMIZATION+"/variations",PersonalizationsmarteditRestService.VARIATION=t.VARIATIONS+"/:variationCode",PersonalizationsmarteditRestService.ACTIONS=t.VARIATION+"/actions",PersonalizationsmarteditRestService.ACTION=t.ACTIONS+"/:actionId",PersonalizationsmarteditRestService.CXCMSC_ACTIONS_FROM_VARIATIONS="/personalizationwebservices/v1/query/cxcmscomponentsfromvariations",PersonalizationsmarteditRestService.SEGMENTS="/personalizationwebservices/v1/segments",PersonalizationsmarteditRestService.CATALOGS="/cmswebservices/v1/sites/:siteId/cmsitems",PersonalizationsmarteditRestService.CATALOG=t.CATALOGS+"/:itemUuid",PersonalizationsmarteditRestService.ADD_CONTAINER="/personalizationwebservices/v1/query/cxReplaceComponentWithContainer",PersonalizationsmarteditRestService.COMPONENT_TYPES="/cmswebservices/v1/types?category=COMPONENT",PersonalizationsmarteditRestService.UPDATE_CUSTOMIZATION_RANK="/personalizationwebservices/v1/query/cxUpdateCustomizationRank",PersonalizationsmarteditRestService.CHECK_VERSION="/personalizationwebservices/v1/query/cxCmsPageVersionCheck",PersonalizationsmarteditRestService.VARIATION_FOR_CUSTOMIZATION_DEFAULT_FIELDS="variations(active,actions,enabled,code,name,rank,status,catalog,catalogVersion)",PersonalizationsmarteditRestService.FULL_FIELDS="FULL",PersonalizationsmarteditRestService=t=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditRestService)}(),U=function(){function PersonalizationsmarteditPreviewService(t){this.experienceService=t}return PersonalizationsmarteditPreviewService.$inject=["experienceService"],PersonalizationsmarteditPreviewService.prototype.removePersonalizationDataFromPreview=function(){return this.updatePreviewTicketWithVariations([])},PersonalizationsmarteditPreviewService.prototype.updatePreviewTicketWithVariations=function(t){var e=this;return this.experienceService.getCurrentExperience().then(function(i){if(i&&JSON.stringify(i.variations)!==JSON.stringify(t))return i.variations=t,e.experienceService.setCurrentExperience(i).then(function(){return e.experienceService.updateExperience()})})},PersonalizationsmarteditPreviewService=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditPreviewService)}(),L=function(){function PersonalizationsmarteditRulesAndPermissionsRegistrationService(t,e,i,n,a,o){this.personalizationsmarteditContextService=t,this.personalizationsmarteditRestService=e,this.permissionService=i,this.catalogVersionPermissionService=n,this.pageService=a,this.$q=o}return PersonalizationsmarteditRulesAndPermissionsRegistrationService.$inject=["personalizationsmarteditContextService","personalizationsmarteditRestService","permissionService","catalogVersionPermissionService","pageService","$q"],PersonalizationsmarteditRulesAndPermissionsRegistrationService.prototype.registerRules=function(){var t=this;this.permissionService.registerRule({names:["se.access.personalization"],verify:function(){return t.catalogVersionPermissionService.hasReadPermissionOnCurrent().then(function(){return t.personalizationsmarteditContextService.refreshExperienceData().then(function(){return t.personalizationsmarteditRestService.getCustomizations(t.getCustomizationFilter()).then(function(){return t.$q.resolve(!0)},function(e){return 403===e.status?t.$q.resolve(!1):t.$q.resolve(!0)})})})}}),this.permissionService.registerRule({names:["se.access.personalization.page"],verify:function(){return t.pageService.getCurrentPageInfo().then(function(e){return t.$q.resolve("EmailPage"!==e.typeCode)})}}),this.permissionService.registerPermission({aliases:["se.personalization.open"],rules:["se.access.personalization"]}),this.permissionService.registerPermission({aliases:["se.personalization.page"],rules:["se.access.personalization.page"]})},PersonalizationsmarteditRulesAndPermissionsRegistrationService.prototype.getCustomizationFilter=function(){return{currentPage:0,currentSize:1}},PersonalizationsmarteditRulesAndPermissionsRegistrationService=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditRulesAndPermissionsRegistrationService)}(),k=function(){function PersonalizationsmarteditServicesModule(){}return PersonalizationsmarteditServicesModule=n.__decorate([Object(o.SeModule)({imports:["loadConfigModule","smarteditServicesModule","yjqueryModule","permissionServiceModule","catalogVersionPermissionModule",V],providers:[F,x,$,R,U,L],initialize:["personalizationsmarteditRulesAndPermissionsRegistrationService",function(t){"ngInject";t.registerRules()}]})],PersonalizationsmarteditServicesModule)}(),Z=function(){function PersonalizationsmarteditDataFactory(){}return PersonalizationsmarteditDataFactory=n.__decorate([Object(o.SeModule)({imports:[k],providers:[N]})],PersonalizationsmarteditDataFactory)}(),B={provide:"CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS",useValue:{BASIC_INFO_TAB_NAME:"basicinfotab",BASIC_INFO_TAB_FORM_NAME:"form.basicinfotab",TARGET_GROUP_TAB_NAME:"targetgrptab",TARGET_GROUP_TAB_FORM_NAME:"form.targetgrptab"}},j={provide:"CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS",useValue:{CONFIRM_OK:"confirmOk",CONFIRM_CANCEL:"confirmCancel",CONFIRM_NEXT:"confirmNext"}},G={provide:"CUSTOMIZATION_VARIATION_MANAGEMENT_SEGMENTTRIGGER_GROUPBY",useValue:{CRITERIA_AND:"AND",CRITERIA_OR:"OR"}},H={provide:"DATE_CONSTANTS",useValue:{ANGULAR_FORMAT:"short",MOMENT_FORMAT:"M/D/YY h:mm A",MOMENT_ISO:"YYYY-MM-DDTHH:mm:00ZZ",ISO:"yyyy-MM-ddTHH:mm:00Z"}},q=function(){function PersonalizationsmarteditManager(t,e,i){var n=this;this.modalService=t,this.MODAL_BUTTON_STYLES=e,this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS=i,this.openCreateCustomizationModal=function(){n.modalService.open({title:"personalization.modal.customizationvariationmanagement.title",templateInline:'<manage-customization-view data-modal-manager="modalController.modalManager"/>',controller:["modalManager",function ctrl(t){"ngInject";this.modalManager=t}],buttons:[{id:n.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_CANCEL,label:"personalization.modal.customizationvariationmanagement.button.cancel",style:n.MODAL_BUTTON_STYLES.SECONDARY}],size:"lg sliderPanelParentModal"})},this.openEditCustomizationModal=function(t,e){n.modalService.open({title:"personalization.modal.customizationvariationmanagement.title",templateInline:'<manage-customization-view data-modal-manager="modalController.modalManager" data-customization-code="modalController.customizationCode" data-variation-code="modalController.variationCode"/>',controller:["modalManager",function ctrl(i){"ngInject";this.modalManager=i,this.customizationCode=t,this.variationCode=e}],buttons:[{id:"confirmCancel",label:"personalization.modal.customizationvariationmanagement.button.cancel",style:n.MODAL_BUTTON_STYLES.SECONDARY}],size:"lg sliderPanelParentModal"})}}return PersonalizationsmarteditManager.$inject=["modalService","MODAL_BUTTON_STYLES","CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS"],PersonalizationsmarteditManager=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditManager)}(),W=function(){function PersonalizationsmarteditManageCustomizationViewModule(){}return PersonalizationsmarteditManageCustomizationViewModule=n.__decorate([Object(o.SeModule)({imports:["modalServiceModule","coretemplates","ui.select","confirmationModalServiceModule","functionsModule","sliderPanelModule","seConstantsModule","yjqueryModule",Z,V],declarations:[s,r,l],providers:[c,q,B,j,G,H]})],PersonalizationsmarteditManageCustomizationViewModule)}();window.__smartedit__.addDecoratorPayload("SeComponent","MultipleTriggersComponent",{templateUrl:"multipleTriggersComponentTemplate.html"});var Y=function(){function MultipleTriggersComponent(t){this.triggerTabService=t}return MultipleTriggersComponent.$inject=["triggerTabService"],MultipleTriggersComponent.prototype.$onInit=function(){this.tabsList=this.triggerTabService.getTriggersTabs()},MultipleTriggersComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"multipleTriggersComponentTemplate.html"})],MultipleTriggersComponent)}(),K=function(){return function TriggerDataState(){this.state={code:"",name:"",expression:[],isDefault:!1,showExpression:!0,selectedVariation:void 0}}}(),X=function(){function TriggerTabService(){this.tabsList=[],this.triggerDataState=new K}return TriggerTabService.prototype.getTriggersTabs=function(){return this.tabsList},TriggerTabService.prototype.addTriggerTab=function(t){0===this.tabsList.filter(function(e){return e.id===t.id}).length&&this.tabsList.push(t)},TriggerTabService.prototype.removeTriggerTab=function(t){var e=this.tabsList.filter(function(e){return e.id===t.id});if(e.length>0){var i=this.tabsList.indexOf(e[0]);this.tabsList.splice(i,1)}},TriggerTabService.prototype.getTriggerDataState=function(){return this.triggerDataState.state},TriggerTabService=n.__decorate([Object(o.SeInjectable)()],TriggerTabService)}(),Q=function(){function PersonalizationsmarteditManagementModule(){}return PersonalizationsmarteditManagementModule=n.__decorate([Object(o.SeModule)({imports:["smarteditServicesModule"],providers:[X],declarations:[Y]})],PersonalizationsmarteditManagementModule)}(),J=function(){function VersionCheckerService(t,e,i){this.$q=t,this.personalizationsmarteditRestService=e,this.pageVersionSelectionService=i}return VersionCheckerService.$inject=["$q","personalizationsmarteditRestService","pageVersionSelectionService"],VersionCheckerService.prototype.setVersion=function(t){this.version=t},VersionCheckerService.prototype.provideTranlationKey=function(t){return this.version=this.version||this.pageVersionSelectionService.getSelectedPageVersion(),this.version?this.personalizationsmarteditRestService.checkVersionConflict(this.version.uid).then(function(e){return e.result?t:"personalization.se.cms.actionitem.page.version.rollback.confirmation"},function(){return t}):this.$q.when(t)},VersionCheckerService=n.__decorate([Object(o.SeInjectable)()],VersionCheckerService)}(),tt=function(){function VersioningModule(){}return VersioningModule=n.__decorate([Object(o.SeModule)({imports:["smarteditServicesModule"],providers:[J]})],VersioningModule)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditCustomizeViewComponent",{templateUrl:"personalizationsmarteditCustomizeViewTemplate.html",inputs:["isMenuOpen"]});var et=function(){function PersonalizationsmarteditCustomizeViewComponent(t,e,i,n,a,o){this.$filter=t,this.customizationDataFactory=e,this.personalizationsmarteditContextService=i,this.personalizationsmarteditMessageHandler=n,this.personalizationsmarteditUtils=a,this.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER=o}return PersonalizationsmarteditCustomizeViewComponent.$inject=["$filter","customizationDataFactory","personalizationsmarteditContextService","personalizationsmarteditMessageHandler","personalizationsmarteditUtils","PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER"],PersonalizationsmarteditCustomizeViewComponent.prototype.$onInit=function(){this.personalizationsmarteditContextService.refreshExperienceData(),this.moreCustomizationsRequestProcessing=!1,this.customizationsList=this.customizationDataFactory.items,this.customizationDataFactory.resetData(),this.pagination=new O({}),this.pagination.reset(),this.filters=this.personalizationsmarteditContextService.getCustomizeFiltersState(),this.catalogFilter=this.filters.catalogFilter,this.pageFilter=this.filters.pageFilter,this.statusFilter=this.filters.statusFilter,this.nameFilter=this.filters.nameFilter},PersonalizationsmarteditCustomizeViewComponent.prototype.$onDestroy=function(){var t=this.personalizationsmarteditContextService.getCustomizeFiltersState();t.catalogFilter=this.catalogFilter,t.pageFilter=this.pageFilter,t.statusFilter=this.statusFilter,t.nameFilter=this.nameFilter,this.personalizationsmarteditContextService.setCustomizeFiltersState(t)},PersonalizationsmarteditCustomizeViewComponent.prototype.$onChanges=function(t){t.isMenuOpen&&!t.isMenuOpen.isFirstChange()&&t.isMenuOpen.currentValue&&this.refreshList()},PersonalizationsmarteditCustomizeViewComponent.prototype.errorCallback=function(){this.personalizationsmarteditMessageHandler.sendError(this.$filter("translate")("personalization.error.gettingcustomizations")),this.moreCustomizationsRequestProcessing=!1},PersonalizationsmarteditCustomizeViewComponent.prototype.successCallback=function(t){this.pagination=new O(t.pagination),this.moreCustomizationsRequestProcessing=!1},PersonalizationsmarteditCustomizeViewComponent.prototype.getStatus=function(){var t=this;return void 0===this.statusFilter?this.personalizationsmarteditUtils.getStatusesMapping()[0]:this.personalizationsmarteditUtils.getStatusesMapping().filter(function(e){return e.code===t.statusFilter})[0]},PersonalizationsmarteditCustomizeViewComponent.prototype.getCustomizations=function(t){var e={filter:t,dataArrayName:"customizations"};this.customizationDataFactory.updateData(e,this.successCallback.bind(this),this.errorCallback.bind(this))},PersonalizationsmarteditCustomizeViewComponent.prototype.getCustomizationsFilterObject=function(){var t={currentSize:this.pagination.getCount(),currentPage:this.pagination.getPage()+1,name:this.nameFilter,statuses:this.getStatus().modelStatuses,catalogs:this.catalogFilter};return this.pageFilter===this.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ONLY_THIS_PAGE&&(t.pageId=this.personalizationsmarteditContextService.getSeData().pageId,t.pageCatalogId=(this.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext||{}).catalogId),t},PersonalizationsmarteditCustomizeViewComponent.prototype.refreshList=function(){!1===this.moreCustomizationsRequestProcessing&&(this.moreCustomizationsRequestProcessing=!0,this.pagination.reset(),this.customizationDataFactory.resetData(),this.getCustomizations(this.getCustomizationsFilterObject()))},PersonalizationsmarteditCustomizeViewComponent.prototype.catalogFilterChange=function(t){this.catalogFilter=t,this.refreshList()},PersonalizationsmarteditCustomizeViewComponent.prototype.pageFilterChange=function(t){this.pageFilter=t,this.refreshList()},PersonalizationsmarteditCustomizeViewComponent.prototype.statusFilterChange=function(t){this.statusFilter=t,this.refreshList()},PersonalizationsmarteditCustomizeViewComponent.prototype.nameInputKeypress=function(t){(13===t.which||this.nameFilter.length>2||0===this.nameFilter.length)&&this.refreshList()},PersonalizationsmarteditCustomizeViewComponent.prototype.addMoreCustomizationItems=function(){this.pagination.getPage()<this.pagination.getTotalPages()-1&&!this.moreCustomizationsRequestProcessing&&(this.moreCustomizationsRequestProcessing=!0,this.getCustomizations(this.getCustomizationsFilterObject()))},PersonalizationsmarteditCustomizeViewComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"personalizationsmarteditCustomizeViewTemplate.html",inputs:["isMenuOpen"]})],PersonalizationsmarteditCustomizeViewComponent)}(),it=function(){function PersonalizationsmarteditCustomizeViewServiceProxy(){}return PersonalizationsmarteditCustomizeViewServiceProxy.prototype.getSourceContainersInfo=function(){"proxyFunction";return null},PersonalizationsmarteditCustomizeViewServiceProxy=n.__decorate([Object(o.GatewayProxied)("getSourceContainersInfo"),Object(o.SeInjectable)()],PersonalizationsmarteditCustomizeViewServiceProxy)}(),nt={provide:"PERSONALIZATION_CATALOG_FILTER",useValue:{ALL:"all",CURRENT:"current",PARENTS:"parents"}};window.__smartedit__.addDecoratorPayload("SeComponent","CatalogFilterDropdownComponent",{templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]});var at=function(){function CatalogFilterDropdownComponent(t,e){var i=this;this.$q=t,this.PERSONALIZATION_CATALOG_FILTER=e,this.fetchStrategy={fetchAll:function(){return i.$q.when(i.items)}},this.onChange=this.onChange.bind(this)}return CatalogFilterDropdownComponent.$inject=["$q","PERSONALIZATION_CATALOG_FILTER"],CatalogFilterDropdownComponent.prototype.$onInit=function(){this.items=[{id:this.PERSONALIZATION_CATALOG_FILTER.ALL,label:"personalization.filter.catalog.all"},{id:this.PERSONALIZATION_CATALOG_FILTER.CURRENT,label:"personalization.filter.catalog.current"},{id:this.PERSONALIZATION_CATALOG_FILTER.PARENTS,label:"personalization.filter.catalog.parents"}],this.selectedId=this.initialValue||this.items[1].id},CatalogFilterDropdownComponent.prototype.onChange=function(t){this.onSelectCallback({value:this.selectedId})},CatalogFilterDropdownComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]})],CatalogFilterDropdownComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","CatalogVersionFilterDropdownComponent",{templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]});var ot=function(){function CatalogVersionFilterDropdownComponent(t,e,i){var n=this;this.$q=t,this.componentMenuService=e,this.personalizationsmarteditContextService=i,this.fetchStrategy={fetchAll:function(){return n.$q.when(n.items)}},this.onChange=this.onChange.bind(this)}return CatalogVersionFilterDropdownComponent.$inject=["$q","componentMenuService","personalizationsmarteditContextService"],CatalogVersionFilterDropdownComponent.prototype.$onInit=function(){var t=this;this.itemTemplate="catalogVersionFilterDropdownItemTemplate.html",this.componentMenuService.getValidContentCatalogVersions().then(function(e){t.items=e;var i=t.personalizationsmarteditContextService.getSeData().seExperienceData;t.items.forEach(function(t){t.isCurrentCatalog=t.id===i.catalogDescriptor.catalogVersionUuid}),t.componentMenuService.getInitialCatalogVersion(t.items).then(function(e){t.selectedId=t.initialValue||e.id})})},CatalogVersionFilterDropdownComponent.prototype.onChange=function(t){this.onSelectCallback({value:this.selectedId})},CatalogVersionFilterDropdownComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]})],CatalogVersionFilterDropdownComponent)}(),st={provide:"PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER",useValue:{ALL:"all",ONLY_THIS_PAGE:"onlythispage"}};window.__smartedit__.addDecoratorPayload("SeComponent","PageFilterDropdownComponent",{templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]});var rt=function(){function PageFilterDropdownComponent(t,e){var i=this;this.$q=t,this.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER=e,this.fetchStrategy={fetchAll:function(){return i.$q.when(i.items)}},this.onChange=this.onChange.bind(this)}return PageFilterDropdownComponent.$inject=["$q","PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER"],PageFilterDropdownComponent.prototype.$onInit=function(){this.items=[{id:this.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ALL,label:"personalization.filter.page.all"},{id:this.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ONLY_THIS_PAGE,label:"personalization.filter.page.onlythispage"}],this.selectedId=this.initialValue||this.items[1].id},PageFilterDropdownComponent.prototype.onChange=function(t){this.onSelectCallback({value:this.selectedId})},PageFilterDropdownComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]})],PageFilterDropdownComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","StatusFilterDropdownComponent",{templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]});var lt=function(){function StatusFilterDropdownComponent(t,e){var i=this;this.$q=t,this.personalizationsmarteditUtils=e,this.fetchStrategy={fetchAll:function(){return i.$q.when(i.items)}},this.onChange=this.onChange.bind(this)}return StatusFilterDropdownComponent.$inject=["$q","personalizationsmarteditUtils"],StatusFilterDropdownComponent.prototype.$onInit=function(){this.items=this.personalizationsmarteditUtils.getStatusesMapping().map(function(t){return{id:t.code,label:t.text,modelStatuses:t.modelStatuses}}),this.selectedId=this.initialValue||this.items[0].id},StatusFilterDropdownComponent.prototype.onChange=function(t){this.onSelectCallback({value:this.selectedId})},StatusFilterDropdownComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"pageFilterDropdownTemplate.html",inputs:["initialValue","onSelectCallback: &"]})],StatusFilterDropdownComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","HasMulticatalogComponent",{templateUrl:"hasMulticatalogTemplate.html"});var ct=function(){function HasMulticatalogComponent(t){this.personalizationsmarteditContextService=t}return HasMulticatalogComponent.$inject=["personalizationsmarteditContextService"],HasMulticatalogComponent.prototype.$onInit=function(){this.hasMulticatalog=this.getSeExperienceData().siteDescriptor.contentCatalogs.length>1},HasMulticatalogComponent.prototype.getSeExperienceData=function(){return this.personalizationsmarteditContextService.getSeData().seExperienceData},HasMulticatalogComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"hasMulticatalogTemplate.html"})],HasMulticatalogComponent)}(),dt=function(){function PersonalizationsmarteditCommonComponentsModule(){}return PersonalizationsmarteditCommonComponentsModule=n.__decorate([Object(o.SeModule)({imports:["ySelectModule","componentMenuServiceModule","l10nModule",V,k],declarations:[at,ot,rt,lt,ct],providers:[st,nt]})],PersonalizationsmarteditCommonComponentsModule)}();window.__smartedit__.addDecoratorPayload("SeComponent","CustomizationsListComponent",{templateUrl:"customizationsListTemplate.html",inputs:["customizationsList","requestProcessing"]});var mt=function(){function CustomizationsListComponent(t,e,i,n,a,o,s,r,l,c,d,m,p,u,g,h,C){this.$q=t,this.$filter=e,this.personalizationsmarteditContextService=i,this.personalizationsmarteditRestService=n,this.personalizationsmarteditCommerceCustomizationService=a,this.personalizationsmarteditMessageHandler=o,this.personalizationsmarteditUtils=s,this.personalizationsmarteditDateUtils=r,this.personalizationsmarteditContextUtils=l,this.personalizationsmarteditPreviewService=c,this.personalizationsmarteditManager=d,this.personalizationsmarteditCustomizeViewServiceProxy=m,this.systemEventService=p,this.crossFrameEventService=u,this.SHOW_TOOLBAR_ITEM_CONTEXT=g,this.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY=h,this.lodash=C}return CustomizationsListComponent.$inject=["$q","$filter","personalizationsmarteditContextService","personalizationsmarteditRestService","personalizationsmarteditCommerceCustomizationService","personalizationsmarteditMessageHandler","personalizationsmarteditUtils","personalizationsmarteditDateUtils","personalizationsmarteditContextUtils","personalizationsmarteditPreviewService","personalizationsmarteditManager","personalizationsmarteditCustomizeViewServiceProxy","systemEventService","crossFrameEventService","SHOW_TOOLBAR_ITEM_CONTEXT","CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY","lodash"],CustomizationsListComponent.prototype.$onInit=function(){var t=this;this.sourceContainersComponentsInfo={},this.systemEventService.registerEventHandler("CUSTOMIZATIONS_MODIFIED",function(){return t.refreshCustomizeContext(),t.$q.when()})},CustomizationsListComponent.prototype.initCustomization=function(t){t.collapsed=!0,(this.personalizationsmarteditContextService.getCustomize().selectedCustomization||{}).code===t.code&&(t.collapsed=!1,this.updateCustomizationData(t)),this.personalizationsmarteditUtils.getAndSetCatalogVersionNameL10N(t)},CustomizationsListComponent.prototype.editCustomizationAction=function(t){this.personalizationsmarteditContextUtils.clearCombinedViewContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService),this.personalizationsmarteditManager.openEditCustomizationModal(t.code)},CustomizationsListComponent.prototype.customizationRowClick=function(t,e){this.clearAllSubMenu(),t.collapsed=!t.collapsed,t.collapsed||this.updateCustomizationData(t),e&&this.customizationClick(t),this.customizationsList.filter(function(e){return t.code!==e.code}).forEach(function(t){t.collapsed=!0})},CustomizationsListComponent.prototype.customizationClick=function(t){var e=this.personalizationsmarteditContextService.getCombinedView(),i=this.personalizationsmarteditContextService.getCustomize().selectedVariations,n=this.getVisibleVariations(t),a=this.personalizationsmarteditContextService.getCustomize();if(a.selectedCustomization=t,a.selectedVariations=n,this.personalizationsmarteditContextService.setCustomize(a),n.length>0){var o=this.personalizationsmarteditUtils.getVariationCodes(n).join(",");this.getAndSetComponentsForVariation(t.code,o,t.catalog,t.catalogVersion)}(this.lodash.isObjectLike(i)&&!this.lodash.isArray(i)||e.enabled)&&this.updatePreviewTicket(),this.personalizationsmarteditContextUtils.clearCombinedViewContext(this.personalizationsmarteditContextService),this.crossFrameEventService.publish(this.SHOW_TOOLBAR_ITEM_CONTEXT,this.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)},CustomizationsListComponent.prototype.getSelectedVariationClass=function(t){return this.lodash.isEqual(t.code,(this.personalizationsmarteditContextService.getCustomize().selectedVariations||{}).code)?"selectedVariation":""},CustomizationsListComponent.prototype.getSelectedCustomizationClass=function(t){return this.lodash.isEqual(t.code,(this.personalizationsmarteditContextService.getCustomize().selectedCustomization||{}).code)&&this.lodash.isArray(this.personalizationsmarteditContextService.getCustomize().selectedVariations)?"selectedCustomization":""},CustomizationsListComponent.prototype.variationClick=function(t,e){var i=this.personalizationsmarteditContextService.getCustomize();i.selectedCustomization=t,i.selectedVariations=e,this.personalizationsmarteditContextService.setCustomize(i),this.personalizationsmarteditContextUtils.clearCombinedViewContext(this.personalizationsmarteditContextService),this.getAndSetComponentsForVariation(t.code,e.code,t.catalog,t.catalogVersion),this.updatePreviewTicket(t.code,[e]),this.crossFrameEventService.publish(this.SHOW_TOOLBAR_ITEM_CONTEXT,this.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)},CustomizationsListComponent.prototype.hasCommerceActions=function(t){return this.personalizationsmarteditUtils.hasCommerceActions(t)},CustomizationsListComponent.prototype.getCommerceCustomizationTooltip=function(t){return this.personalizationsmarteditUtils.getCommerceCustomizationTooltipHTML(t)},CustomizationsListComponent.prototype.getActivityStateForCustomization=function(t){return this.personalizationsmarteditUtils.getActivityStateForCustomization(t)},CustomizationsListComponent.prototype.getActivityStateForVariation=function(t,e){return this.personalizationsmarteditUtils.getActivityStateForVariation(t,e)},CustomizationsListComponent.prototype.clearAllSubMenu=function(){for(var t=0,e=this.customizationsList;t<e.length;t++){e[t].subMenu=!1}},CustomizationsListComponent.prototype.getEnablementTextForCustomization=function(t){return this.personalizationsmarteditUtils.getEnablementTextForCustomization(t,"personalization.toolbar.pagecustomizations")},CustomizationsListComponent.prototype.getEnablementTextForVariation=function(t){return this.personalizationsmarteditUtils.getEnablementTextForVariation(t,"personalization.toolbar.pagecustomizations")},CustomizationsListComponent.prototype.isEnabled=function(t){return this.personalizationsmarteditUtils.isPersonalizationItemEnabled(t)},CustomizationsListComponent.prototype.getDatesForCustomization=function(t){var e="",i="",n="";return(t.enabledStartDate||t.enabledEndDate)&&(i=this.personalizationsmarteditDateUtils.formatDateWithMessage(t.enabledStartDate),n=this.personalizationsmarteditDateUtils.formatDateWithMessage(t.enabledEndDate),t.enabledStartDate||(i=" ..."),t.enabledEndDate||(n="... "),e+=" ("+i+" - "+n+") "),e},CustomizationsListComponent.prototype.customizationSubMenuAction=function(t){t.subMenu||this.clearAllSubMenu(),t.subMenu=!t.subMenu},CustomizationsListComponent.prototype.isCustomizationFromCurrentCatalog=function(t){return this.personalizationsmarteditUtils.isItemFromCurrentCatalog(t,this.personalizationsmarteditContextService.getSeData())},CustomizationsListComponent.prototype.statusNotDeleted=function(t){return this.personalizationsmarteditUtils.isItemVisible(t)},CustomizationsListComponent.prototype.matchActionForVariation=function(t,e){return t.variationCode===e.code&&t.actionCatalog===e.catalog&&t.actionCatalogVersion===e.catalogVersion},CustomizationsListComponent.prototype.numberOfAffectedComponentsForActions=function(t){var e=this,i=0;return t.forEach(function(t){i+=parseInt(e.sourceContainersComponentsInfo[t.containerId],10)||0}),i},CustomizationsListComponent.prototype.initSourceContainersComponentsInfo=function(){var t=this,e=this.$q.defer();return this.personalizationsmarteditCustomizeViewServiceProxy.getSourceContainersInfo().then(function(i){t.sourceContainersComponentsInfo=i,e.resolve()},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.gettingnumberofaffectedcomponentsforvariation")),e.reject()}),e.promise},CustomizationsListComponent.prototype.paginatedGetAndSetNumberOfAffectedComponentsForVariations=function(t,e){var i=this;this.personalizationsmarteditRestService.getCxCmsActionsOnPageForCustomization(t,e).then(function(n){t.variations.forEach(function(t){var a=n.actions.filter(function(e){return i.matchActionForVariation(e,t)});t.numberOfAffectedComponents=0===e?0:t.numberOfAffectedComponents,t.numberOfAffectedComponents+=i.numberOfAffectedComponentsForActions(a)});var a=e+1;a<n.pagination.totalPages&&i.paginatedGetAndSetNumberOfAffectedComponentsForVariations(t,a)},function(){i.personalizationsmarteditMessageHandler.sendError(i.$filter("translate")("personalization.error.gettingnumberofaffectedcomponentsforvariation"))})},CustomizationsListComponent.prototype.getAndSetNumberOfAffectedComponentsForVariations=function(t){var e=this,i=this.personalizationsmarteditContextService.getCustomize(),n=(i.selectedComponents||[]).every(function(t){return void 0!==e.sourceContainersComponentsInfo[t]});!n||null===i.selectedComponents||this.lodash.isEqual(this.sourceContainersComponentsInfo,{})?this.initSourceContainersComponentsInfo().finally(function(){e.paginatedGetAndSetNumberOfAffectedComponentsForVariations(t,0)}):n&&this.paginatedGetAndSetNumberOfAffectedComponentsForVariations(t,0)},CustomizationsListComponent.prototype.getNumberOfAffectedComponentsForCorrespondingVariation=function(t,e){return(t.filter(function(t){return t.code===e})[0]||{}).numberOfAffectedComponents},CustomizationsListComponent.prototype.updateCustomizationData=function(t){var e=this;this.personalizationsmarteditRestService.getVariationsForCustomization(t.code,t).then(function(i){i.variations.forEach(function(i){i.numberOfAffectedComponents=e.getNumberOfAffectedComponentsForCorrespondingVariation(t.variations,i.code)}),t.variations=i.variations||[],t.variations.forEach(function(t){t.numberOfCommerceActions=e.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCount(t),t.commerceCustomizations=e.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCountMap(t)}),e.getAndSetNumberOfAffectedComponentsForVariations(t)},function(){e.personalizationsmarteditMessageHandler.sendError(e.$filter("translate")("personalization.error.gettingcustomization"))})},CustomizationsListComponent.prototype.getVisibleVariations=function(t){return this.personalizationsmarteditUtils.getVisibleItems(t.variations)},CustomizationsListComponent.prototype.getAndSetComponentsForVariation=function(t,e,i,n){var a=this;this.personalizationsmarteditRestService.getComponenentsIdsForVariation(t,e,i,n).then(function(t){var e=a.personalizationsmarteditContextService.getCustomize();e.selectedComponents=t.components,a.personalizationsmarteditContextService.setCustomize(e)},function(){a.personalizationsmarteditMessageHandler.sendError(a.$filter("translate")("personalization.error.gettingcomponentsforvariation"))})},CustomizationsListComponent.prototype.updatePreviewTicket=function(t,e){var i=this.personalizationsmarteditUtils.getVariationKey(t,e);this.personalizationsmarteditPreviewService.updatePreviewTicketWithVariations(i)},CustomizationsListComponent.prototype.refreshCustomizeContext=function(){var t=this,e=this.lodash.cloneDeep(this.personalizationsmarteditContextService.getCustomize());e.selectedCustomization&&this.personalizationsmarteditRestService.getCustomization(e.selectedCustomization).then(function(i){e.selectedCustomization=i,e.selectedVariations&&!t.lodash.isArray(e.selectedVariations)&&i.variations.filter(function(t){return e.selectedVariations.code===t.code}).forEach(function(i){e.selectedVariations=i,t.personalizationsmarteditUtils.isItemVisible(i)||(e.selectedCustomization=null,e.selectedVariations=null,t.personalizationsmarteditPreviewService.removePersonalizationDataFromPreview())}),t.personalizationsmarteditContextService.setCustomize(e)},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.gettingcustomization"))})},CustomizationsListComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"customizationsListTemplate.html",inputs:["customizationsList","requestProcessing"]})],CustomizationsListComponent)}(),pt=function(){function PersonalizationsmarteditCustomizeViewModule(){}return PersonalizationsmarteditCustomizeViewModule=n.__decorate([Object(o.SeModule)({imports:["seConstantsModule","personalizationsmarteditManageCustomizationViewModule","smarteditCommonsModule",dt,V,k],providers:[it,N],declarations:[et,mt]})],PersonalizationsmarteditCustomizeViewModule)}(),ut=function(t){return function(){function PersonalizationsmarteditContextMenuAddEditActionController(e,i,n,o,s,r,l,c,d,m,p){var u=this;this.$scope=e,this.$filter=i,this.$q=n,this.$timeout=o,this.modalManager=s,this.editorModalService=r,this.personalizationsmarteditContextService=l,this.personalizationsmarteditRestService=c,this.personalizationsmarteditMessageHandler=d,this.slotRestrictionsService=m,this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING=p,this.colorIndicatorForElement=t.colorIndicatorForElement,this.slotId=t.slotId,this.actionId=t.actionId,this.componentUuid=t.componentUuid,this.defaultComponentId=t.componentId,this.editEnabled=t.editEnabled,this.slotCatalog=t.slotCatalog,this.componentCatalog=t.componentCatalog,this.selectedCustomizationCode=t.selectedCustomizationCode,this.selectedVariationCode=t.selectedVariationCode,this.componentFilter={name:""},this.componentType=t.componentType,this.actions=[{id:"create",name:this.$filter("translate")("personalization.modal.addeditaction.createnewcomponent")},{id:"use",name:this.$filter("translate")("personalization.modal.addeditaction.usecomponent")}],this.initNewComponentTypes=function(){u.slotRestrictionsService.getSlotRestrictions(u.slotId).then(function(t){u.personalizationsmarteditRestService.getNewComponentTypes().then(function(e){u.$scope.newComponentTypes=e.componentTypes.filter(function(e){return t.indexOf(e.code)>-1})},function(){u.personalizationsmarteditMessageHandler.sendError(u.$filter("translate")("personalization.error.gettingcomponentstypes"))})},function(){u.personalizationsmarteditMessageHandler.sendError(u.$filter("translate")("personalization.error.gettingslotrestrictions"))})},this.getAndSetComponentById=function(t){u.personalizationsmarteditRestService.getComponent(t).then(function(t){u.$scope.component.selected=t},function(){u.personalizationsmarteditMessageHandler.sendError(u.$filter("translate")("personalization.error.gettingcomponents"))})},this.newComponentTypeSelectedEvent=function(){var t={smarteditComponentType:u.newComponent.selected.code,catalogVersionUuid:u.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext.catalogVersionUuid};u.editorModalService.open(t).then(function(t){u.$scope.action={selected:u.$filter("filter")(u.actions,{id:"use"},!0)[0]},u.componentUuid=t.uuid,u.getAndSetComponentById(u.componentUuid)},function(){u.newComponent={}})},this.editAction=function(t,e,i,n,a,o){var s=u.$q.defer();return u.personalizationsmarteditRestService.editAction(t,e,i,n,a,o).then(function(){u.personalizationsmarteditMessageHandler.sendSuccess(u.$filter("translate")("personalization.info.updatingaction")),s.resolve()},function(){u.personalizationsmarteditMessageHandler.sendError(u.$filter("translate")("personalization.error.updatingaction")),s.reject()}),s.promise},this.addActionToContainer=function(t,e,i,n,a,o){var s=u.$q.defer();return u.personalizationsmarteditRestService.addActionToContainer(t,e,i,n,a,o).then(function(){u.personalizationsmarteditMessageHandler.sendSuccess(u.$filter("translate")("personalization.info.creatingaction")),s.resolve(i)},function(){u.personalizationsmarteditMessageHandler.sendError(u.$filter("translate")("personalization.error.creatingaction")),s.reject()}),s.promise},this.buttonHandlerFn=function(t){var e=u.$q.defer();if("submit"===t){u.modalManager.disableButton("submit");var i=u.$scope.component.selected.catalogVersion.substring(0,u.$scope.component.selected.catalogVersion.indexOf("/")),n={catalog:u.$scope.selectedCustomization.catalog,catalogVersion:u.$scope.selectedCustomization.catalogVersion},o={slotCatalog:u.slotCatalog,oldComponentCatalog:u.componentCatalog};return a.extend(o,n),u.editEnabled?u.editAction(u.$scope.selectedCustomization.code,u.$scope.selectedVariation.code,u.actionId,u.$scope.component.selected.uid,i,n):u.personalizationsmarteditRestService.replaceComponentWithContainer(u.defaultComponentId,u.slotId,o).then(function(t){return u.addActionToContainer(u.$scope.component.selected.uid,i,t.sourceId,u.$scope.selectedCustomization.code,u.$scope.selectedVariation.code,n)},function(){return u.personalizationsmarteditMessageHandler.sendError(u.$filter("translate")("personalization.error.replacingcomponent")),e.reject()})}return e.reject()},this.getComponentFilterObject=function(){var t=u.$scope.newComponentTypes.map(function(t){return t.code}).join(",");return{currentPage:u.componentPagination.getPage()+1,mask:u.componentFilter.name,pageSize:10,sort:"name",catalog:u.catalogFilter,catalogVersion:u.catalogVersionFilter,typeCodes:t}},this.addMoreComponentItems=function(){u.componentPagination.getPage()<u.componentPagination.getTotalPages()-1&&!u.moreComponentRequestProcessing&&u.$scope.newComponentTypes.length>0&&(u.moreComponentRequestProcessing=!0,u.personalizationsmarteditRestService.getComponents(u.getComponentFilterObject()).then(function(t){var e=t.response.filter(function(t){return!t.restricted});Array.prototype.push.apply(u.components,e),u.componentPagination=new O(t.pagination),u.moreComponentRequestProcessing=!1,u.components.length<20&&u.$timeout(function(){u.addMoreComponentItems()},0)},function(){u.personalizationsmarteditMessageHandler.sendError(u.$filter("translate")("personalization.error.gettingcomponents")),u.moreComponentRequestProcessing=!1}))},this.componentSearchInputKeypress=function(t,e){t&&[37,38,39,40].indexOf(t.which)>-1||(u.componentPagination.reset(),u.componentFilter.name=e,u.components.length=0,u.addMoreComponentItems())},this.getAndSetColorAndLetter=function(){var t=u.personalizationsmarteditContextService.getCombinedView();t.enabled&&(t.selectedItems||[]).forEach(function(t,e){var i=u.selectedCustomizationCode===t.customization.code;i=i&&u.selectedVariationCode===t.variation.code;var n=e%Object.keys(u.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).length;i&&(u.letterIndicatorForElement=String.fromCharCode("a".charCodeAt(0)+n).toUpperCase(),u.colorIndicatorForElement=u.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING[n].listClass)})},this.catalogVersionFilterChange=function(t){if(t){var e=t.split("/");u.catalogFilter=e[0],u.catalogVersionFilter=e[1],u.componentPagination.reset(),u.components.length=0,u.addMoreComponentItems()}},this.editEnabled?this.$scope.action={selected:this.$filter("filter")(this.actions,{id:"use"},!0)[0]}:this.$scope.action={},this.components=[],this.newComponent={},this.$scope.component={},this.$scope.newComponentTypes=[],this.modalManager.setButtonHandler(this.buttonHandlerFn),this.componentPagination=new O({}),this.componentPagination.reset(),this.moreComponentRequestProcessing=!1,this.$scope.$watch("action.selected",function(t,e){t!==e&&(u.$scope.component.selected=void 0,u.editEnabled&&u.getAndSetComponentById(u.componentUuid))},!0),this.$scope.$watch("component.selected",function(t){u.modalManager.disableButton("submit"),void 0!==t&&u.modalManager.enableButton("submit")},!0),this.$scope.$watch("newComponentTypes",function(t){void 0!==t&&(u.componentPagination=new O({}),u.componentPagination.reset(),u.moreComponentRequestProcessing=!1,u.addMoreComponentItems())},!0),this.init=function(){c.getCustomization({code:u.selectedCustomizationCode}).then(function(t){u.$scope.selectedCustomization=t,u.$scope.selectedVariation=t.variations.filter(function(t){return t.code===u.selectedVariationCode})[0]},function(){d.sendError(i("translate")("personalization.error.gettingcustomization"))}),u.editEnabled&&u.getAndSetComponentById(u.componentUuid),u.initNewComponentTypes(),u.getAndSetColorAndLetter()}}return PersonalizationsmarteditContextMenuAddEditActionController.$inject=["$scope","$filter","$q","$timeout","modalManager","editorModalService","personalizationsmarteditContextService","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","slotRestrictionsService","PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING"],PersonalizationsmarteditContextMenuAddEditActionController}()},gt=function(){function PersonalizationsmarteditContextMenuServiceProxy(t,e,i,n,a,o,s,r,l,c){this.modalService=t,this.renderService=e,this.editorModalService=i,this.personalizationsmarteditContextService=n,this.personalizationsmarteditRestService=a,this.personalizationsmarteditMessageHandler=o,this.lodash=s,this.$filter=r,this.MODAL_BUTTON_ACTIONS=l,this.MODAL_BUTTON_STYLES=c,this.modalButtons=[{id:"cancel",label:"personalization.modal.addeditaction.button.cancel",style:this.MODAL_BUTTON_STYLES.SECONDARY,action:this.MODAL_BUTTON_ACTIONS.DISMISS},{id:"submit",label:"personalization.modal.addeditaction.button.submit",action:this.MODAL_BUTTON_ACTIONS.CLOSE}],this.confirmModalButtons=[{id:"confirmCancel",label:"personalization.modal.deleteaction.button.cancel",style:this.MODAL_BUTTON_STYLES.SECONDARY,action:this.MODAL_BUTTON_ACTIONS.DISMISS},{id:"confirmOk",label:"personalization.modal.deleteaction.button.ok",action:this.MODAL_BUTTON_ACTIONS.CLOSE}]}return PersonalizationsmarteditContextMenuServiceProxy.$inject=["modalService","renderService","editorModalService","personalizationsmarteditContextService","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","lodash","$filter","MODAL_BUTTON_ACTIONS","MODAL_BUTTON_STYLES"],PersonalizationsmarteditContextMenuServiceProxy.prototype.openDeleteAction=function(t){var e=this;this.modalService.open({size:"md",title:"personalization.modal.deleteaction.title",templateInline:'<div id="confirmationModalDescription">{{ "personalization.modal.deleteaction.content" | translate }}</div>',controller:function(t){return function(){function PersonalizationsmarteditContextMenuDeleteActionController(e,i,n){var a=this;this.$q=e,this.modalManager=i,this.personalizationsmarteditRestService=n,this.catalog=t.catalog,this.catalogVersion=t.catalogVersion,this.selectedCustomizationCode=t.selectedCustomizationCode,this.selectedVariationCode=t.selectedVariationCode,this.actionId=t.actionId,this.buttonHandlerFn=function(t){var e=a.$q.defer();if("confirmOk"===t){var i={catalog:a.catalog,catalogVersion:a.catalogVersion};return a.personalizationsmarteditRestService.deleteAction(a.selectedCustomizationCode,a.selectedVariationCode,a.actionId,i)}return e.reject()},this.modalManager.setButtonHandler(this.buttonHandlerFn)}return PersonalizationsmarteditContextMenuDeleteActionController.$inject=["$q","modalManager","personalizationsmarteditRestService"],PersonalizationsmarteditContextMenuDeleteActionController}()}(t),cssClasses:"yFrontModal",buttons:this.confirmModalButtons}).then(function(){if(e.personalizationsmarteditContextService.getCombinedView().enabled)e.personalizationsmarteditRestService.getActions(t.selectedCustomizationCode,t.selectedVariationCode,t).then(function(i){var n=e.personalizationsmarteditContextService.getCombinedView();n.customize.selectedComponents&&n.customize.selectedComponents.splice(n.customize.selectedComponents.indexOf(t.containerSourceId),1),e.lodash.forEach(n.selectedItems,function(e){e.customization.code===t.selectedCustomizationCode&&e.variation.code===t.selectedVariationCode&&(e.variation.actions=i.actions)}),e.personalizationsmarteditContextService.setCombinedView(n)},function(){e.personalizationsmarteditMessageHandler.sendError(e.$filter("translate")("personalization.error.gettingactions"))});else{var i=e.personalizationsmarteditContextService.getCustomize();i.selectedComponents.splice(i.selectedComponents.indexOf(t.containerSourceId),1),e.personalizationsmarteditContextService.setCustomize(i)}e.renderService.renderSlots(t.slotsToRefresh)})},PersonalizationsmarteditContextMenuServiceProxy.prototype.openAddAction=function(t){var e=this;t.editEnabled=!1,this.modalService.open({title:"personalization.modal.addaction.title",templateUrl:"personalizationsmarteditAddEditActionTemplate.html",controller:ut(t),cssClasses:"yPersonalizationContextModal",buttons:this.modalButtons}).then(function(i){if(e.personalizationsmarteditContextService.getCombinedView().enabled){var n=e.personalizationsmarteditContextService.getCombinedView();n.customize.selectedComponents.push(i),e.personalizationsmarteditContextService.setCombinedView(n)}else{var a=e.personalizationsmarteditContextService.getCustomize();a.selectedComponents.push(i),e.personalizationsmarteditContextService.setCustomize(a)}e.renderService.renderSlots(t.slotsToRefresh)},function(){})},PersonalizationsmarteditContextMenuServiceProxy.prototype.openEditAction=function(t){var e=this;t.editEnabled=!0,this.modalService.open({title:"personalization.modal.editaction.title",templateUrl:"personalizationsmarteditAddEditActionTemplate.html",controller:ut(t),cssClasses:"yPersonalizationContextModal",buttons:this.modalButtons}).then(function(){e.renderService.renderSlots(t.slotsToRefresh)})},PersonalizationsmarteditContextMenuServiceProxy.prototype.openEditComponentAction=function(t){this.editorModalService.open(t)},PersonalizationsmarteditContextMenuServiceProxy=n.__decorate([Object(o.GatewayProxied)("openDeleteAction","openAddAction","openEditAction","openEditComponentAction"),Object(o.SeInjectable)()],PersonalizationsmarteditContextMenuServiceProxy)}(),ht=function(){function PersonalizationsmarteditContextMenuModule(){}return PersonalizationsmarteditContextMenuModule=n.__decorate([Object(o.SeModule)({imports:[k,V,dt,"ui.select","genericEditorModule","cmsSmarteditServicesModule","smarteditRootModule","renderServiceModule","slotRestrictionsServiceModule","modalServiceModule"],providers:[gt]})],PersonalizationsmarteditContextMenuModule)}(),Ct=function(){function PersonalizationsmarteditCombinedViewConfigureController(t,e,i,n,a,o,s,r,l,c,d,m){var p=this;this.$filter=t,this.customizationDataFactory=e,this.personalizationsmarteditContextService=i,this.personalizationsmarteditMessageHandler=n,this.personalizationsmarteditUtils=a,this.componentMenuService=o,this.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER=s,this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES=r,this.$scope=l,this.$q=c,this.lodash=d,this.modalManager=m,this.getCustomizations=function(t){var e={filter:t,dataArrayName:"customizations"};p.customizationDataFactory.updateData(e,p.successCallback,p.errorCallback)},this.addMoreItems=function(){p.pagination.getPage()<p.pagination.getTotalPages()-1&&!p.moreCustomizationsRequestProcessing&&(p.moreCustomizationsRequestProcessing=!0,p.getCustomizations(p.getCustomizationsFilterObject()))},this.selectElement=function(t){t&&(p.$scope.selectedItems.push(t),p.componentMenuService.getValidContentCatalogVersions().then(function(t){var e=t.map(function(t){return t.id});p.$scope.selectedItems.sort(function(t,i){var n=t.customization.catalog+"/"+t.customization.catalogVersion,a=i.customization.catalog+"/"+i.customization.catalogVersion;return n===a?t.customization.rank-i.customization.rank:e.indexOf(a)-e.indexOf(n)})}),p.$scope.selectedElement=null,p.searchInputKeypress(null,""))},this.initUiSelect=function(t){t.isActive=function(){return!1}},this.removeSelectedItem=function(t){p.$scope.selectedItems.splice(p.$scope.selectedItems.indexOf(t),1),p.$scope.selectedElement=null,p.searchInputKeypress(null,"")},this.getClassForElement=function(t){return p.personalizationsmarteditUtils.getClassForElement(t)},this.getLetterForElement=function(t){return p.personalizationsmarteditUtils.getLetterForElement(t)},this.isItemInSelectDisabled=function(t){return p.$scope.selectedItems.find(function(e){return e.customization.code===t.customization.code})},this.isItemSelected=function(t){return p.$scope.selectedItems.find(function(e){return e.customization.code===t.customization.code&&e.variation.code===t.variation.code})},this.searchInputKeypress=function(t,e){t&&[37,38,39,40].indexOf(t.which)>-1||(p.pagination.reset(),p.customizationFilter.name=e,p.customizationDataFactory.resetData(),p.addMoreItems())},this.buttonHandlerFn=function(t){var e=p.$q.defer();if("confirmOk"===t){var i=p.personalizationsmarteditContextService.getCombinedView();return i.selectedItems=p.$scope.selectedItems,i.enabled&&null!==i.customize.selectedVariations&&p.isCombinedViewContextPersRemoved(i)&&(i.customize.selectedCustomization=null,i.customize.selectedVariations=null,i.customize.selectedComponents=null),p.personalizationsmarteditContextService.setCombinedView(i),e.resolve()}return e.reject()},this.pageFilterChange=function(t){p.customizationPageFilter=t,p.pagination.reset(),p.customizationDataFactory.resetData(),p.addMoreItems()},this.catalogFilterChange=function(t){p.$scope.catalogFilter=t,p.pagination.reset(),p.customizationDataFactory.resetData(),p.addMoreItems()},this.isItemFromCurrentCatalog=function(t){return p.personalizationsmarteditUtils.isItemFromCurrentCatalog(t,p.personalizationsmarteditContextService.getSeData())},this.getAndSetCatalogVersionNameL10N=function(t){return p.personalizationsmarteditUtils.getAndSetCatalogVersionNameL10N(t)},this.successCallback=function(t){p.pagination=new O(t.pagination),p.$scope.selectionArray.length=0,p.customizationDataFactory.items.forEach(function(t){t.variations.filter(function(t){return p.personalizationsmarteditUtils.isItemVisible(t)}).forEach(function(e){p.$scope.selectionArray.push({customization:{code:t.code,name:t.name,rank:t.rank,catalog:t.catalog,catalogVersion:t.catalogVersion},variation:{code:e.code,name:e.name,catalog:e.catalog,catalogVersion:e.catalogVersion}})})}),p.moreCustomizationsRequestProcessing=!1},this.errorCallback=function(){p.personalizationsmarteditMessageHandler.sendError(p.$filter("translate")("personalization.error.gettingcustomizations")),p.moreCustomizationsRequestProcessing=!1},this.init=function(){p.$scope.selectionArray=[],p.customizationDataFactory.resetData(),p.pagination=new O({}),p.pagination.reset(),p.combinedView=p.personalizationsmarteditContextService.getCombinedView(),p.$scope.selectedItems=[],p.$scope.selectedItems=p.lodash.cloneDeep(p.combinedView.selectedItems||[]),p.$scope.selectedElement={},p.moreCustomizationsRequestProcessing=!1,p.customizationFilter={name:""},p.modalManager.setButtonHandler(p.buttonHandlerFn),p.$scope.$watch("selectedItems",function(t,e){if(p.modalManager.disableButton("confirmOk"),t!==e){var i=p.personalizationsmarteditContextService.getCombinedView(),n=0===(i.selectedItems||[]).length&&0===p.$scope.selectedItems.length;(n=n||p.lodash.isEqual(i.selectedItems,p.$scope.selectedItems))||p.modalManager.enableButton("confirmOk")}},!0)}}return PersonalizationsmarteditCombinedViewConfigureController.$inject=["$filter","customizationDataFactory","personalizationsmarteditContextService","personalizationsmarteditMessageHandler","personalizationsmarteditUtils","componentMenuService","PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER","PERSONALIZATION_VIEW_STATUS_MAPPING_CODES","$scope","$q","lodash","modalManager"],PersonalizationsmarteditCombinedViewConfigureController.prototype.getDefaultStatus=function(){var t=this;return this.personalizationsmarteditUtils.getStatusesMapping().filter(function(e){return e.code===t.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.ALL})[0]},PersonalizationsmarteditCombinedViewConfigureController.prototype.getCustomizationsFilterObject=function(){var t={currentSize:this.pagination.getCount(),currentPage:this.pagination.getPage()+1,name:this.customizationFilter.name,statuses:this.getDefaultStatus().modelStatuses,catalogs:this.$scope.catalogFilter};return this.customizationPageFilter===this.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ONLY_THIS_PAGE&&(t.pageId=this.personalizationsmarteditContextService.getSeData().pageId,t.pageCatalogId=this.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext.catalogId),t},PersonalizationsmarteditCombinedViewConfigureController.prototype.isCombinedViewContextPersRemoved=function(t){return 0===t.selectedItems.filter(function(e){return e.customization.code===t.customize.selectedCustomization.code&&e.variation.code===t.customize.selectedVariations.code}).length},PersonalizationsmarteditCombinedViewConfigureController=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditCombinedViewConfigureController)}(),zt=function(){function PersonalizationsmarteditCombinedViewCommonsService(t,e,i,n,a,o,s,r,l){var c=this;this.$q=t,this.personalizationsmarteditContextUtils=e,this.personalizationsmarteditContextService=i,this.personalizationsmarteditPreviewService=n,this.personalizationsmarteditUtils=a,this.personalizationsmarteditRestService=o,this.modalService=s,this.MODAL_BUTTON_ACTIONS=r,this.MODAL_BUTTON_STYLES=l,this.openManagerAction=function(){c.modalService.open({title:"personalization.modal.combinedview.title",templateUrl:"personalizationsmarteditCombinedViewConfigureTemplate.html",controller:Ct,buttons:[{id:"confirmCancel",label:"personalization.modal.combinedview.button.cancel",style:c.MODAL_BUTTON_STYLES.SECONDARY,action:c.MODAL_BUTTON_ACTIONS.DISMISS},{id:"confirmOk",label:"personalization.modal.combinedview.button.ok",action:c.MODAL_BUTTON_ACTIONS.CLOSE}]}).then(function(){c.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(c.personalizationsmarteditContextService);var t=c.personalizationsmarteditContextService.getCombinedView();t.enabled=t.selectedItems&&t.selectedItems.length>0,c.personalizationsmarteditContextService.setCombinedView(t),c.updatePreview(c.getVariationsForPreviewTicket())},function(){})}}return PersonalizationsmarteditCombinedViewCommonsService.$inject=["$q","personalizationsmarteditContextUtils","personalizationsmarteditContextService","personalizationsmarteditPreviewService","personalizationsmarteditUtils","personalizationsmarteditRestService","modalService","MODAL_BUTTON_ACTIONS","MODAL_BUTTON_STYLES"],PersonalizationsmarteditCombinedViewCommonsService.prototype.updatePreview=function(t){this.personalizationsmarteditPreviewService.updatePreviewTicketWithVariations(t),this.updateActionsOnSelectedVariations()},PersonalizationsmarteditCombinedViewCommonsService.prototype.getVariationsForPreviewTicket=function(){var t=[];return(this.personalizationsmarteditContextService.getCombinedView().selectedItems||[]).forEach(function(e){t.push({customizationCode:e.customization.code,variationCode:e.variation.code,catalog:e.variation.catalog,catalogVersion:e.variation.catalogVersion})}),t},PersonalizationsmarteditCombinedViewCommonsService.prototype.combinedViewEnabledEvent=function(t){var e=this.personalizationsmarteditContextService.getCombinedView();e.enabled=t,this.personalizationsmarteditContextService.setCombinedView(e);var i=this.personalizationsmarteditContextService.getCustomize();i.selectedCustomization=null,i.selectedVariations=null,i.selectedComponents=null,this.personalizationsmarteditContextService.setCustomize(i),t?this.updatePreview(this.getVariationsForPreviewTicket()):this.updatePreview([])},PersonalizationsmarteditCombinedViewCommonsService.prototype.isItemFromCurrentCatalog=function(t){return this.personalizationsmarteditUtils.isItemFromCurrentCatalog(t,this.personalizationsmarteditContextService.getSeData())},PersonalizationsmarteditCombinedViewCommonsService.prototype.updateActionsOnSelectedVariations=function(){var t=this,e=this.personalizationsmarteditContextService.getCombinedView(),i=[];(e.selectedItems||[]).forEach(function(e){i.push(t.personalizationsmarteditRestService.getActions(e.customization.code,e.variation.code,e.variation).then(function(t){e.variation.actions=t.actions}))}),this.$q.all(i).then(function(){t.personalizationsmarteditContextService.setCombinedView(e)})},PersonalizationsmarteditCombinedViewCommonsService=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditCombinedViewCommonsService)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditCombinedViewMenuComponent",{templateUrl:"personalizationsmarteditCombinedViewMenuTemplate.html",inputs:["isMenuOpen"]});var vt=function(){function PersonalizationsmarteditCombinedViewMenuComponent(t,e,i,n,a,o,s,r,l,c,d,m){this.$filter=t,this.personalizationsmarteditContextService=e,this.personalizationsmarteditMessageHandler=i,this.personalizationsmarteditRestService=n,this.personalizationsmarteditContextUtils=a,this.personalizationsmarteditUtils=o,this.personalizationsmarteditPreviewService=s,this.personalizationsmarteditCombinedViewCommonsService=r,this.crossFrameEventService=l,this.permissionService=c,this.SHOW_TOOLBAR_ITEM_CONTEXT=d,this.COMBINED_VIEW_TOOLBAR_ITEM_KEY=m}return PersonalizationsmarteditCombinedViewMenuComponent.$inject=["$filter","personalizationsmarteditContextService","personalizationsmarteditMessageHandler","personalizationsmarteditRestService","personalizationsmarteditContextUtils","personalizationsmarteditUtils","personalizationsmarteditPreviewService","personalizationsmarteditCombinedViewCommonsService","crossFrameEventService","permissionService","SHOW_TOOLBAR_ITEM_CONTEXT","COMBINED_VIEW_TOOLBAR_ITEM_KEY"],PersonalizationsmarteditCombinedViewMenuComponent.prototype.$onInit=function(){this.combinedView=this.personalizationsmarteditContextService.getCombinedView(),this.selectedItems=this.combinedView.selectedItems||[],this.isCombinedViewConfigured=0!==this.selectedItems.length},PersonalizationsmarteditCombinedViewMenuComponent.prototype.combinedViewClick=function(){this.personalizationsmarteditContextUtils.clearCustomizeContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService),this.personalizationsmarteditCombinedViewCommonsService.openManagerAction()},PersonalizationsmarteditCombinedViewMenuComponent.prototype.getAndSetComponentsForElement=function(t,e,i,n){var a=this;this.personalizationsmarteditRestService.getComponenentsIdsForVariation(t,e,i,n).then(function(t){var e=a.personalizationsmarteditContextService.getCombinedView();e.customize.selectedComponents=t.components,a.personalizationsmarteditContextService.setCombinedView(e)},function(){a.personalizationsmarteditMessageHandler.sendError(a.$filter("translate")("personalization.error.gettingcomponentsforvariation"))})},PersonalizationsmarteditCombinedViewMenuComponent.prototype.itemClick=function(t){var e=this,i=this.personalizationsmarteditContextService.getCombinedView();i.enabled&&(this.selectedItems.forEach(function(t){t.highlighted=!1}),t.highlighted=!0,i.customize.selectedCustomization=t.customization,i.customize.selectedVariations=t.variation,this.personalizationsmarteditContextService.setCombinedView(i),this.permissionService.isPermitted([{names:["se.edit.page"]}]).then(function(i){i&&e.getAndSetComponentsForElement(t.customization.code,t.variation.code,t.customization.catalog,t.customization.catalogVersion)}),this.personalizationsmarteditCombinedViewCommonsService.updatePreview(this.personalizationsmarteditUtils.getVariationKey(t.customization.code,[t.variation])),this.crossFrameEventService.publish(this.SHOW_TOOLBAR_ITEM_CONTEXT,this.COMBINED_VIEW_TOOLBAR_ITEM_KEY))},PersonalizationsmarteditCombinedViewMenuComponent.prototype.getClassForElement=function(t){return this.personalizationsmarteditUtils.getClassForElement(t)},PersonalizationsmarteditCombinedViewMenuComponent.prototype.getLetterForElement=function(t){return this.personalizationsmarteditUtils.getLetterForElement(t)},PersonalizationsmarteditCombinedViewMenuComponent.prototype.isItemFromCurrentCatalog=function(t){return this.personalizationsmarteditCombinedViewCommonsService.isItemFromCurrentCatalog(t)},PersonalizationsmarteditCombinedViewMenuComponent.prototype.clearAllCombinedViewClick=function(){this.selectedItems=[],this.combinedView.selectedItems=[],this.combinedView.enabled=!1,this.personalizationsmarteditContextService.setCombinedView(this.combinedView),this.personalizationsmarteditCombinedViewCommonsService.combinedViewEnabledEvent(this.combinedView.enabled)},PersonalizationsmarteditCombinedViewMenuComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"personalizationsmarteditCombinedViewMenuTemplate.html",inputs:["isMenuOpen"]})],PersonalizationsmarteditCombinedViewMenuComponent)}(),ft=function(){function PersonalizationsmarteditCombinedViewModule(){}return PersonalizationsmarteditCombinedViewModule=n.__decorate([Object(o.SeModule)({imports:["seConstantsModule","personalizationsmarteditManageCustomizationViewModule","smarteditCommonsModule","modalServiceModule",dt,V,k,pt],providers:[zt],declarations:[vt]})],PersonalizationsmarteditCombinedViewModule)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditCustomizeToolbarContextComponent",{templateUrl:"personalizationsmarteditToolbarContextTemplate.html"});var St=function(){function PersonalizationsmarteditCustomizeToolbarContextComponent(t,e,i,n,a,o,s,r){this.$scope=t,this.personalizationsmarteditContextService=e,this.personalizationsmarteditContextUtils=i,this.personalizationsmarteditPreviewService=n,this.crossFrameEventService=a,this.SHOW_TOOLBAR_ITEM_CONTEXT=o,this.HIDE_TOOLBAR_ITEM_CONTEXT=s,this.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY=r}return PersonalizationsmarteditCustomizeToolbarContextComponent.$inject=["$scope","personalizationsmarteditContextService","personalizationsmarteditContextUtils","personalizationsmarteditPreviewService","crossFrameEventService","SHOW_TOOLBAR_ITEM_CONTEXT","HIDE_TOOLBAR_ITEM_CONTEXT","CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY"],PersonalizationsmarteditCustomizeToolbarContextComponent.prototype.$onInit=function(){var t=this;this.selectedCustomization=a.copy(this.personalizationsmarteditContextService.getCustomize().selectedCustomization),this.selectedVariations=a.copy(this.personalizationsmarteditContextService.getCustomize().selectedVariations),this.visible=!1,this.selectedCustomization&&(this.title=this.personalizationsmarteditContextService.getCustomize().selectedCustomization.name,this.visible=!0,a.isArray(this.selectedVariations)||(this.subtitle=this.selectedVariations.name)),this.$scope.$watch(function(){return t.personalizationsmarteditContextService.getCustomize().selectedCustomization},function(e,i){e&&e!==i?(t.title=e.name,t.visible=!0,t.crossFrameEventService.publish(t.SHOW_TOOLBAR_ITEM_CONTEXT,t.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)):e||(t.visible=!1,t.crossFrameEventService.publish(t.HIDE_TOOLBAR_ITEM_CONTEXT,t.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY))}),this.$scope.$watch(function(){return t.personalizationsmarteditContextService.getCustomize().selectedVariations},function(e,i){e&&e!==i&&(t.subtitle=e.name)})},PersonalizationsmarteditCustomizeToolbarContextComponent.prototype.clear=function(){this.personalizationsmarteditContextUtils.clearCustomizeContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService),this.crossFrameEventService.publish(this.HIDE_TOOLBAR_ITEM_CONTEXT,this.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)},PersonalizationsmarteditCustomizeToolbarContextComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"personalizationsmarteditToolbarContextTemplate.html"})],PersonalizationsmarteditCustomizeToolbarContextComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditCombinedViewToolbarContextComponent",{templateUrl:"personalizationsmarteditToolbarContextTemplate.html"});var _t=function(){function PersonalizationsmarteditCombinedViewToolbarContextComponent(t,e,i,n,a,o,s,r){this.$scope=t,this.personalizationsmarteditCombinedViewCommonsService=e,this.personalizationsmarteditContextService=i,this.personalizationsmarteditContextUtils=n,this.crossFrameEventService=a,this.SHOW_TOOLBAR_ITEM_CONTEXT=o,this.HIDE_TOOLBAR_ITEM_CONTEXT=s,this.COMBINED_VIEW_TOOLBAR_ITEM_KEY=r}return PersonalizationsmarteditCombinedViewToolbarContextComponent.$inject=["$scope","personalizationsmarteditCombinedViewCommonsService","personalizationsmarteditContextService","personalizationsmarteditContextUtils","crossFrameEventService","SHOW_TOOLBAR_ITEM_CONTEXT","HIDE_TOOLBAR_ITEM_CONTEXT","COMBINED_VIEW_TOOLBAR_ITEM_KEY"],PersonalizationsmarteditCombinedViewToolbarContextComponent.prototype.$onInit=function(){var t=this;this.selectedCustomization=a.copy(this.personalizationsmarteditContextService.getCombinedView().customize.selectedCustomization),this.visible=!1,this.selectedCustomization&&(this.title=this.personalizationsmarteditContextService.getCombinedView().customize.selectedCustomization.name,this.subtitle=this.personalizationsmarteditContextService.getCombinedView().customize.selectedVariations.name,this.visible=!0),this.$scope.$watch(function(){return t.personalizationsmarteditContextService.getCombinedView().customize.selectedCustomization},function(e,i){e&&e!==i?(t.title=e.name,t.subtitle=t.personalizationsmarteditContextService.getCombinedView().customize.selectedVariations.name,t.visible=!0,t.crossFrameEventService.publish(t.SHOW_TOOLBAR_ITEM_CONTEXT,t.COMBINED_VIEW_TOOLBAR_ITEM_KEY)):e||(t.visible=!1,t.crossFrameEventService.publish(t.HIDE_TOOLBAR_ITEM_CONTEXT,t.COMBINED_VIEW_TOOLBAR_ITEM_KEY))}),this.$scope.$watch(function(){return t.personalizationsmarteditContextService.getCombinedView().enabled},function(e,i){!1===e&&e!==i&&t.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(t.personalizationsmarteditContextService)})},PersonalizationsmarteditCombinedViewToolbarContextComponent.prototype.clear=function(){this.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(this.personalizationsmarteditContextService);var t=[];(this.personalizationsmarteditContextService.getCombinedView().selectedItems||[]).forEach(function(e){t.push({customizationCode:e.customization.code,variationCode:e.variation.code,catalog:e.variation.catalog,catalogVersion:e.variation.catalogVersion})}),this.personalizationsmarteditCombinedViewCommonsService.updatePreview(t),this.crossFrameEventService.publish(this.HIDE_TOOLBAR_ITEM_CONTEXT,this.COMBINED_VIEW_TOOLBAR_ITEM_KEY)},PersonalizationsmarteditCombinedViewToolbarContextComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"personalizationsmarteditToolbarContextTemplate.html"})],PersonalizationsmarteditCombinedViewToolbarContextComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditManageCustomizationViewMenuComponent",{templateUrl:"manageCustomizationViewMenuTemplate.html"});var Tt=function(){function PersonalizationsmarteditManageCustomizationViewMenuComponent(t,e,i,n,a){this.personalizationsmarteditContextService=t,this.personalizationsmarteditContextUtils=e,this.personalizationsmarteditPreviewService=i,this.personalizationsmarteditManager=n,this.personalizationsmarteditManagerView=a}return PersonalizationsmarteditManageCustomizationViewMenuComponent.$inject=["personalizationsmarteditContextService","personalizationsmarteditContextUtils","personalizationsmarteditPreviewService","personalizationsmarteditManager","personalizationsmarteditManagerView"],PersonalizationsmarteditManageCustomizationViewMenuComponent.prototype.createCustomizationClick=function(){this.personalizationsmarteditManager.openCreateCustomizationModal()},PersonalizationsmarteditManageCustomizationViewMenuComponent.prototype.managerViewClick=function(){this.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(this.personalizationsmarteditContextService),this.personalizationsmarteditContextUtils.clearCustomizeContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService),this.personalizationsmarteditContextUtils.clearCombinedViewContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService),this.personalizationsmarteditManagerView.openManagerAction()},PersonalizationsmarteditManageCustomizationViewMenuComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"manageCustomizationViewMenuTemplate.html"})],PersonalizationsmarteditManageCustomizationViewMenuComponent)}(),bt=function(){function PersonalizationsmarteditToolbarContextModule(){}return PersonalizationsmarteditToolbarContextModule=n.__decorate([Object(o.SeModule)({imports:[V],declarations:[St,_t,Tt]})],PersonalizationsmarteditToolbarContextModule)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditSegmentExpressionAsHtmlComponent",{templateUrl:"personalizationsmarteditSegmentExpressionAsHtmlTemplate.html",inputs:["segmentExpression"]});var At=function(){function PersonalizationsmarteditSegmentExpressionAsHtmlComponent(t){this.personalizationsmarteditTriggerService=t,this._segmentExpression={},this._operators=["AND","OR","NOT"],this._emptyGroup="[]",this._emptyGroupAndOperators=this.operators.concat(this.emptyGroup)}return PersonalizationsmarteditSegmentExpressionAsHtmlComponent.$inject=["personalizationsmarteditTriggerService"],Object.defineProperty(PersonalizationsmarteditSegmentExpressionAsHtmlComponent.prototype,"segmentExpression",{get:function(){return this._segmentExpression},set:function(t){this._segmentExpression=t},enumerable:!0,configurable:!0}),Object.defineProperty(PersonalizationsmarteditSegmentExpressionAsHtmlComponent.prototype,"operators",{get:function(){return this._operators},enumerable:!0,configurable:!0}),Object.defineProperty(PersonalizationsmarteditSegmentExpressionAsHtmlComponent.prototype,"emptyGroup",{get:function(){return this._emptyGroup},enumerable:!0,configurable:!0}),Object.defineProperty(PersonalizationsmarteditSegmentExpressionAsHtmlComponent.prototype,"emptyGroupAndOperators",{get:function(){return this._emptyGroupAndOperators},enumerable:!0,configurable:!0}),PersonalizationsmarteditSegmentExpressionAsHtmlComponent.prototype.getExpressionAsArray=function(){return a.isDefined(this.segmentExpression)&&!a.isDefined(this.segmentExpression.operation)&&(this.segmentExpression=this.personalizationsmarteditTriggerService.buildData(this.segmentExpression)[0]),this.personalizationsmarteditTriggerService.getExpressionAsString(this.segmentExpression).split(" ")},PersonalizationsmarteditSegmentExpressionAsHtmlComponent.prototype.getLocalizationKeyForOperator=function(t){return"personalization.modal.customizationvariationmanagement.targetgrouptab.expression."+t.toLowerCase()},PersonalizationsmarteditSegmentExpressionAsHtmlComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"personalizationsmarteditSegmentExpressionAsHtmlTemplate.html",inputs:["segmentExpression"]})],PersonalizationsmarteditSegmentExpressionAsHtmlComponent)}();window.__smartedit__.addDecoratorPayload("SeComponent","PersonalizationsmarteditSegmentViewComponent",{templateUrl:"personalizationsmarteditSegmentViewTemplate.html",inputs:["triggers","expression"]});var Et=function(){function PersonalizationsmarteditSegmentViewComponent(t,e,i,n,a,o,s){var r=this;this.personalizationsmarteditRestService=t,this.personalizationsmarteditMessageHandler=e,this.personalizationsmarteditTriggerService=i,this.$timeout=n,this.$filter=a,this.confirmationModalService=o,this.triggerTabService=s,this.actions=this.personalizationsmarteditTriggerService.actions,this.segments=[],this.segmentPagination=new O({}),this.treeOptions={dragStart:function(){r.scrollZoneVisible=r.isScrollZoneVisible()},dropped:function(t){r.scrollZoneVisible=!1,r.removeDropzoneItem(t.dest.nodesScope.$modelValue),r.$timeout(function(){r.fixEmptyContainer(r.expression)},0)},dragMove:function(t){r.highlightedContainer=t.dest.nodesScope.$nodeScope.$modelValue.$$hashKey,r.isScrollZoneVisible()!==r.scrollZoneVisible?r.scrollZoneVisible=r.isScrollZoneVisible():Math.abs(r.elementToScrollHeight-r.elementToScroll.get(0).scrollHeight)>10&&(r.elementToScrollHeight=r.elementToScroll.get(0).scrollHeight,r.scrollZoneVisible=!1)}},this.moreSegmentRequestProcessing=!1,this.dropzoneItem={type:"dropzone"},this.initExpression=[{type:"container",operation:this.actions[0],nodes:[this.dropzoneItem]}],this.segmentFilter={code:""},this.elementToDuplicate=null,this._elementToScrollHeight=0,this.segmentPagination.reset()}return PersonalizationsmarteditSegmentViewComponent.$inject=["personalizationsmarteditRestService","personalizationsmarteditMessageHandler","personalizationsmarteditTriggerService","$timeout","$filter","confirmationModalService","triggerTabService"],Object.defineProperty(PersonalizationsmarteditSegmentViewComponent.prototype,"elementToScrollHeight",{get:function(){return this._elementToScrollHeight},set:function(t){this._elementToScrollHeight=t},enumerable:!0,configurable:!0}),PersonalizationsmarteditSegmentViewComponent.prototype.$onInit=function(){var t=this.triggerTabService.getTriggerDataState();this.triggers=this.triggers||(t.selectedVariation||{}).triggers,this.expression=this.expression||t.expression,this.triggers&&this.triggers.length>0?this.expression=this.personalizationsmarteditTriggerService.buildData(this.triggers):this.expression=a.copy(this.initExpression),t.expression=this.expression,this.elementToScroll=a.element(".se-slider-panel__body")},PersonalizationsmarteditSegmentViewComponent.prototype.getElementToScroll=function(){return this.elementToScroll},PersonalizationsmarteditSegmentViewComponent.prototype.removeItem=function(t){var e=this;this.personalizationsmarteditTriggerService.isNotEmptyContainer(t.$modelValue)&&!this.isContainerWithDropzone(t.$modelValue)?this.confirmationModalService.confirm({description:this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.segments.removecontainerconfirmation")}).then(function(){t.remove(),e.$timeout(function(){e.fixEmptyContainer(e.expression)},0)}):(t.remove(),this.$timeout(function(){e.fixEmptyContainer(e.expression)},0))},PersonalizationsmarteditSegmentViewComponent.prototype.duplicateItem=function(t){this.elementToDuplicate=t,this.expression[0].nodes.some(this.findElementAndDuplicate,this)},PersonalizationsmarteditSegmentViewComponent.prototype.toggle=function(t){t.toggle()},PersonalizationsmarteditSegmentViewComponent.prototype.newSubItem=function(t,e){var i=t.$modelValue;this.removeDropzoneItem(i.nodes),i.nodes.unshift({type:e,operation:"item"===e?"":this.actions[0],nodes:[this.dropzoneItem]}),t.expand(),this.$timeout(function(){t.childNodes()[0].expand()},0)},PersonalizationsmarteditSegmentViewComponent.prototype.segmentSearchInputKeypress=function(t,e){t&&[37,38,39,40].indexOf(t.which)>-1||(this.segmentPagination.reset(),this.segmentFilter.code=e,this.segments.length=0,this.addMoreSegmentItems())},PersonalizationsmarteditSegmentViewComponent.prototype.segmentSelectedEvent=function(t){t&&(this.expression[0].nodes.unshift({type:"item",operation:"",selectedSegment:t,nodes:[]}),this.singleSegment=null,this.highlightedContainer=this.expression[0].$$hashKey,this.removeDropzoneItem(this.expression[0].nodes))},PersonalizationsmarteditSegmentViewComponent.prototype.addMoreSegmentItems=function(){var t=this;this.segmentPagination.getPage()<this.segmentPagination.getTotalPages()-1&&!this.moreSegmentRequestProcessing&&(this.moreSegmentRequestProcessing=!0,this.personalizationsmarteditRestService.getSegments(this.getSegmentsFilterObject()).then(function(e){Array.prototype.push.apply(t.segments,e.segments),t.segmentPagination=new O(e.pagination),t.moreSegmentRequestProcessing=!1},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.gettingsegments")),t.moreSegmentRequestProcessing=!1}))},PersonalizationsmarteditSegmentViewComponent.prototype.isTopContainer=function(t){return a.equals(this.expression[0],t.node)},PersonalizationsmarteditSegmentViewComponent.prototype.isContainerWithDropzone=function(t){return this.isContainer(t)&&1===t.nodes.length&&this.isDropzone(t.nodes[0])},PersonalizationsmarteditSegmentViewComponent.prototype.isItem=function(t){return this.personalizationsmarteditTriggerService.isItem(t)},PersonalizationsmarteditSegmentViewComponent.prototype.isDropzone=function(t){return this.personalizationsmarteditTriggerService.isDropzone(t)},PersonalizationsmarteditSegmentViewComponent.prototype.isContainer=function(t){return this.personalizationsmarteditTriggerService.isContainer(t)},PersonalizationsmarteditSegmentViewComponent.prototype.getSegmentsFilterObject=function(){return{code:this.segmentFilter.code,pageSize:this.segmentPagination.getCount(),currentPage:this.segmentPagination.getPage()+1}},PersonalizationsmarteditSegmentViewComponent.prototype.findElementAndDuplicate=function(t,e,i){return this.elementToDuplicate===t?(i.splice(e,0,a.copy(this.elementToDuplicate)),!0):(this.isContainer(t)&&t.nodes.some(this.findElementAndDuplicate,this),!1)},PersonalizationsmarteditSegmentViewComponent.prototype.removeDropzoneItem=function(t){var e=this;t.forEach(function(t,i,n){e.isDropzone(t)&&n.splice(i,1)})},PersonalizationsmarteditSegmentViewComponent.prototype.fixEmptyContainer=function(t){var e=this;t.forEach(function(t){e.isEmptyContainer(t)&&t.nodes.push(e.dropzoneItem),e.isContainer(t)&&e.fixEmptyContainer(t.nodes)})},PersonalizationsmarteditSegmentViewComponent.prototype.isScrollZoneVisible=function(){return this.elementToScroll.get(0).scrollHeight>this.elementToScroll.get(0).clientHeight},PersonalizationsmarteditSegmentViewComponent.prototype.isEmptyContainer=function(t){return this.isContainer(t)&&0===t.nodes.length},PersonalizationsmarteditSegmentViewComponent=n.__decorate([Object(o.SeComponent)({templateUrl:"personalizationsmarteditSegmentViewTemplate.html",inputs:["triggers","expression"]})],PersonalizationsmarteditSegmentViewComponent)}(),Ot=function(t,e){return function(){function PersonalizationsmarteditCommerceCustomizationViewController(i,n,a,o,s,r,l,c,d,m,p,u,g,h){var C=this;this.$scope=i,this.$filter=n,this.$q=a,this.actionsDataFactory=o,this.personalizationsmarteditRestService=s,this.personalizationsmarteditMessageHandler=r,this.systemEventService=l,this.personalizationsmarteditCommerceCustomizationService=c,this.personalizationsmarteditContextService=d,this.personalizationsmarteditUtils=m,this.confirmationModalService=p,this.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES=u,this.modalManager=g,this.$log=h,this.availableTypes=[],this.select={},this.isItemInSelectedActions=function(t,e){return C.actionsDataFactory.isItemInSelectedActions(t,e)},this.removeSelectedAction=function(t){var e=C.$scope.actions.indexOf(t);if(!(e<0)){var i=C.$scope.actions.splice(e,1);i[0].status!==C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.OLD&&i[0].status!==C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.UPDATE||(i[0].status=C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.DELETE,C.removedActions.push(i[0]))}},this.addAction=function(t,e){C.actionsDataFactory.addAction(t,e)},this.displayAction=function(t){var e=t.action,i=C.getType(e.type);return i.getName?i.getName(e):e.code},this.getActionsToDisplay=function(){return C.actionsDataFactory.getActions()},this.populateActions=function(){C.personalizationsmarteditRestService.getActions(C.$scope.customization.code,C.$scope.variation.code,{}).then(function(t){var e=t.actions.filter(function(t){return"cxCmsActionData"!==t.type}).map(function(t){return{action:t,status:C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.OLD}});C.actionsDataFactory.resetActions(),Array.prototype.push.apply(C.actionsDataFactory.getActions(),e)},function(){C.personalizationsmarteditMessageHandler.sendError(C.$filter("translate")("personalization.error.gettingactions"))})},this.getType=function(t){for(var e=0,i=C.availableTypes;e<i.length;e++){var n=i[e];if(n.type===t)return n}return{}},this.sendRefreshEvent=function(){C.systemEventService.sendSynchEvent("CUSTOMIZATIONS_MODIFIED",{})},this.dismissModalCallback=function(){return C.isDirty()?C.confirmationModalService.confirm({description:"personalization.modal.commercecustomization.cancelconfirmation"}).then(function(){return C.$q.resolve()},function(){return C.$q.reject()}):C.$q.resolve()},this.isDirty=function(){var t=!1;return C.$scope.actions.forEach(function(e){t=t||e.status===C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.NEW||e.status===C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.UPDATE}),t=t||C.removedActions.length>0},this.onSave=function(){var t={actions:C.$scope.actions.filter(function(t){return t.status===C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.NEW}).map(function(t){return t.action})},e=C.removedActions.filter(function(t){return t.status===C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.DELETE}).map(function(t){return t.action.code}),i={actions:C.$scope.actions.filter(function(t){return t.status===C.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.UPDATE}).map(function(t){return t.action})},n=t.actions.length>0,a=e.length>0,o=i.actions.length>0;(n?C.createActions(C.$scope.customization.code,C.$scope.variation.code,t):C.$q.resolve()).then(function(t){(a?C.deleteActions(C.$scope.customization.code,C.$scope.variation.code,e):C.$q.resolve()).then(function(e){o&&C.updateActions(C.$scope.customization.code,C.$scope.variation.code,i,t,e)})})},this.getActionTypesForActions=function(t){return t.map(function(t){return t.type}).filter(function(t,e,i){return i.indexOf(t)===e}).map(function(t){return C.availableTypes.filter(function(e){return e.type===t})[0]})},this.createActions=function(t,e,i){var n=C.$q.defer();return C.personalizationsmarteditRestService.createActions(t,e,i,{}).then(function(t){C.personalizationsmarteditMessageHandler.sendSuccess(C.$filter("translate")("personalization.info.creatingaction")),C.sendRefreshEvent(),n.resolve(t)},function(){C.personalizationsmarteditMessageHandler.sendError(C.$filter("translate")("personalization.error.creatingaction")),n.reject()}),n.promise},this.deleteActions=function(t,e,i){var n=C.$q.defer();return C.personalizationsmarteditRestService.deleteActions(t,e,i,{}).then(function(t){C.personalizationsmarteditMessageHandler.sendSuccess(C.$filter("translate")("personalization.info.removingaction")),C.sendRefreshEvent(),n.resolve(t)},function(){C.personalizationsmarteditMessageHandler.sendError(C.$filter("translate")("personalization.error.removingaction")),n.resolve()}),n.promise},this.updateActions=function(t,e,i,n,a){C.getActionTypesForActions(i.actions).forEach(function(o){if(o.updateActions){var s=i.actions.filter(function(t){return C.getType(t.type)===o});o.updateActions(t,e,s,n,a).then(function(){C.personalizationsmarteditMessageHandler.sendSuccess(C.$filter("translate")("personalization.info.updatingactions")),C.sendRefreshEvent()},function(){C.personalizationsmarteditMessageHandler.sendError(C.$filter("translate")("personalization.error.updatingactions"))})}else C.$log.debug(C.$filter("translate")("personalization.error.noupdatingactions"))})},this.availableTypes=this.personalizationsmarteditCommerceCustomizationService.getAvailableTypes(this.personalizationsmarteditContextService.getSeData().seConfigurationData),this.select={type:this.availableTypes[0]},this.$scope.customization=t,this.$scope.variation=e,this.actionsDataFactory.resetActions(),this.actionsDataFactory.resetRemovedActions(),this.$scope.actions=this.actionsDataFactory.getActions(),this.removedActions=this.actionsDataFactory.getRemovedActions(),this.customizationStatusText=this.personalizationsmarteditUtils.getEnablementTextForCustomization(this.$scope.customization,"personalization.modal.commercecustomization"),this.variationStatusText=this.personalizationsmarteditUtils.getEnablementTextForVariation(this.$scope.variation,"personalization.modal.commercecustomization"),this.customizationStatus=this.personalizationsmarteditUtils.getActivityStateForCustomization(this.$scope.customization),this.variationStatus=this.personalizationsmarteditUtils.getActivityStateForVariation(this.$scope.customization,this.$scope.variation),this.init=function(){C.$scope.isItemInSelectedActions=C.isItemInSelectedActions,C.$scope.removeSelectedAction=C.removeSelectedAction,C.$scope.addAction=C.addAction,C.populateActions(),C.$scope.$watch("actions",function(){C.isDirty()?C.modalManager.enableButton("confirmSave"):C.modalManager.disableButton("confirmSave")},!0),C.modalManager.setButtonHandler(function(t){if("confirmSave"===t)C.onSave();else if("confirmCancel"===t)return C.dismissModalCallback()}),C.modalManager.setDismissCallback(function(){return C.dismissModalCallback()})}}return PersonalizationsmarteditCommerceCustomizationViewController.$inject=["$scope","$filter","$q","actionsDataFactory","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","systemEventService","personalizationsmarteditCommerceCustomizationService","personalizationsmarteditContextService","personalizationsmarteditUtils","confirmationModalService","PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES","modalManager","$log"],PersonalizationsmarteditCommerceCustomizationViewController}()},It=function(){function PersonalizationsmarteditCommerceCustomizationView(t,e,i){var n=this;this.modalService=t,this.MODAL_BUTTON_ACTIONS=e,this.MODAL_BUTTON_STYLES=i,this.openCommerceCustomizationAction=function(t,e){n.modalService.open({title:"personalization.modal.commercecustomization.title",templateUrl:"personalizationsmarteditCommerceCustomizationViewTemplate.html",controller:Ot(t,e),buttons:[{id:"confirmCancel",label:"personalization.modal.commercecustomization.button.cancel",style:n.MODAL_BUTTON_STYLES.SECONDARY,action:n.MODAL_BUTTON_ACTIONS.CLOSE},{id:"confirmSave",label:"personalization.modal.commercecustomization.button.submit",action:n.MODAL_BUTTON_ACTIONS.CLOSE}]}).then(function(){},function(){})}}return PersonalizationsmarteditCommerceCustomizationView.$inject=["modalService","MODAL_BUTTON_ACTIONS","MODAL_BUTTON_STYLES"],PersonalizationsmarteditCommerceCustomizationView=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditCommerceCustomizationView)}(),yt={provide:"PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES",useValue:{OLD:"old",NEW:"new",DELETE:"delete",UPDATE:"update"}},Pt=function(){function ActionsDataFactory(t){var e=this;this.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES=t,this.actions=[],this.removedActions=[],this.getActions=function(){return e.actions},this.getRemovedActions=function(){return e.removedActions},this.resetActions=function(){e.actions.length=0},this.resetRemovedActions=function(){e.removedActions.length=0},this.addAction=function(t,i){var n=!1;if(e.actions.forEach(function(e){n=n||i(t,e.action)}),!n){var a=e.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.NEW,o=-1;e.removedActions.forEach(function(e,n){i(t,e.action)&&(o=n)}),o>=0&&(a=e.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.OLD,e.removedActions.splice(o,1)),e.actions.push({action:t,status:a})}},this.isItemInSelectedActions=function(t,i){return e.actions.find(function(e){return i(t,e.action)})}}return ActionsDataFactory.$inject=["PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES"],ActionsDataFactory=n.__decorate([Object(o.SeInjectable)()],ActionsDataFactory)}(),wt=function(){function PersonalizationsmarteditCommerceCustomizationModule(){}return PersonalizationsmarteditCommerceCustomizationModule=n.__decorate([Object(o.SeModule)({imports:["modalServiceModule","smarteditCommonsModule","confirmationModalServiceModule",V,k],providers:[It,Pt,yt]})],PersonalizationsmarteditCommerceCustomizationModule)}(),Mt=function(){function PersonalizationsmarteditSegmentViewModule(){}return PersonalizationsmarteditSegmentViewModule=n.__decorate([Object(o.SeModule)({imports:["modalServiceModule","confirmationModalServiceModule","ui.tree",V,k,Q,wt,W],declarations:[Et,At]})],PersonalizationsmarteditSegmentViewModule)}(),Dt=function(){function PersonalizationsmarteditManagerViewController(t,e,i,n,a,o,s,r,l,c,d,m,p,u,g,h,C){var z=this;this.$scope=t,this.$filter=e,this.$q=i,this.lodash=n,this.personalizationsmarteditManagerViewUtilsService=a,this.personalizationsmarteditMessageHandler=o,this.personalizationsmarteditContextService=s,this.personalizationsmarteditUtils=r,this.personalizationsmarteditManager=l,this.personalizationsmarteditCommerceCustomizationService=c,this.personalizationsmarteditCommerceCustomizationView=d,this.personalizationsmarteditDateUtils=m,this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES=p,this.PERSONALIZATION_MODEL_STATUS_CODES=u,this.waitDialogService=g,this.$timeout=h,this.systemEventService=C,this.searchInputKeypress=function(t){(13===t.which||z.search.name.length>2||0===z.search.name.length)&&z.refreshGrid()},this.addMoreItems=function(){z.pagination.getPage()<z.pagination.getTotalPages()-1&&!z.moreCustomizationsRequestProcessing&&(z.moreCustomizationsRequestProcessing=!0,z.getCustomizations(z.getCustomizationsFilterObject()))},this.getElementToScroll=function(){return z.$scope.scrollZoneElement},this.setScrollZoneElement=function(t){z.$scope.scrollZoneElement=t},this.openNewModal=function(){z.personalizationsmarteditManager.openCreateCustomizationModal()},this.isSearchGridHeaderHidden=function(){return z.$scope.scrollZoneElement.scrollTop()>=120},this.scrollZoneReturnToTop=function(){z.$scope.scrollZoneElement.animate({scrollTop:0},500)},this.isReturnToTopButtonVisible=function(){return z.$scope.scrollZoneElement.scrollTop()>50},this.isFilterEnabled=function(){return""!==z.search.name||z.search.status!==z.getDefaultStatus()},this.setCustomizationRank=function(t,e){z.personalizationsmarteditManagerViewUtilsService.setCustomizationRank(t,e,z.customizations)},this.setVariationRank=function(t,e,i){z.personalizationsmarteditManagerViewUtilsService.setVariationRank(t,e,i)},this.refreshGrid=function(){z.pagination.reset(),z.customizations.length=0,z.addMoreItems()},this.editCustomizationAction=function(t){z.personalizationsmarteditManager.openEditCustomizationModal(t.code,null)},this.editVariationAction=function(t,e){z.personalizationsmarteditManager.openEditCustomizationModal(t.code,e.code)},this.deleteCustomizationAction=function(t){z.personalizationsmarteditManagerViewUtilsService.deleteCustomizationAction(t,z.customizations)},this.isCommerceCustomizationEnabled=function(){return z.personalizationsmarteditCommerceCustomizationService.isCommerceCustomizationEnabled(z.personalizationsmarteditContextService.getSeData().seConfigurationData)},this.manageCommerceCustomization=function(t,e){z.personalizationsmarteditCommerceCustomizationView.openCommerceCustomizationAction(t,e)},this.isDeleteVariationEnabled=function(t){return z.personalizationsmarteditUtils.getVisibleItems(t.variations).length>1},this.deleteVariationAction=function(t,e,i){z.isDeleteVariationEnabled(t)?z.personalizationsmarteditManagerViewUtilsService.deleteVariationAction(t,e):i.stopPropagation()},this.toogleVariationActive=function(t,e){z.personalizationsmarteditManagerViewUtilsService.toogleVariationActive(t,e)},this.customizationClickAction=function(t){z.personalizationsmarteditManagerViewUtilsService.customizationClickAction(t)},this.hasCommerceActions=function(t){return z.personalizationsmarteditUtils.hasCommerceActions(t)},this.getCommerceCustomizationTooltip=function(t){return z.personalizationsmarteditUtils.getCommerceCustomizationTooltipHTML(t)},this.getFormattedDate=function(t){return t?z.personalizationsmarteditDateUtils.formatDate(t,null):""},this.getEnablementTextForCustomization=function(t){return z.personalizationsmarteditUtils.getEnablementTextForCustomization(t,"personalization.modal.manager")},this.getEnablementTextForVariation=function(t){return z.personalizationsmarteditUtils.getEnablementTextForVariation(t,"personalization.modal.manager")},this.getEnablementActionTextForVariation=function(t){return z.personalizationsmarteditUtils.getEnablementActionTextForVariation(t,"personalization.modal.manager")},this.getActivityStateForCustomization=function(t){return z.personalizationsmarteditUtils.getActivityStateForCustomization(t)},this.getActivityStateForVariation=function(t,e){return z.personalizationsmarteditUtils.getActivityStateForVariation(t,e)},this.allCustomizationsCollapsed=function(){return z.customizations.map(function(t){return t.isCollapsed}).reduce(function(t,e){return t&&e},!0)},this.statusNotDeleted=function(t){return z.personalizationsmarteditUtils.isItemVisible(t)},this.isScrollZoneVisible=function(){return z.$scope.scrollZoneElement.get(0).scrollHeight>z.$scope.scrollZoneElement.get(0).clientHeight},this.getCustomizations=function(t){z.personalizationsmarteditManagerViewUtilsService.getCustomizations(t).then(function(t){Array.prototype.push.apply(z.customizations,t.customizations),z.$scope.filteredCustomizationsCount=t.pagination.totalCount,z.pagination=new O(t.pagination),z.moreCustomizationsRequestProcessing=!1},function(){z.personalizationsmarteditMessageHandler.sendError(z.$filter("translate")("personalization.error.gettingcustomizations")),z.moreCustomizationsRequestProcessing=!1})},this.getCustomizationsFilterObject=function(){return{active:"all",name:z.search.name,currentSize:z.pagination.getCount(),currentPage:z.pagination.getPage()+1,statuses:z.search.status.modelStatuses}},this.getDefaultStatus=function(){return z.statuses.filter(function(t){return t.code===z.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.ALL})[0]},this.updateCustomizationRank=function(t,e){return z.personalizationsmarteditManagerViewUtilsService.updateCustomizationRank(t,e)},this.updateVariationRank=function(t,e,i){return z.personalizationsmarteditManagerViewUtilsService.updateVariationRank(t,e,i)},this.updateRanks=function(t,e,i,n,a){var o=a>0?n.source.index:n.dest.index,s=a>0?n.dest.index:n.source.index;i[n.dest.index].rank=e.rank;for(var r=o;r<=s;r++)r!==n.dest.index&&(i[r].rank+=a>0?-1:1)},this.valideRanks=function(t){for(var e=0;e<t.length-1;e++)if(t[e].rank>t[e+1].rank){z.refreshGrid();break}},this.droppedCustomization=function(t,e){var i=z.customizations[e.dest.index],n=i.rank-t.rank;0!==n&&(z.waitDialogService.showWaitModal(),z.updateCustomizationRank(t.code,n).then(function(){z.updateRanks(t,i,z.customizations,e,n),z.$timeout(function(){z.valideRanks(z.customizations)},100)}).finally(function(){z.waitDialogService.hideWaitModal()}))},this.droppedTargetGroup=function(t,e){var i=e.source.nodesScope.$modelValue[e.dest.index],n=i.rank-t.rank,a=e.source.nodesScope.$parent.$modelValue;0!==n&&(z.waitDialogService.showWaitModal(),z.updateVariationRank(a,t.code,n).then(function(){z.updateRanks(t,i,a.variations,e,n),z.$timeout(function(){z.valideRanks(a.variations)},100)}).finally(function(){z.waitDialogService.hideWaitModal()}))};var v=this.personalizationsmarteditContextService.getSeData().seExperienceData,f=v.languageDescriptor.isocode;this.$scope.scrollZoneVisible=!1,this.catalogName=v.catalogDescriptor.name[f],this.catalogName+=" - "+v.catalogDescriptor.catalogVersion,this.statuses=this.personalizationsmarteditUtils.getStatusesMapping(),this.customizations=[],this.$scope.filteredCustomizationsCount=0,this.search={name:"",status:this.getDefaultStatus()},this.moreCustomizationsRequestProcessing=!1,this.pagination=new O,this.pagination.reset(),this.treeOptions={dragStart:function(t){z.$scope.scrollZoneVisible=z.isScrollZoneVisible(),t.source.nodeScope.$modelValue.isDragging=!0},dragStop:function(t){t.source.nodeScope.$modelValue.isDragging=void 0},dropped:function(t){z.$scope.scrollZoneVisible=!1;var e=t.source.nodeScope.$modelValue;t.source.index!==t.dest.index&&(e.variations?z.droppedCustomization(e,t):z.droppedTargetGroup(e,t))},accept:function(t,e){return!!(z.lodash.isArray(e.$modelValue)&&e.$modelValue.indexOf(t.$modelValue)>-1)}},this.init=function(){z.systemEventService.registerEventHandler("CUSTOMIZATIONS_MODIFIED",function(){return z.refreshGrid(),z.$q.when()})}}return PersonalizationsmarteditManagerViewController.$inject=["$scope","$filter","$q","lodash","personalizationsmarteditManagerViewUtilsService","personalizationsmarteditMessageHandler","personalizationsmarteditContextService","personalizationsmarteditUtils","personalizationsmarteditManager","personalizationsmarteditCommerceCustomizationService","personalizationsmarteditCommerceCustomizationView","personalizationsmarteditDateUtils","PERSONALIZATION_VIEW_STATUS_MAPPING_CODES","PERSONALIZATION_MODEL_STATUS_CODES","waitDialogService","$timeout","systemEventService"],PersonalizationsmarteditManagerViewController=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditManagerViewController)}(),Vt=function(){function PersonalizationsmarteditManagerView(t){var e=this;this.modalService=t,this.openManagerAction=function(t,i){e.modalService.open({title:"personalization.modal.manager.title",templateUrl:"personalizationsmarteditManagerViewTemplate.html",controller:Dt,size:"fullscreen",cssClasses:"perso-library"}).then(function(){},function(){})}}return PersonalizationsmarteditManagerView.$inject=["modalService"],PersonalizationsmarteditManagerView=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditManagerView)}(),Nt=function(){function PersonalizationsmarteditManagerViewUtilsService(t,e,i,n,a,o,s){var r=this;this.personalizationsmarteditRestService=t,this.personalizationsmarteditMessageHandler=e,this.personalizationsmarteditCommerceCustomizationService=i,this.PERSONALIZATION_MODEL_STATUS_CODES=n,this.waitDialogService=a,this.confirmationModalService=o,this.$filter=s,this.deleteCustomizationAction=function(t,e){r.confirmationModalService.confirm({description:"personalization.modal.manager.deletecustomization.content"}).then(function(){r.personalizationsmarteditRestService.getCustomization(t).then(function(i){i.status="DELETED",r.personalizationsmarteditRestService.updateCustomization(i).then(function(){e.splice(e.indexOf(t),1)},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.deletingcustomization"))})},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.deletingcustomization"))})})},this.deleteVariationAction=function(t,e){r.confirmationModalService.confirm({description:"personalization.modal.manager.deletevariation.content"}).then(function(){r.personalizationsmarteditRestService.getVariation(t.code,e.code).then(function(i){i.status="DELETED",r.personalizationsmarteditRestService.editVariation(t.code,i).then(function(t){e.status=t.status},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.deletingvariation"))})},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.deletingvariation"))})})},this.toogleVariationActive=function(t,e){r.personalizationsmarteditRestService.getVariation(t.code,e.code).then(function(i){i.enabled=!i.enabled,i.status=i.enabled?r.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:r.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED,r.personalizationsmarteditRestService.editVariation(t.code,i).then(function(t){e.enabled=t.enabled,e.status=t.status},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.editingvariation"))})},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.gettingvariation"))})},this.customizationClickAction=function(t){return r.personalizationsmarteditRestService.getVariationsForCustomization(t.code,t).then(function(e){t.variations.forEach(function(t){t.actions=r.getActionsForVariation(t.code,e.variations),t.numberOfComponents=r.personalizationsmarteditCommerceCustomizationService.getNonCommerceActionsCount(t),t.commerceCustomizations=r.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCountMap(t),t.numberOfCommerceActions=r.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCount(t)})},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.gettingcustomization"))})},this.getCustomizations=function(t){return r.personalizationsmarteditRestService.getCustomizations(t)},this.updateCustomizationRank=function(t,e){return r.personalizationsmarteditRestService.updateCustomizationRank(t,e).then(function(){},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.updatingcustomization"))})},this.updateVariationRank=function(t,e,i){return r.personalizationsmarteditRestService.getVariation(t.code,e).then(function(e){return e.rank=e.rank+i,r.personalizationsmarteditRestService.editVariation(t.code,e).then(function(){},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.editingvariation"))})},function(){r.personalizationsmarteditMessageHandler.sendError(r.$filter("translate")("personalization.error.gettingvariation"))})},this.setCustomizationRank=function(t,e,i){var n=i[i.indexOf(t)+e];r.waitDialogService.showWaitModal(),r.updateCustomizationRank(t.code,n.rank-t.rank).then(function(){t.rank+=e,n.rank-=e;var a=i.indexOf(t),o=i.splice(a,1);i.splice(a+e,0,o[0])}).finally(function(){r.waitDialogService.hideWaitModal()})},this.setVariationRank=function(t,e,i){var n=t.variations[t.variations.indexOf(e)+i];r.waitDialogService.showWaitModal(),r.updateVariationRank(t,e.code,i).then(function(){e.rank+=i,n.rank-=i;var a=t.variations.indexOf(e),o=t.variations.splice(a,1);t.variations.splice(a+i,0,o[0])}).finally(function(){r.waitDialogService.hideWaitModal()})},this.getActionsForVariation=function(t,e){var i=(e=e||[]).filter(function(e){return t===e.code})[0];return i?i.actions:[]}}return PersonalizationsmarteditManagerViewUtilsService.$inject=["personalizationsmarteditRestService","personalizationsmarteditMessageHandler","personalizationsmarteditCommerceCustomizationService","PERSONALIZATION_MODEL_STATUS_CODES","waitDialogService","confirmationModalService","$filter"],PersonalizationsmarteditManagerViewUtilsService=n.__decorate([Object(o.SeInjectable)()],PersonalizationsmarteditManagerViewUtilsService)}(),xt=function(){function PersonalizationsmarteditManagerViewModule(){}return PersonalizationsmarteditManagerViewModule=n.__decorate([Object(o.SeModule)({imports:["modalServiceModule","confirmationModalServiceModule","smarteditCommonsModule","ui.tree",V,k,W,wt,Z],providers:[Vt,Nt]})],PersonalizationsmarteditManagerViewModule)}();!function doImport(){importAll(i(8)),importAll(i(10)),importAll(i(12))}();var $t=function(){function Personalizationsmarteditcontainermodule(){}return Personalizationsmarteditcontainermodule=n.__decorate([Object(o.SeModule)({imports:["personalizationsmarteditcontainerTemplates","ui.bootstrap","functionsModule","seConstantsModule","yjqueryModule","smarteditCommonsModule","smarteditRootModule","smarteditServicesModule",ft,pt,bt,ht,W,V,Q,k,tt,Z,dt,Mt,xt],config:["$provide",function(t){"ngInject";t.decorator("rollbackPageVersionService",["$delegate","$log","versionCheckerService",function(t,e,i){var n=t.rollbackPageVersion;t.rollbackPageVersion=function rollbackWrapper(){return i.setVersion(arguments[0]),n.apply(t,arguments)};var a=t.showConfirmationModal;return t.showConfirmationModal=function modalWrapper(){var e=arguments;return i.provideTranlationKey(e[1]).then(function(i){return e[1]=i,a.apply(t,e)})},t}])}],initialize:["$log","yjQuery","domain","$q","personalizationsmarteditContextServiceReverseProxy","personalizationsmarteditContextService","personalizationsmarteditContextMenuServiceProxy","personalizationsmarteditContextUtils","personalizationsmarteditPreviewService","personalizationsmarteditMessageHandler","personalizationsmarteditRestService","personalizationsmarteditUtils","EVENTS","SWITCH_LANGUAGE_EVENT","EVENT_PERSPECTIVE_UNLOADING","EVENT_PERSPECTIVE_ADDED","SHOW_TOOLBAR_ITEM_CONTEXT","crossFrameEventService","featureService","perspectiveService","smarteditBootstrapGateway","systemEventService","experienceService","personalizationsmarteditDateUtils","CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY","COMBINED_VIEW_TOOLBAR_ITEM_KEY",function(t,e,i,n,o,s,r,l,c,d,m,p,u,g,h,C,z,v,f,S,_,T,b,A,E,O){"ngInject";!function(t){var i=e("<link rel='stylesheet' type='text/css' href='"+t+"'>");e("head").append(i)}(i+"/personalizationsmartedit/css/style.css"),f.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:E,type:"HYBRID_ACTION",nameI18nKey:"personalization.toolbar.pagecustomizations",priority:4,section:"left",include:"personalizationsmarteditCustomizeViewWrapperTemplate.html",contextTemplateUrl:"personalizationsmarteditCustomizeToolbarContextWrapperTemplate.html",keepAliveOnClose:!1,iconClassName:"sap-icon--palette se-toolbar-menu-ddlb--button__icon",permissions:["se.edit.page","se.personalization.page"]}),f.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:O,type:"HYBRID_ACTION",nameI18nKey:"personalization.toolbar.combinedview.name",priority:6,section:"left",include:"personalizationsmarteditCombinedViewMenuWrapperTemplate.html",contextTemplateUrl:"personalizationsmarteditCombinedViewToolbarContextWrapperTemplate.html",keepAliveOnClose:!1,iconClassName:"sap-icon--switch-views se-toolbar-menu-ddlb--button__icon",permissions:["se.read.page","se.personalization.page"]}),f.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"personalizationsmartedit.container.manager.toolbar",type:"HYBRID_ACTION",nameI18nKey:"personalization.toolbar.library.name",priority:8,section:"left",include:"manageCustomizationViewMenuWrapperTemplate.html",keepAliveOnClose:!1,iconClassName:"sap-icon--bbyd-active-sales se-toolbar-menu-ddlb--button__icon",permissions:["se.edit.page"]}),f.register({key:"personalizationsmartedit.context.service",nameI18nKey:"personalization.context.service.name",descriptionI18nKey:"personalization.context.service.description",enablingCallback:function(){var t=s.getPersonalization();t.enabled=!0,s.setPersonalization(t)},disablingCallback:function(){var t=s.getPersonalization();t.enabled=!1,s.setPersonalization(t)},permissions:["se.edit.page"]}),S.register({key:"personalizationsmartedit.perspective",nameI18nKey:"personalization.perspective.name",features:["personalizationsmartedit.context.service",E,"personalizationsmartedit.container.manager.toolbar",O,"personalizationsmarteditSharedSlot","personalizationsmarteditComponentLightUp","personalizationsmarteditCombinedViewComponentLightUp","personalizationsmartedit.context.add.action","personalizationsmartedit.context.edit.action","personalizationsmartedit.context.delete.action","personalizationsmartedit.context.info.action","personalizationsmartedit.context.component.edit.action","personalizationsmartedit.context.show.action.list","externalcomponentbutton","personalizationsmarteditExternalComponentDecorator","se.contextualMenu","se.emptySlotFix","se.cms.pageDisplayStatus"],perspectives:[],permissions:["se.personalization.open"]});v.subscribe(h,function(t,e){"personalizationsmartedit.perspective"===e&&(l.clearCombinedViewCustomizeContext(s),l.clearCustomizeContextAndReloadPreview(c,s),l.clearCombinedViewContextAndReloadPreview(c,s))});var I=function(){l.clearCombinedViewCustomizeContext(s),l.clearCustomizeContext(s),l.clearCombinedViewContext(s)};T.registerEventHandler(u.EXPERIENCE_UPDATE,function(){return I(),s.setCustomizeFiltersState({}),n.when()}),T.registerEventHandler(C,function(){return c.removePersonalizationDataFromPreview(),n.when()}),T.registerEventHandler(g,function(){var t=s.getCombinedView();return a.forEach(t.selectedItems,function(t){p.getAndSetCatalogVersionNameL10N(t.variation)}),s.setCombinedView(t),n.when()}),_.subscribe("smartEditReady",function(t,e){v.publish(z,E),v.publish(z,O);var i=s.getCustomize().selectedCustomization,n=s.getCombinedView().customize.selectedCustomization,a=s.getCombinedView().selectedItems;b.getCurrentExperience().then(function(t){!t.variations&&(i||n||a)&&I()}),s.refreshExperienceData().then(function(){var t=s.getSeData().seExperienceData;if("personalizationsmartedit.perspective"===(S.getActivePerspective()||{}).key&&t.pageContext.catalogVersionUuid!==t.catalogDescriptor.catalogVersionUuid){d.sendWarning({message:"personalization.warning.pagefromparent",timeout:-1})}}).finally(function(){s.applySynchronization()})})}]})],Personalizationsmarteditcontainermodule)}(),Rt=i(5),Ft=i(6),Ut=i(7),Lt=function(){function PersonalizationsmarteditContainer(){}return PersonalizationsmarteditContainer=n.__decorate([Object(o.SeEntryModule)("personalizationsmarteditcontainermodule"),Object(Rt.NgModule)({imports:[Ft.BrowserModule,Ut.UpgradeModule]})],PersonalizationsmarteditContainer)}()}]);